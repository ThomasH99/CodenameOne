<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>CheckBox.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">codenameone-core-unittests</a> &gt; <a href="index.source.html" class="el_package">com.codename1.ui</a> &gt; <span class="el_source">CheckBox.java</span></div><h1>CheckBox.java</h1><pre class="source lang-java linenums">/*
 * Copyright (c) 2008, 2010, Oracle and/or its affiliates. All rights reserved.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 * This code is free software; you can redistribute it and/or modify it
 * under the terms of the GNU General Public License version 2 only, as
 * published by the Free Software Foundation.  Oracle designates this
 * particular file as subject to the &quot;Classpath&quot; exception as provided
 * by Oracle in the LICENSE file that accompanied this code.
 *
 * This code is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 * version 2 for more details (a copy is included in the LICENSE file that
 * accompanied this code).
 *
 * You should have received a copy of the GNU General Public License version
 * 2 along with this work; if not, write to the Free Software Foundation,
 * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Please contact Oracle, 500 Oracle Parkway, Redwood Shores
 * CA 94065 USA or visit www.oracle.com if you need additional information or
 * have any questions.
 */

package com.codename1.ui;

import com.codename1.cloud.BindTarget;
import com.codename1.ui.events.ActionEvent;
import com.codename1.ui.events.ActionListener;
import com.codename1.ui.geom.Dimension;
import com.codename1.ui.plaf.DefaultLookAndFeel;
import com.codename1.ui.plaf.LookAndFeel;
import com.codename1.ui.util.EventDispatcher;

/**
 * &lt;p&gt;CheckBox is a button that can be selected or deselected and displays
 * its state to the user. Check out {@link com.codename1.ui.RadioButton} for
 * a more exclusive selection approach. Both components support a toggle button
 * mode using the {@link com.codename1.ui.Button#setToggle(boolean)} API.&lt;/p&gt;
 *
 * &lt;script src=&quot;https://gist.github.com/codenameone/dc7fccf13dc102bc5ea0.js&quot;&gt;&lt;/script&gt;
 * &lt;img src=&quot;https://www.codenameone.com/img/developer-guide/components-radiobutton-checkbox.png&quot; alt=&quot;Sample usage of CheckBox/RadioButton/ButtonGroup&quot; /&gt;
 *
 * @author Chen Fishbein
 */
public class CheckBox extends Button {

<span class="fc" id="L48">    private boolean selected = false;</span>

    private boolean oppositeSide;
<span class="fc" id="L51">    private EventDispatcher bindListeners = null;</span>
    private EventDispatcher changeListeners;

    /**
     * Constructs a checkbox with the given text
     *
     * @param text to display next to the checkbox
     */
    public CheckBox(String text) {
<span class="fc" id="L60">        this(text, null);</span>
<span class="fc" id="L61">    }</span>

    /**
     * Constructs a checkbox with no text
     */
    public CheckBox() {
<span class="fc" id="L67">        this(&quot;&quot;);</span>
<span class="fc" id="L68">    }</span>

    /**
     * Constructs a checkbox with the given icon
     *
     * @param icon icon to display next to the checkbox
     */
    public CheckBox(Image icon) {
<span class="nc" id="L76">        this(&quot;&quot;, icon);</span>
<span class="nc" id="L77">    }</span>

    /**
     * Constructs a checkbox with the given text and icon
     *
     * @param text to display next to the checkbox
     * @param icon icon to display next to the text
     */
    public CheckBox(String text, Image icon) {
<span class="fc" id="L86">        super(text, icon);</span>
<span class="fc" id="L87">        setUIID(&quot;CheckBox&quot;);</span>
<span class="fc" id="L88">        updateSide();</span>
<span class="fc" id="L89">    }</span>

    /**
     * Shorthand for creating the check box setting the icon/text and making it into
     * a toggle button
     *
     * @param text the text for the button
     * @param icon the icon for the button
     * @return a check box
     */
    public static CheckBox createToggle(String text, Image icon) {
<span class="nc" id="L100">        CheckBox cb = new CheckBox(text, icon);</span>
<span class="nc" id="L101">        cb.setToggle(true);</span>
<span class="nc" id="L102">        return cb;</span>
    }

    /**
     * Shorthand for creating the check box setting the icon/text and making it into
     * a toggle button
     *
     * @param text the text for the button
     * @return a check box
     */
    public static CheckBox createToggle(String text) {
<span class="fc" id="L113">        CheckBox cb = new CheckBox(text, null);</span>
<span class="fc" id="L114">        cb.setToggle(true);</span>
<span class="fc" id="L115">        return cb;</span>
    }

    /**
     * Shorthand for creating the check box setting the icon/text and making it into
     * a toggle button
     *
     * @param icon the icon for the button
     * @return a check box
     */
    public static CheckBox createToggle(Image icon) {
<span class="nc" id="L126">        CheckBox cb = new CheckBox(&quot;&quot;, icon);</span>
<span class="nc" id="L127">        cb.setToggle(true);</span>
<span class="nc" id="L128">        return cb;</span>
    }

    /**
     * Return true if the checkbox is selected
     *
     * @return true if the checkbox is selected
     */
    public boolean isSelected() {
<span class="fc" id="L137">        return selected;</span>
    }

    /**
     * Selects the current checkbox
     *
     * @param selected value for selection
     */
    public void setSelected(boolean selected) {
<span class="fc bfc" id="L146" title="All 2 branches covered.">        boolean changed = selected != this.selected;</span>
<span class="fc" id="L147">        this.selected = selected;</span>
<span class="fc bfc" id="L148" title="All 2 branches covered.">        if (changed) {</span>
<span class="fc" id="L149">            fireChangeEvent();</span>
        }
<span class="fc" id="L151">        repaint();</span>
<span class="fc" id="L152">    }</span>

    /**
     * {@inheritDoc}
     */
    public void released(int x, int y) {
<span class="fc bfc" id="L158" title="All 2 branches covered.">        setSelected(!isSelected());</span>
<span class="fc" id="L159">        super.released(x, y);</span>
<span class="fc" id="L160">    }</span>

    /**
     * {@inheritDoc}
     */
    @Override
    protected void fireActionEvent(int x, int y) {
<span class="fc" id="L167">        super.fireActionEvent(x, y);</span>
<span class="pc bpc" id="L168" title="1 of 2 branches missed.">        if (bindListeners != null) {</span>
<span class="nc bnc" id="L169" title="All 2 branches missed.">            if (isSelected()) {</span>
<span class="nc" id="L170">                bindListeners.fireBindTargetChange(this, &quot;selected&quot;, Boolean.FALSE, Boolean.TRUE);</span>
            } else {
<span class="nc" id="L172">                bindListeners.fireBindTargetChange(this, &quot;selected&quot;, Boolean.TRUE, Boolean.FALSE);</span>
            }
        }
<span class="fc" id="L175">    }</span>

    /**
     * {@inheritDoc}
     */
    public void paint(Graphics g) {
<span class="pc bpc" id="L181" title="1 of 2 branches missed.">        if (isToggle()) {</span>
<span class="nc" id="L182">            getUIManager().getLookAndFeel().drawButton(g, this);</span>
        } else {
<span class="fc" id="L184">            getUIManager().getLookAndFeel().drawCheckBox(g, this);</span>
        }
<span class="fc" id="L186">    }</span>

    /**
     * {@inheritDoc}
     */
    protected Dimension calcPreferredSize() {
<span class="fc" id="L192">        return getUIManager().getLookAndFeel().getCheckBoxPreferredSize(this);</span>
    }

    /**
     * {@inheritDoc}
     */
    protected String paramString() {
<span class="nc" id="L199">        return super.paramString() + &quot;, selected = &quot; + selected;</span>
    }

    void initComponentImpl() {
<span class="fc" id="L203">        super.initComponentImpl();</span>
<span class="fc" id="L204">    }</span>

    private void updateSide() {
<span class="fc" id="L207">        Boolean v = getUIManager().isThemeConstant(&quot;checkBoxOppositeSideBool&quot;);</span>
<span class="fc bfc" id="L208" title="All 2 branches covered.">        if (v != null) {</span>
<span class="fc" id="L209">            oppositeSide = v.booleanValue();</span>
        }
<span class="fc" id="L211">    }</span>

    /**
     * {@inheritDoc}
     */
    public void refreshTheme(boolean merge) {
<span class="fc" id="L217">        super.refreshTheme(merge);</span>
<span class="fc" id="L218">        updateSide();</span>
<span class="fc" id="L219">    }</span>

    int getAvaliableSpaceForText() {
<span class="pc bpc" id="L222" title="1 of 2 branches missed.">        if (isToggle()) {</span>
<span class="nc" id="L223">            return super.getAvaliableSpaceForText();</span>
        }
<span class="fc" id="L225">        LookAndFeel l = getUIManager().getLookAndFeel();</span>
<span class="pc bpc" id="L226" title="1 of 2 branches missed.">        if (l instanceof DefaultLookAndFeel) {</span>
<span class="fc" id="L227">            Image[] rButtonImages = ((DefaultLookAndFeel) l).getCheckBoxImages();</span>
<span class="fc bfc" id="L228" title="All 2 branches covered.">            if (rButtonImages != null) {</span>
<span class="fc bfc" id="L229" title="All 2 branches covered.">                int index = isSelected() ? 1 : 0;</span>
<span class="fc" id="L230">                return super.getAvaliableSpaceForText() - rButtonImages[index].getWidth();</span>
            }
        }
<span class="fc" id="L233">        return super.getAvaliableSpaceForText() - (getHeight() + getGap());</span>
    }

    /**
     * Places the check box on the opposite side at the far end
     *
     * @return the oppositeSide
     */
    public boolean isOppositeSide() {
<span class="fc" id="L242">        return oppositeSide;</span>
    }

    /**
     * Places the check box on the opposite side at the far end
     *
     * @param oppositeSide the oppositeSide to set
     */
    public void setOppositeSide(boolean oppositeSide) {
<span class="fc" id="L251">        this.oppositeSide = oppositeSide;</span>
<span class="fc" id="L252">    }</span>

    /**
     * {@inheritDoc}
     */
    public String[] getBindablePropertyNames() {
<span class="nc" id="L258">        return new String[]{&quot;selected&quot;};</span>
    }

    /**
     * {@inheritDoc}
     */
    public Class[] getBindablePropertyTypes() {
<span class="nc" id="L265">        return new Class[]{Boolean.class};</span>
    }

    /**
     * {@inheritDoc}
     */
    public void bindProperty(String prop, BindTarget target) {
<span class="nc bnc" id="L272" title="All 2 branches missed.">        if (prop.equals(&quot;selected&quot;)) {</span>
<span class="nc bnc" id="L273" title="All 2 branches missed.">            if (bindListeners == null) {</span>
<span class="nc" id="L274">                bindListeners = new EventDispatcher();</span>
            }
<span class="nc" id="L276">            bindListeners.addListener(target);</span>
<span class="nc" id="L277">            return;</span>
        }
<span class="nc" id="L279">        super.bindProperty(prop, target);</span>
<span class="nc" id="L280">    }</span>

    /**
     * {@inheritDoc}
     */
    public void unbindProperty(String prop, BindTarget target) {
<span class="nc bnc" id="L286" title="All 2 branches missed.">        if (prop.equals(&quot;selected&quot;)) {</span>
<span class="nc bnc" id="L287" title="All 2 branches missed.">            if (bindListeners == null) {</span>
<span class="nc" id="L288">                return;</span>
            }
<span class="nc" id="L290">            bindListeners.removeListener(target);</span>
<span class="nc bnc" id="L291" title="All 2 branches missed.">            if (!bindListeners.hasListeners()) {</span>
<span class="nc" id="L292">                bindListeners = null;</span>
            }
<span class="nc" id="L294">            return;</span>
        }
<span class="nc" id="L296">        super.unbindProperty(prop, target);</span>
<span class="nc" id="L297">    }</span>

    /**
     * {@inheritDoc}
     */
    public Object getBoundPropertyValue(String prop) {
<span class="pc bpc" id="L303" title="1 of 2 branches missed.">        if (prop.equals(&quot;selected&quot;)) {</span>
<span class="pc bpc" id="L304" title="1 of 2 branches missed.">            if (isSelected()) {</span>
<span class="fc" id="L305">                return Boolean.TRUE;</span>
            }
<span class="nc" id="L307">            return Boolean.FALSE;</span>
        }
<span class="nc" id="L309">        return super.getBoundPropertyValue(prop);</span>
    }

    /**
     * {@inheritDoc}
     */
    public void setBoundPropertyValue(String prop, Object value) {
<span class="pc bpc" id="L316" title="1 of 2 branches missed.">        if (prop.equals(&quot;selected&quot;)) {</span>
<span class="pc bpc" id="L317" title="2 of 4 branches missed.">            setSelected(value != null &amp;&amp; ((Boolean) value).booleanValue());</span>
<span class="fc" id="L318">            return;</span>
        }
<span class="nc" id="L320">        super.setBoundPropertyValue(prop, value);</span>
<span class="nc" id="L321">    }</span>

    /**
     * Adds a listener to be notified when the the checkbox's selected value changes.  The difference
     * between a change listener and an action listener is that a change listener is fired
     * whenever there is a change, but action events are only fired when the change is a result
     * of the user clicking on the checkbox.
     *
     * @param l Listener to be notified when selected value changes.
     * @see #removeChangeListener(com.codename1.ui.events.ActionListener)
     * @since 6.0
     */
    public void addChangeListener(ActionListener l) {
<span class="pc bpc" id="L334" title="1 of 2 branches missed.">        if (changeListeners == null) {</span>
<span class="fc" id="L335">            changeListeners = new EventDispatcher();</span>
        }
<span class="fc" id="L337">        changeListeners.addListener(l);</span>
<span class="fc" id="L338">    }</span>

    /**
     * Removes a change change listener.
     *
     * @param l
     * @see #addChangeListener(com.codename1.ui.events.ActionListener)
     * @since 6.0
     */
    public void removeChangeListeners(ActionListener l) {
<span class="pc bpc" id="L348" title="1 of 2 branches missed.">        if (changeListeners != null) {</span>
<span class="fc" id="L349">            changeListeners.removeListener(l);</span>
        }
<span class="fc" id="L351">    }</span>

    private void fireChangeEvent() {
<span class="fc bfc" id="L354" title="All 2 branches covered.">        if (changeListeners != null) {</span>
<span class="fc" id="L355">            ActionEvent evt = new ActionEvent(this, ActionEvent.Type.Change);</span>
<span class="fc" id="L356">            changeListeners.fireActionEvent(evt);</span>
        }
<span class="fc" id="L358">    }</span>

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span></div></body></html>