<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>ComponentSelector.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">codenameone-core-unittests</a> &gt; <a href="index.source.html" class="el_package">com.codename1.ui</a> &gt; <span class="el_source">ComponentSelector.java</span></div><h1>ComponentSelector.java</h1><pre class="source lang-java linenums">/*
 * Copyright (c) 2012, Codename One and/or its affiliates. All rights reserved.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 * This code is free software; you can redistribute it and/or modify it
 * under the terms of the GNU General Public License version 2 only, as
 * published by the Free Software Foundation.  Codename One designates this
 * particular file as subject to the &quot;Classpath&quot; exception as provided
 * by Oracle in the LICENSE file that accompanied this code.
 *
 * This code is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 * version 2 for more details (a copy is included in the LICENSE file that
 * accompanied this code).
 *
 * You should have received a copy of the GNU General Public License version
 * 2 along with this work; if not, write to the Free Software Foundation,
 * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Please contact Codename One through http://www.codenameone.com/ if you
 * need additional information or have any questions.
 */
package com.codename1.ui;


import com.codename1.components.SpanButton;
import com.codename1.components.SpanLabel;
import com.codename1.io.Util;
import com.codename1.ui.animations.CommonTransitions;
import com.codename1.ui.animations.ComponentAnimation;
import com.codename1.ui.animations.Transition;
import com.codename1.ui.events.ActionEvent;
import com.codename1.ui.events.ActionListener;
import com.codename1.ui.events.ActionSource;
import com.codename1.ui.events.DataChangedListener;
import com.codename1.ui.events.FocusListener;
import com.codename1.ui.events.ScrollListener;
import com.codename1.ui.events.StyleListener;
import com.codename1.ui.geom.Dimension;
import com.codename1.ui.geom.Rectangle;
import com.codename1.ui.layouts.Layout;
import com.codename1.ui.plaf.Border;
import com.codename1.ui.plaf.Style;
import com.codename1.util.SuccessCallback;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.Collection;
import java.util.Collections;
import java.util.HashSet;
import java.util.Iterator;
import java.util.LinkedHashSet;
import java.util.Set;

/**
 * A tool to facilitate selection and manipulation of UI components as sets.  This uses fluent API style, similar
 * to jQuery to make it easy to find UI components and modify them as groups.
 *
 * &lt;h3&gt;Set Selection&lt;/h3&gt;
 *
 * &lt;p&gt;Sets of components can either be created by explicitly adding components to the set, or by
 * providing a &quot;selector&quot; string that specifies how the set should be formed.  Some examples:&lt;/p&gt;
 *
 * &lt;ul&gt;
 *   &lt;li&gt;{@code $(&quot;Label&quot;) }  - The set of all components on the current form with UIID=&quot;Label&quot;&lt;/li&gt;
 *   &lt;li&gt;{@code $(&quot;#AddressField&quot;) } - The set of components with name=&quot;AddressField&quot;&lt;/li&gt;
 *   &lt;li&gt;{@code $(&quot;TextField#AddressField&quot;) } - The set of components with UIID=TextField and Name=AddressField&lt;/li&gt;
 *   &lt;li&gt;{@code $(&quot;Label, Button&quot;)} - Set of components in current form with UIID=&quot;Label&quot; or UIID=&quot;Button&quot;&lt;/li&gt;
 *   &lt;li&gt;{@code $(&quot;Label&quot;, myContainer)} - Set of labels within the container {@code myContainer}&lt;/li&gt;
 *   &lt;li&gt;{@code $(&quot;MyContainer *&quot;) } - All descendants of the container with UIID=&quot;MyContainer&quot;.  Will not include &quot;MyContainer&quot;.&lt;/li&gt;
 *   &lt;li&gt;{@code $(&quot;MyContainer &gt; *&quot;) } - All children of of the container with UIID=&quot;MyContainer&quot;.&lt;/li&gt;
 *   &lt;li&gt;{@code $(&quot;MyContainer &gt; Label) } - All children with UIID=Label of container with UIID=MyContainer&lt;/li&gt;
 *   &lt;li&gt;{@code $(&quot;Label&quot;).getParent() } - All parent components of labels in the current form.&lt;/li&gt;
 * &lt;/ul&gt;
 *
 * &lt;h4&gt;Tags&lt;/h4&gt;
 *
 * &lt;p&gt;To make selection more flexible, you can &quot;tag&quot; components so that they can be easily targeted by a selector.
 * You can add tags to components using {@link #addTags(java.lang.String...) }, and remove them using {@link #removeTags(java.lang.String...) }.
 * Once you have tagged a component, it can be targeted quite easily using a selector.  Tags are specified in a selector with a {@literal .}
 * prefix.  E.g.:&lt;/p&gt;
 *
 * &lt;ul&gt;
 *  &lt;li&gt;{@code $(&quot;.my-tag&quot;) } - The set of all components with tag &quot;my-tag&quot;.&lt;/li&gt;
 *  &lt;li&gt;{@code $(&quot;Label.my-tag&quot;) } - The set of all components with tag &quot;my-tag&quot; and UIID=&quot;Label&quot;&lt;/li&gt;
 *  &lt;li&gt;{@code $(&quot;Label.my-tag.myother-tag&quot;)} - The set of all components with tags &quot;my-tag&quot; and &quot;myother-tag&quot; and UIID=&quot;Label&quot;.  Matches only components that include all of those tags.&lt;/li&gt;
 * &lt;/ul&gt;
 *
 * &lt;h3&gt;Modifying Components in Set&lt;/h3&gt;
 *
 * &lt;p&gt;While component selection alone in the ComponentSelector is quite powerful, the true power comes when
 * you start to operate on the entire set of components using the Fluent API of ComponentSelector.  ComponentSelector
 * includes wrapper methods for most of the mutator methods of {@link Component}, {@link Container}, and a few other common
 * component types.&lt;/p&gt;
 *
 * &lt;p&gt;For example, the following two snippets are equivalent:&lt;/p&gt;
 *
 * &lt;pre&gt;
 * {@code
 * for (Component c : $(&quot;Label&quot;)) {
 *     c.getStyle().setFgColor(0xff0000);
 * }
 * }
 * &lt;/pre&gt;
 * &lt;p&gt;
 * and
 *
 * &lt;pre&gt;
 * {@code
 * $(&quot;Label&quot;).setFgColor(0xff0000);
 * }
 * &lt;/pre&gt;
 *
 * &lt;p&gt;The second snippet is clearly easier to type and more compact.  But we can take it further.  The Fluent API
 * style allows you to chain together multiple method calls.  This even makes it desirable to operate on
 * single-element sets.  E.g.:&lt;/p&gt;
 *
 * &lt;pre&gt;
 * {@code
 * Button myButton = $(new Button(&quot;Some text&quot;))
 * .setUIID(&quot;Label&quot;)
 * .addTags(&quot;cell&quot;, &quot;row-&quot;+rowNum, &quot;col-&quot;+colNum, rowNum%2==0 ? &quot;even&quot;:&quot;odd&quot;)
 * .putClientProperty(&quot;row&quot;, rowNum)
 * .putClientProperty(&quot;col&quot;, colNum)
 * .asComponent(Button.class);
 * }
 * &lt;/pre&gt;
 *
 * &lt;p&gt;
 * The above snippet wraps a new Button in a ComponentSelector, then uses the fluent API to apply several properties
 * to the button, before using {@link #asComponent()} to return the Button itself.
 * &lt;/p&gt;
 *
 * &lt;h3&gt;API Overview&lt;/h3&gt;
 *
 * &lt;p&gt;ComponentSelector includes a few different types of methods:&lt;/p&gt;
 *
 * &lt;ol&gt;
 *   &lt;li&gt;Wrapper methods for {@link Component}, {@link Container}, etc... to operate on all applicable components in the set.&lt;/li&gt;
 *   &lt;li&gt;Component Tree Traversal Methods to return other sets of components based on the current set.  E.g. {@link #find(java.lang.String) }, {@link #getParent()}, {@link #getComponentAt(int) },
 * {@link #closest(java.lang.String) }, {@link #nextSibling() }, {@link #prevSibling() }, {@link #parents(java.lang.String) },
 * {@link #getComponentForm() }, and many more.&lt;/li&gt;
 *   &lt;li&gt;Effects. E.g. {@link #fadeIn() }, {@link #fadeOut() }, {@link #slideDown() }, {@link #slideUp() }, {@link #animateLayout(int) },
 * {@link #animateHierarchy(int) }, etc..&lt;/li&gt;
 *   &lt;li&gt;Convenience methods to help with common tasks.  E.g. {@link #$(java.lang.Runnable) } as a short-hand for {@link Display#callSerially(java.lang.Runnable) }
 *   &lt;li&gt;Methods to implement {@link java.util.Set} because ComponentSelector is a set.&lt;/li&gt;
 * &lt;/ol&gt;
 *
 *
 * &lt;h3&gt;Effects&lt;/h3&gt;
 *
 * &lt;p&gt;The following is an example form that demonstrates the use of ComponentSelector to
 * easily create effects on components in a form.&lt;/p&gt;
 *
 * &lt;p&gt;&lt;script src=&quot;https://gist.github.com/shannah/536f852c3b7242a4d3106fc9e5b5d147.js&quot;&gt;&lt;/script&gt;
 * &lt;/p&gt;
 *
 * &lt;h3&gt;Advanced Use of Tags&lt;/h3&gt;
 *
 * &lt;p&gt;The following shows the use of tags to help with striping a table, and selecting rows
 * when clicked on.&lt;/p&gt;
 *
 * &lt;p&gt;&lt;script src=&quot;https://gist.github.com/shannah/6da5728888e01abb54486a02b8c1a7c9.js&quot;&gt;&lt;/script&gt;
 * &lt;/p&gt;
 *
 * &lt;p&gt;See full Demo App in this  &lt;a href=&quot;https://github.com/shannah/cn1-component-selector-demo&quot;&gt;Github Repo&lt;/a&gt;&lt;/p&gt;
 *
 * &lt;h3&gt;Modifying Style Properties&lt;/h3&gt;
 *
 * &lt;p&gt;Modifying styles deserves special mention because components have multiple {@link Style} objects associated with them.
 * {@link Component#getStyle() } returns the style of the component in its current state.  {@link Component#getPressedStyle() }
 * gets the pressed style of the component, {@link Component#getSelectedStyle() } get its selected style, etc..&lt;/p&gt;
 *
 * &lt;p&gt;ComponentSelector wraps each of the {@literal getXXXStyle() } methods of {@link Component} with corresponding methods
 * that return proxy styles for all components in the set.  {@link #getStyle() } returns a proxy {@link Style} that proxies
 * all of the styles returned from each of the {@link Component#getStyle()} methods in the set.  {@link #getPressedStyle() } returns
 * a proxy for all of the pressed styles, etc..&lt;/p&gt;
 *
 * &lt;p&gt;Example Modifying Text Color of All Buttons in a container when they are pressed only&lt;/p&gt;
 *
 * &lt;pre&gt;
 * {@code
 * Style pressed = $(&quot;Button&quot;, myContainer).getPressedStyle();
 * pressed.setFgColor(0xff0000);
 * }
 * &lt;/pre&gt;
 *
 * &lt;p&gt;A slightly more elegant pattern would be to use the {@link #selectPressedStyle() } method to set the default
 * style for mutations to &quot;pressed&quot;.  Then we could use the fluent API of ComponentSelector to chain multiple style
 * mutations.  E.g.:
 * &lt;/p&gt;
 *
 * &lt;pre&gt;
 * {@code
 * $(&quot;Button&quot;, myContainer)
 *     .selectPressedStyle()
 *     .setFgColor(0xffffff)
 *     .setBgColor(0x0)
 *     .setBgTransparency(255);
 * }
 * &lt;/pre&gt;
 *
 * &lt;p&gt;A short-hand for this would be to add the {@literal :pressed} pseudo-class to the selector.  E.g.&lt;/p&gt;
 *
 * &lt;pre&gt;
 * {@code
 * $(&quot;Button:pressed&quot;, myContainer)
 *     .setFgColor(0xffffff)
 *     .setBgColor(0x0)
 *     .setBgTransparency(255);
 * }
 * &lt;/pre&gt;
 *
 * &lt;p&gt;The following style pseudo-classes are supported:&lt;/p&gt;
 *
 * &lt;ul&gt;
 *    &lt;li&gt;{@literal :pressed} - Same as calling {@link #selectPressedStyle() }&lt;/li&gt;
 *    &lt;li&gt;{@literal :selected} - Same as calling {@link #selectSelectedStyle() }&lt;/li&gt;
 *    &lt;li&gt;{@literal :unselected} - Same as calling {@link #selectUnselectedStyle() }&lt;/li&gt;
 *    &lt;li&gt;{@literal :all} - Same as calling {@link #selectAllStyles() }&lt;/li&gt;
 *    &lt;li&gt;{@literal :*} - Alias for {@literal :all}&lt;/li&gt;
 *    &lt;li&gt;{@literal :disabled} - Same as calling {@link #selectDisabledStyle() }&lt;/li&gt;
 * &lt;/ul&gt;
 *
 * &lt;p&gt;You can chain calls to {@literal selectedXXXStyle()}, enabling to chain together mutations of multiple different
 * style properties.  E.g  To change the pressed foreground color, and then change the selected foreground color, you could do:&lt;/p&gt;
 *
 * &lt;pre&gt;
 * {@code
 * $(&quot;Button&quot;, myContainer)
 *    .selectPressedStyle()
 *    .setFgColor(0x0000ff)
 *    .selectSelectedStyle()
 *    .setFgColor(0x00ff00);
 * }
 * &lt;/pre&gt;
 *
 * &lt;h3&gt;Filtering Sets&lt;/h3&gt;
 *
 * &lt;p&gt;There are many ways to remove components from a set.  Obviously you can use the standard {@link java.util.Set } methods
 * to explicitly remove components from your set:&lt;/p&gt;
 *
 * &lt;pre&gt;
 * {@code
 * ComponentSelector sel = $(&quot;Button&quot;).remove(myButton, true);
 *     // The set of all buttons on the current form, except myButton
 * }
 * &lt;/pre&gt;
 * &lt;p&gt;
 * or
 *
 * &lt;pre&gt;
 * {@code
 * ComponentSelector sel = $(&quot;Button&quot;).removeAll($(&quot;.some-tag&quot;), true);
 *    // The set of all buttons that do NOT contain the tag &quot;.some-tag&quot;
 * }
 * &lt;/pre&gt;
 *
 * &lt;p&gt;You could also use the {@link #filter(com.codename1.ui.ComponentSelector.Filter) } to explicitly
 * declare which elements should be kept, and which should be discarded:&lt;/p&gt;
 *
 * &lt;pre&gt;
 * {@code
 * ComponentSelector sel = $(&quot;Button&quot;).filter(c-&gt;{
 *     return c.isVisible();
 * });
 *     // The set of all buttons that are currently visible.
 * }
 * &lt;/pre&gt;
 *
 * &lt;h3&gt;Tree Navigation&lt;/h3&gt;
 *
 * &lt;p&gt;
 * One powerful aspect of working with sets of components is that you can generate very specific
 * sets of components using very simple queries.  Consider the following queries:&lt;/p&gt;
 *
 * &lt;ul&gt;
 *     &lt;li&gt;{@code $(myButton1, myButton2).getParent()} - The set of parents of {@literal myButton1} and {@literal myButton2}.  If they have the
 * same parent, then this set will only contain a single element: the common parent container.   If they have different parents, then this
 * set will include both parent containers.&lt;/li&gt;
 *     &lt;li&gt;{@code $(myButton).getParent().find(&quot;&gt;TextField&quot;)} - The set of siblings of {@literal myButton} that have UIID=TextField&lt;/li&gt;
 *     &lt;li&gt;{@code $(myButton).closest(&quot;.some-tag&quot;)} - The set containing the &quot;nearest&quot; parent container of {@literal myButton} that has
 * the tag &quot;.some-tag&quot;.  If there are no matching components, then this will be an empty set.  This is formed by crawling up the tree
 * until it finds a matching component.  Works the same as jQuery's {@literal closest() } method.&lt;/li&gt;
 *     &lt;li&gt;{@code $(&quot;.my-tag&quot;).getComponentAt(4)} - The set of 5th child components of containers with tag &quot;.my-tag&quot;.&lt;/li&gt;
 * &lt;/ul&gt;
 *
 * @author shannah
 * @see &lt;a href=&quot;https://www.codenameone.com/blog/jquery-css-style-selectors-for-cn1.html&quot;&gt;jQuery/CSS Style Selectors for Codename One&lt;/a&gt;
 */
public class ComponentSelector implements Iterable&lt;Component&gt;, Set&lt;Component&gt; {
    private static final String PROPERTY_TAG = &quot;com.codename1.ui.ComponentSelector#tags&quot;;
    private static final int ALL_STYLES = 1;
    private static final int PRESSED_STYLE = 2;
    private static final int SELECTED_STYLE = 3;
    private static final int UNSELECTED_STYLE = 4;
    private static final int DISABLED_STYLE = 5;
    private final Set&lt;Component&gt; roots;
    private String name;
    private String uiid;
    private String[] tags;
    private String[] tagsNeedles;
    private String state;
    private ComponentSelector parent;
    private Set&lt;ComponentSelector&gt; aggregateSelectors;
    private Set&lt;Component&gt; results;
<span class="fc" id="L307">    private boolean childrenOnly = false;</span>
<span class="fc" id="L308">    private Style currentStyle = null;</span>
<span class="fc" id="L309">    private int currentStyleType = 0;</span>


    /**
     * Creates a component selector that wraps the provided components.  The provided
     * components are treated as the &quot;results&quot; of this selector.  Not the roots.  However
     * you can use {@link #find(java.lang.String) } to perform a query using this selector
     * as the roots.
     *
     * @param cmps Components to add to this selector results.
     */
<span class="fc" id="L320">    public ComponentSelector(Component... cmps) {</span>
<span class="fc" id="L321">        this.roots = new LinkedHashSet&lt;Component&gt;();</span>
<span class="fc" id="L322">        this.results = new LinkedHashSet&lt;Component&gt;();</span>
<span class="fc" id="L323">        Collections.addAll(this.results, cmps);</span>
<span class="fc" id="L324">    }</span>

    /**
     * Creates a component selector that wraps the provided components.  The provided
     * components are treated as the &quot;results&quot; of this selector.  Not the roots.  However
     * you can use {@link #find(java.lang.String) } to perform a query using this selector
     * as the roots.
     *
     * @param cmps Components to add to this selector results.
     */
<span class="fc" id="L334">    public ComponentSelector(Set&lt;Component&gt; cmps) {</span>
<span class="fc" id="L335">        this.roots = new LinkedHashSet&lt;Component&gt;();</span>
<span class="fc" id="L336">        this.results = new LinkedHashSet&lt;Component&gt;();</span>
<span class="fc" id="L337">        this.results.addAll(cmps);</span>

<span class="fc" id="L339">    }</span>

    /**
     * Creates a selector that will query the current form.  If there is no
     * current form, then this selector will have no roots.
     * &lt;p&gt;Generally it is better to provide a root explicitly using {@link ComponentSelector#ComponentSelector(java.lang.String, com.codename1.ui.Component...)
     * to ensure that the selector has a tree to walk down.&lt;/p&gt;
     *
     * @param selector The selector string.
     */
<span class="fc" id="L349">    public ComponentSelector(String selector) {</span>
<span class="fc" id="L350">        this.roots = new LinkedHashSet&lt;Component&gt;();</span>
<span class="fc" id="L351">        Form f = Display.getInstance().getCurrent();</span>
<span class="pc bpc" id="L352" title="1 of 2 branches missed.">        if (f != null) {</span>
<span class="fc" id="L353">            this.roots.add(f);</span>
        } else {
<span class="nc" id="L355">            throw new RuntimeException(&quot;Attempt to create selector on current form, but there is no current form.  Best practice is to explicitly provide a root for your ComponentSelector.&quot;);</span>
        }
<span class="fc" id="L357">        parse(selector);</span>
<span class="fc" id="L358">    }</span>

    /**
     * Creates a selector with the provided roots.  This will only search through the subtrees
     * of the provided roots to find results that match the provided selector string.
     *
     * @param selector The selector string
     * @param roots    The roots for this selector.
     */
<span class="fc" id="L367">    public ComponentSelector(String selector, Component... roots) {</span>
<span class="fc" id="L368">        this.roots = new LinkedHashSet&lt;Component&gt;();</span>
<span class="fc" id="L369">        Collections.addAll(this.roots, roots);</span>
<span class="fc" id="L370">        parse(selector);</span>
<span class="fc" id="L371">    }</span>

    /**
     * Creates a selector with the provided roots.  This will only search through the subtrees
     * of the provided roots to find results that match the provided selector string.
     *
     * @param selector The selector string
     * @param roots    The roots for this selector.
     */
<span class="fc" id="L380">    public ComponentSelector(String selector, Collection&lt;Component&gt; roots) {</span>
<span class="fc" id="L381">        this.roots = new LinkedHashSet&lt;Component&gt;();</span>
<span class="fc" id="L382">        this.roots.addAll(roots);</span>
<span class="fc" id="L383">        parse(selector);</span>
<span class="fc" id="L384">    }</span>

    /**
     * Wraps provided components in a ComponentSelector set.
     *
     * @param cmps Components to be includd in the set.
     * @return ComponentSelector with specified components.
     */
    public static ComponentSelector $(Component... cmps) {
<span class="fc" id="L393">        return new ComponentSelector(cmps);</span>
    }

    /**
     * Alias of {@link #$(com.codename1.ui.Component...) }
     *
     * @param cmps
     * @return
     */
    public static ComponentSelector select(Component... cmps) {
<span class="fc" id="L403">        return $(cmps);</span>
    }

    /**
     * Creates a ComponentInspector with the source component of the provided event.
     *
     * @param e The event whose source component is added to the set.
     * @return A ComponentSelector with a single component - the source of the event.
     */
    public static ComponentSelector $(ActionEvent e) {
<span class="nc" id="L413">        Object src = e.getSource();</span>
<span class="nc bnc" id="L414" title="All 2 branches missed.">        if (src == null) {</span>
<span class="nc" id="L415">            return new ComponentSelector();</span>
<span class="nc bnc" id="L416" title="All 2 branches missed.">        } else if (src instanceof Component) {</span>
<span class="nc" id="L417">            return new ComponentSelector((Component) src);</span>
        }
<span class="nc" id="L419">        return new ComponentSelector();</span>
    }

    /**
     * Alias of {@link #$(com.codename1.ui.events.ActionEvent) }
     *
     * @param e
     * @return
     */
    public static ComponentSelector select(ActionEvent e) {
<span class="nc" id="L429">        return $(e);</span>
    }

    /**
     * Wraps {@link Display#callSerially(java.lang.Runnable) }
     *
     * @param r
     * @return Empty ComponentSelector.
     */
    public static ComponentSelector $(Runnable r) {
<span class="nc" id="L439">        Display.getInstance().callSerially(r);</span>
<span class="nc" id="L440">        return new ComponentSelector();</span>
    }

    /**
     * Alias of {@link #$(java.lang.Runnable) }
     *
     * @param r
     * @return
     */
    public static ComponentSelector select(Runnable r) {
<span class="nc" id="L450">        return $(r);</span>
    }

    /**
     * Creates a new ComponentSelector with the provided set of components.
     *
     * @param cmps The components to include in the set.
     * @return ComponentSelector with provided components.
     */
    public static ComponentSelector $(Set&lt;Component&gt; cmps) {
<span class="nc" id="L460">        return new ComponentSelector(cmps);</span>
    }

    /**
     * Alias of {@link #$(java.util.Set) }
     *
     * @param cmps
     * @return
     */
    public static ComponentSelector select(Set&lt;Component&gt; cmps) {
<span class="nc" id="L470">        return $(cmps);</span>
    }

    /**
     * Creates a new ComponentSelector with the components matched by the provided selector.  The current form
     * is used as the root for searches.  Will throw a runtime exception if there is no current form.
     *
     * @param selector A selector string that defines which components to include in the
     *                 set.
     * @return ComponentSelector with matching components.
     */
    public static ComponentSelector $(String selector) {
<span class="fc" id="L482">        return new ComponentSelector(selector);</span>
    }

    /**
     * Alias of {@link #$(java.lang.String) }
     *
     * @param selector
     * @return
     */
    public static ComponentSelector select(String selector) {
<span class="nc" id="L492">        return $(selector);</span>
    }

    /**
     * Creates a ComponentSelector with the components matched by the provided selector in the provided
     * roots' subtrees.
     *
     * @param selector Selector string to define which components will be included in the set.
     * @param roots    Roots for the selector to search.  Only components within the roots' subtrees will be included in the set.
     * @return ComponentSelector with matching components.
     */
    public static ComponentSelector $(String selector, Component... roots) {
<span class="fc" id="L504">        return new ComponentSelector(selector, roots);</span>
    }

    /**
     * Alias of {@link #$(java.lang.String, com.codename1.ui.Component...) }
     *
     * @param selector
     * @param roots
     * @return
     */
    public static ComponentSelector select(String selector, Component... roots) {
<span class="fc" id="L515">        return $(selector, roots);</span>
    }

    /**
     * Creates a ComponentSelector with the components matched by the provided selector in the provided
     * roots' subtrees.
     *
     * @param selector Selector string to define which components will be included in the set.
     * @param roots    Roots for the selector to search.  Only components within the roots' subtrees will be included in the set.
     * @return ComponentSelector with matching components.
     */
    public static ComponentSelector $(String selector, Collection&lt;Component&gt; roots) {
<span class="nc" id="L527">        return new ComponentSelector(selector, roots);</span>
    }

    /**
     * Alias of {@link #$(java.lang.String, java.util.Collection) }
     *
     * @param selector
     * @param roots
     * @return
     */
    public static ComponentSelector select(String selector, Collection&lt;Component&gt; roots) {
<span class="nc" id="L538">        return $(selector, roots);</span>
    }

    private static int dip2px(float dips) {
<span class="fc" id="L542">        return Display.getInstance().convertToPixels(dips);</span>
    }

    private Style currentStyle() {
<span class="fc bfc" id="L546" title="All 2 branches covered.">        if (currentStyle == null) {</span>
<span class="pc bpc" id="L547" title="5 of 6 branches missed.">            switch (currentStyleType) {</span>
                case ALL_STYLES:
<span class="nc" id="L549">                    currentStyle = getAllStyles();</span>
<span class="nc" id="L550">                    break;</span>
                case PRESSED_STYLE:
<span class="nc" id="L552">                    currentStyle = getPressedStyle();</span>
<span class="nc" id="L553">                    break;</span>
                case SELECTED_STYLE:
<span class="nc" id="L555">                    currentStyle = getSelectedStyle();</span>
<span class="nc" id="L556">                    break;</span>
                case UNSELECTED_STYLE:
<span class="nc" id="L558">                    currentStyle = getUnselectedStyle();</span>
<span class="nc" id="L559">                    break;</span>
                case DISABLED_STYLE:
<span class="nc" id="L561">                    currentStyle = getDisabledStyle();</span>
<span class="nc" id="L562">                    break;</span>
                default:
<span class="fc" id="L564">                    currentStyle = getStyle();</span>
                    break;


            }
        }
<span class="fc" id="L570">        return currentStyle;</span>
    }

    private void setDirty() {
<span class="nc" id="L574">        currentStyle = null;</span>
<span class="nc" id="L575">    }</span>

    /**
     * Applies the given callback to each component in the set.
     *
     * @param closure Callback which will be called once for each component in the set.
     * @return Self for chaining.
     */
    public ComponentSelector each(ComponentClosure closure) {
<span class="fc bfc" id="L584" title="All 2 branches covered.">        for (Component c : this) {</span>
<span class="fc" id="L585">            closure.call(c);</span>
<span class="fc" id="L586">        }</span>
<span class="fc" id="L587">        return this;</span>
    }

    /**
     * Creates a new set based on the elements of the current set and a mapping function
     * which defines the elements that should be in the new set.
     *
     * @param mapper The mapper which will be called once for each element in the set.  The return value
     *               of the mapper function dictates which component should be included in the resulting set.
     * @return A new set of components.
     */
    public ComponentSelector map(ComponentMapper mapper) {
<span class="nc" id="L599">        LinkedHashSet&lt;Component&gt; out = new LinkedHashSet&lt;Component&gt;();</span>
<span class="nc bnc" id="L600" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L601">            Component res = mapper.map(c);</span>
<span class="nc bnc" id="L602" title="All 2 branches missed.">            if (res != null) {</span>
<span class="nc" id="L603">                out.add(res);</span>
            }
<span class="nc" id="L605">        }</span>
<span class="nc" id="L606">        return new ComponentSelector(out);</span>
    }

    /**
     * Creates a new set of components formed by filtering the current set using a filter function.
     *
     * @param filter The filter function called for each element in the set.  If it returns true,
     *               then the element is included in the resulting set.  If false, it will not be included.
     * @return A new set with the results of the filter.
     */
    public ComponentSelector filter(Filter filter) {
<span class="fc" id="L617">        LinkedHashSet&lt;Component&gt; out = new LinkedHashSet&lt;Component&gt;();</span>
<span class="fc bfc" id="L618" title="All 2 branches covered.">        for (Component c : this) {</span>
<span class="fc" id="L619">            boolean res = filter.filter(c);</span>
<span class="fc bfc" id="L620" title="All 2 branches covered.">            if (res) {</span>
<span class="fc" id="L621">                out.add(c);</span>
            }
<span class="fc" id="L623">        }</span>
<span class="fc" id="L624">        return new ComponentSelector(out);</span>
    }

    /**
     * Filters the current found set against the given selector.
     *
     * @param selector The selector to filter the found set on.
     * @return A new set of elements matching the selector.
     */
    public ComponentSelector filter(String selector) {
<span class="nc" id="L634">        ComponentSelector matcher = new ComponentSelector(selector, new Label());</span>
<span class="nc" id="L635">        LinkedHashSet&lt;Component&gt; matches = new LinkedHashSet&lt;Component&gt;();</span>
<span class="nc bnc" id="L636" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L637" title="All 2 branches missed.">            if (matcher.match(c)) {</span>
<span class="nc" id="L638">                matches.add(c);</span>
            }
<span class="nc" id="L640">        }</span>
<span class="nc" id="L641">        return matcher.addAll(matches, true);</span>
    }

    /**
     * Creates a new set of components consisting of all of the parents of components in this set.
     * Only parent components matching the provided selector will be included in the set.
     *
     * @param selector Selector to filter the parent components.
     * @return New set with parents of elements in current set.
     */
    public ComponentSelector parent(String selector) {
<span class="nc" id="L652">        ComponentSelector matcher = new ComponentSelector(selector, new Label());</span>
<span class="nc" id="L653">        LinkedHashSet&lt;Component&gt; matches = new LinkedHashSet&lt;Component&gt;();</span>
<span class="nc bnc" id="L654" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L655">            Component parent = c.getParent();</span>
<span class="nc bnc" id="L656" title="All 4 branches missed.">            if (parent != null &amp;&amp; matcher.match(parent)) {</span>
<span class="nc" id="L657">                matches.add(parent);</span>
            }
<span class="nc" id="L659">        }</span>
<span class="nc" id="L660">        return matcher.addAll(matches, true);</span>
    }

    /**
     * Creates new set of components consisting of all of the ancestors of components in this set which
     * match the provided selector.
     *
     * @param selector The selector to filter the ancestors.
     * @return New set with ancestors of elements in current set.
     */
    public ComponentSelector parents(String selector) {
<span class="nc" id="L671">        ComponentSelector matcher = new ComponentSelector(selector, new Label());</span>
<span class="nc" id="L672">        LinkedHashSet&lt;Component&gt; matches = new LinkedHashSet&lt;Component&gt;();</span>
<span class="nc bnc" id="L673" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L674">            Component parent = c.getParent();</span>
<span class="nc bnc" id="L675" title="All 2 branches missed.">            while (parent != null) {</span>
<span class="nc bnc" id="L676" title="All 2 branches missed.">                if (matcher.match(parent)) {</span>
<span class="nc" id="L677">                    matches.add(parent);</span>
                }
<span class="nc" id="L679">                parent = parent.getParent();</span>
            }

<span class="nc" id="L682">        }</span>
<span class="nc" id="L683">        return matcher.addAll(matches, true);</span>
    }

    /**
     * Creates a new set of components consistng of all &quot;closest&quot; ancestors of components
     * in this set which match the provided selector.
     *
     * @param selector The selector to use to match the nearest ancestor.
     * @return New set with ancestors of components in current set.
     */
    public ComponentSelector closest(String selector) {
<span class="nc" id="L694">        ComponentSelector matcher = new ComponentSelector(selector, new Label());</span>
<span class="nc" id="L695">        LinkedHashSet&lt;Component&gt; matches = new LinkedHashSet&lt;Component&gt;();</span>
<span class="nc bnc" id="L696" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L697">            Component parent = c.getParent();</span>
<span class="nc bnc" id="L698" title="All 2 branches missed.">            while (parent != null) {</span>
<span class="nc bnc" id="L699" title="All 2 branches missed.">                if (matcher.match(parent)) {</span>
<span class="nc" id="L700">                    matches.add(parent);</span>
<span class="nc" id="L701">                    break;</span>
                }
<span class="nc" id="L703">                parent = parent.getParent();</span>
            }

<span class="nc" id="L706">        }</span>
<span class="nc" id="L707">        return matcher.addAll(matches, true);</span>
    }

    /**
     * Creates new set consisting of the first child of each component in the current set.
     *
     * @return New set with first child of each component in current set.
     */
    public ComponentSelector firstChild() {
<span class="nc" id="L716">        LinkedHashSet&lt;Component&gt; out = new LinkedHashSet&lt;Component&gt;();</span>
<span class="nc bnc" id="L717" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L718" title="All 2 branches missed.">            if (c instanceof Container) {</span>
<span class="nc" id="L719">                Container cnt = (Container) c;</span>
<span class="nc bnc" id="L720" title="All 2 branches missed.">                if (cnt.getComponentCount() &gt; 0) {</span>
<span class="nc" id="L721">                    out.add(cnt.getComponentAt(0));</span>
                }
            }
<span class="nc" id="L724">        }</span>
<span class="nc" id="L725">        return new ComponentSelector(out);</span>
    }

    /**
     * Creates new set consisting of the last child of each component in the current set.
     *
     * @return New set with last child of each component in current set.
     */
    public ComponentSelector lastChild() {
<span class="nc" id="L734">        LinkedHashSet&lt;Component&gt; out = new LinkedHashSet&lt;Component&gt;();</span>
<span class="nc bnc" id="L735" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L736" title="All 2 branches missed.">            if (c instanceof Container) {</span>
<span class="nc" id="L737">                Container cnt = (Container) c;</span>
<span class="nc bnc" id="L738" title="All 2 branches missed.">                if (cnt.getComponentCount() &gt; 0) {</span>
<span class="nc" id="L739">                    out.add(cnt.getComponentAt(cnt.getComponentCount() - 1));</span>
                }
            }
<span class="nc" id="L742">        }</span>
<span class="nc" id="L743">        return new ComponentSelector(out);</span>
    }

    /**
     * Creates set of &quot;next&quot; siblings of components in this set.
     *
     * @return New ComponentSelector with next siblings of this set.
     */
    public ComponentSelector nextSibling() {
<span class="nc" id="L752">        LinkedHashSet&lt;Component&gt; out = new LinkedHashSet&lt;Component&gt;();</span>
<span class="nc bnc" id="L753" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L754">            Container parent = c.getParent();</span>
<span class="nc bnc" id="L755" title="All 2 branches missed.">            if (parent != null) {</span>
<span class="nc" id="L756">                int index = parent.getComponentIndex(c);</span>
<span class="nc bnc" id="L757" title="All 2 branches missed.">                if (index &lt; parent.getComponentCount() - 1) {</span>
<span class="nc" id="L758">                    out.add(parent.getComponentAt(index + 1));</span>
                }
            }
<span class="nc" id="L761">        }</span>
<span class="nc" id="L762">        return new ComponentSelector(out);</span>
    }

    /**
     * Creates set of &quot;previous&quot; siblings of components in this set.
     *
     * @return New ComponentSelector with previous siblings of this set.
     */
    public ComponentSelector prevSibling() {
<span class="nc" id="L771">        LinkedHashSet&lt;Component&gt; out = new LinkedHashSet&lt;Component&gt;();</span>
<span class="nc bnc" id="L772" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L773">            Container parent = c.getParent();</span>
<span class="nc bnc" id="L774" title="All 2 branches missed.">            if (parent != null) {</span>
<span class="nc" id="L775">                int index = parent.getComponentIndex(c);</span>
<span class="nc bnc" id="L776" title="All 2 branches missed.">                if (index &gt; 0) {</span>
<span class="nc" id="L777">                    out.add(parent.getComponentAt(index - 1));</span>
                }
            }
<span class="nc" id="L780">        }</span>
<span class="nc" id="L781">        return new ComponentSelector(out);</span>
    }

    /**
     * Animates this set of components, replacing any modified style properties of the
     * destination style to the components.
     *
     * @param destStyle The style to apply to the components via animation.
     * @param duration  The duration of the animation (ms)
     * @param callback  Callback to call after animation is complete.
     * @return Self for chaining
     * @see Component#createStyleAnimation(java.lang.String, int)
     */
    public ComponentSelector animateStyle(Style destStyle, int duration, final SuccessCallback&lt;ComponentSelector&gt; callback) {
<span class="nc" id="L795">        ArrayList&lt;ComponentAnimation&gt; animations = new ArrayList&lt;ComponentAnimation&gt;();</span>
<span class="nc" id="L796">        AnimationManager mgr = null;</span>
<span class="nc bnc" id="L797" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L798">            AnimationManager cmgr = c.getAnimationManager();</span>
<span class="nc bnc" id="L799" title="All 2 branches missed.">            if (cmgr != null) {</span>
<span class="nc" id="L800">                mgr = cmgr;</span>
<span class="nc" id="L801">                Style sourceStyle = c.getUnselectedStyle();</span>
<span class="nc" id="L802">                destStyle.merge(sourceStyle);</span>
<span class="nc" id="L803">                animations.add(c.createStyleAnimation(sourceStyle, destStyle, duration, null));</span>
            }
<span class="nc" id="L805">        }</span>

<span class="nc bnc" id="L807" title="All 2 branches missed.">        if (mgr != null) {</span>
<span class="nc" id="L808">            ComponentAnimation anim = ComponentAnimation.compoundAnimation(animations.toArray(new ComponentAnimation[animations.size()]));</span>

<span class="nc" id="L810">            mgr.addAnimation(anim, new Runnable() {</span>
                public void run() {
<span class="nc bnc" id="L812" title="All 2 branches missed.">                    if (callback != null) {</span>
<span class="nc" id="L813">                        callback.onSucess(ComponentSelector.this);</span>
                    }
<span class="nc" id="L815">                }</span>
            });

        }
<span class="nc" id="L819">        return this;</span>
    }

    /**
     * Fade in this set of components.  Prior to calling this, the component visibility
     * should be set to &quot;false&quot;.    This uses the default duration of 500ms.
     *
     * @return Self for chaining.
     */
    public ComponentSelector fadeIn() {
<span class="nc" id="L829">        return fadeIn(500);</span>
    }

    /**
     * Fade in this set of components.  Prior to calling this, the component visibility
     * should be set to &quot;false&quot;.
     *
     * @param duration The duration of the fade in.
     * @return Self for chaining.
     */
    public ComponentSelector fadeIn(int duration) {
<span class="nc" id="L840">        return fadeIn(duration, null);</span>
    }

    /**
     * Fade in this set of components.  Prior to calling this, the component visibility should
     * be set to &quot;false&quot;.
     *
     * @param duration The duration of the fade in.
     * @param callback Callback to run when animation completes.
     * @return
     */
    public ComponentSelector fadeIn(final int duration, final SuccessCallback&lt;ComponentSelector&gt; callback) {
<span class="nc" id="L852">        final String placeholderProperty = &quot;com.codename1.ui.ComponentSelector#fadeOutPlaceholder&quot;;</span>

<span class="nc" id="L854">        AnimationManager mgr = null;</span>
<span class="nc" id="L855">        ArrayList&lt;ComponentAnimation&gt; animations1 = new ArrayList&lt;ComponentAnimation&gt;();</span>
<span class="nc" id="L856">        final ArrayList&lt;ComponentAnimation&gt; animations2 = new ArrayList&lt;ComponentAnimation&gt;();</span>
<span class="nc" id="L857">        final ArrayList&lt;Component&gt; animatingComponents = new ArrayList&lt;Component&gt;();</span>
<span class="nc bnc" id="L858" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L859">            Container parent = c.getParent();</span>
<span class="nc bnc" id="L860" title="All 2 branches missed.">            if (parent != null) {</span>

<span class="nc" id="L862">                AnimationManager cmgr = c.getAnimationManager();</span>
<span class="nc bnc" id="L863" title="All 2 branches missed.">                if (cmgr != null) {</span>
<span class="nc" id="L864">                    mgr = cmgr;</span>
<span class="nc" id="L865">                    Container placeholder = new Container();</span>
                    //placeholder.getStyle().setBgColor(0xff0000);
                    //placeholder.getStyle().setBgTransparency(255);
                    //placeholder.setShowEvenIfBlank(true);
<span class="nc" id="L869">                    c.putClientProperty(placeholderProperty, placeholder);</span>
<span class="nc" id="L870">                    Component.setSameHeight(placeholder, c);</span>
<span class="nc" id="L871">                    Component.setSameWidth(placeholder, c);</span>
<span class="nc" id="L872">                    $(placeholder)</span>
<span class="nc" id="L873">                            .setMargin(c.getStyle().getMarginTop(), c.getStyle().getMarginRight(false), c.getStyle().getMarginBottom(), c.getStyle().getMarginLeft(false))</span>
<span class="nc" id="L874">                            .setPadding(c.getStyle().getPaddingTop(), c.getStyle().getPaddingRight(false), c.getStyle().getPaddingBottom(), c.getStyle().getPaddingLeft(false));</span>

                    //System.out.println(&quot;Placeholder height &quot;+c.getHeight());
                    //parent.replace(c, placeholder, false);
                    //c.setHidden(false);
<span class="nc" id="L879">                    ComponentAnimation a = parent.createReplaceTransition(c, placeholder, CommonTransitions.createEmpty());</span>
<span class="nc" id="L880">                    animations1.add(a);</span>
<span class="nc" id="L881">                    animatingComponents.add(c);</span>
                }
                //centerBackground.add(BorderLayout.CENTER, boxy);
            }
<span class="nc" id="L885">        }</span>
<span class="nc bnc" id="L886" title="All 2 branches missed.">        if (mgr != null) {</span>
<span class="nc" id="L887">            mgr.addAnimation(ComponentAnimation.compoundAnimation(animations1.toArray(new ComponentAnimation[animations1.size()])), new Runnable() {</span>

                public void run() {
<span class="nc" id="L890">                    AnimationManager mgr = null;</span>
<span class="nc bnc" id="L891" title="All 2 branches missed.">                    for (final Component c : animatingComponents) {</span>

<span class="nc" id="L893">                        Container placeholder = (Container) c.getClientProperty(placeholderProperty);</span>
<span class="nc bnc" id="L894" title="All 2 branches missed.">                        if (placeholder != null) {</span>
                            //System.out.println(&quot;Placeholder height after replace &quot;+(c.getHeight() + c.getStyle().getMarginBottom() + c.getStyle().getMarginTop()));
                            //System.out.println(&quot;Placeholder not null&quot;);
<span class="nc" id="L897">                            c.putClientProperty(placeholderProperty, null);</span>
<span class="nc" id="L898">                            AnimationManager cmgr = placeholder.getAnimationManager();</span>

<span class="nc bnc" id="L900" title="All 2 branches missed.">                            if (cmgr != null) {</span>
                                //System.out.println(&quot;Animation manager not null&quot;);
<span class="nc" id="L902">                                mgr = cmgr;</span>
<span class="nc" id="L903">                                c.setVisible(true);</span>
<span class="nc" id="L904">                                Container parent = placeholder.getParent();</span>
<span class="nc bnc" id="L905" title="All 2 branches missed.">                                if (parent != null) {</span>
                                    //System.out.println(&quot;Parent not null&quot;);

<span class="nc" id="L908">                                    ComponentAnimation a = parent.createReplaceTransition(placeholder, c, CommonTransitions.createFade(duration));</span>
<span class="nc" id="L909">                                    animations2.add(a);</span>

                                }
                            }
                        }


<span class="nc" id="L916">                    }</span>
<span class="nc bnc" id="L917" title="All 2 branches missed.">                    if (mgr != null) {</span>
<span class="nc" id="L918">                        final AnimationManager fmgr = mgr;</span>
<span class="nc" id="L919">                        $(new Runnable() {</span>
                            public void run() {
<span class="nc" id="L921">                                fmgr.addAnimation(ComponentAnimation.compoundAnimation(animations2.toArray(new ComponentAnimation[animations2.size()])), new Runnable() {</span>
                                    public void run() {
<span class="nc bnc" id="L923" title="All 2 branches missed.">                                        if (callback != null) {</span>
<span class="nc" id="L924">                                            callback.onSucess(ComponentSelector.this);</span>
                                        }
<span class="nc" id="L926">                                    }</span>

                                });
<span class="nc" id="L929">                            }</span>
                        });

                    }


<span class="nc" id="L935">                }</span>

            });
        }

<span class="nc" id="L940">        return this;</span>
    }

    /**
     * Fades in this component and blocks until animation is complete.
     *
     * @return Self for chaining.
     */
    public ComponentSelector fadeInAndWait() {
<span class="nc" id="L949">        return fadeInAndWait(500);</span>
    }

    /**
     * Fades in this component and blocks until animation is complete.
     *
     * @param duration The duration of the animation.
     * @return Self for chaining.
     */
    public ComponentSelector fadeInAndWait(final int duration) {
<span class="nc" id="L959">        final String placeholderProperty = &quot;com.codename1.ui.ComponentSelector#fadeOutPlaceholder&quot;;</span>

<span class="nc" id="L961">        AnimationManager mgr = null;</span>
<span class="nc" id="L962">        ArrayList&lt;ComponentAnimation&gt; animations1 = new ArrayList&lt;ComponentAnimation&gt;();</span>
<span class="nc" id="L963">        final ArrayList&lt;ComponentAnimation&gt; animations2 = new ArrayList&lt;ComponentAnimation&gt;();</span>
<span class="nc" id="L964">        final ArrayList&lt;Component&gt; animatingComponents = new ArrayList&lt;Component&gt;();</span>
<span class="nc bnc" id="L965" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L966">            Container parent = c.getParent();</span>
<span class="nc bnc" id="L967" title="All 2 branches missed.">            if (parent != null) {</span>

<span class="nc" id="L969">                AnimationManager cmgr = c.getAnimationManager();</span>
<span class="nc bnc" id="L970" title="All 2 branches missed.">                if (cmgr != null) {</span>
<span class="nc" id="L971">                    mgr = cmgr;</span>
<span class="nc" id="L972">                    Container placeholder = new Container();</span>
                    //placeholder.getStyle().setBgColor(0xff0000);
                    //placeholder.getStyle().setBgTransparency(255);
                    //placeholder.setShowEvenIfBlank(true);
<span class="nc" id="L976">                    c.putClientProperty(placeholderProperty, placeholder);</span>
<span class="nc" id="L977">                    Component.setSameHeight(placeholder, c);</span>
<span class="nc" id="L978">                    Component.setSameWidth(placeholder, c);</span>
<span class="nc" id="L979">                    $(placeholder)</span>
<span class="nc" id="L980">                            .setMargin(c.getStyle().getMarginTop(), c.getStyle().getMarginRight(false), c.getStyle().getMarginBottom(), c.getStyle().getMarginLeft(false))</span>
<span class="nc" id="L981">                            .setPadding(c.getStyle().getPaddingTop(), c.getStyle().getPaddingRight(false), c.getStyle().getPaddingBottom(), c.getStyle().getPaddingLeft(false));</span>

                    //System.out.println(&quot;Placeholder height &quot;+c.getHeight());
                    //parent.replace(c, placeholder, false);
                    //c.setHidden(false);
<span class="nc" id="L986">                    ComponentAnimation a = parent.createReplaceTransition(c, placeholder, CommonTransitions.createEmpty());</span>
<span class="nc" id="L987">                    animations1.add(a);</span>
<span class="nc" id="L988">                    animatingComponents.add(c);</span>
                }
                //centerBackground.add(BorderLayout.CENTER, boxy);
            }
<span class="nc" id="L992">        }</span>
<span class="nc bnc" id="L993" title="All 2 branches missed.">        if (mgr != null) {</span>
<span class="nc" id="L994">            mgr.addAnimationAndBlock(ComponentAnimation.compoundAnimation(animations1.toArray(new ComponentAnimation[animations1.size()])));</span>
<span class="nc bnc" id="L995" title="All 2 branches missed.">            for (final Component c : animatingComponents) {</span>

<span class="nc" id="L997">                Container placeholder = (Container) c.getClientProperty(placeholderProperty);</span>
<span class="nc bnc" id="L998" title="All 2 branches missed.">                if (placeholder != null) {</span>
                    //System.out.println(&quot;Placeholder height after replace &quot;+(c.getHeight() + c.getStyle().getMarginBottom() + c.getStyle().getMarginTop()));
                    //System.out.println(&quot;Placeholder not null&quot;);
<span class="nc" id="L1001">                    c.putClientProperty(placeholderProperty, null);</span>
<span class="nc" id="L1002">                    AnimationManager cmgr = placeholder.getAnimationManager();</span>

<span class="nc bnc" id="L1004" title="All 2 branches missed.">                    if (cmgr != null) {</span>
                        //System.out.println(&quot;Animation manager not null&quot;);
<span class="nc" id="L1006">                        mgr = cmgr;</span>
<span class="nc" id="L1007">                        c.setVisible(true);</span>
<span class="nc" id="L1008">                        Container parent = placeholder.getParent();</span>
<span class="nc bnc" id="L1009" title="All 2 branches missed.">                        if (parent != null) {</span>
                            //System.out.println(&quot;Parent not null&quot;);

<span class="nc" id="L1012">                            ComponentAnimation a = parent.createReplaceTransition(placeholder, c, CommonTransitions.createFade(duration));</span>
<span class="nc" id="L1013">                            animations2.add(a);</span>

                        }
                    }
                }


<span class="nc" id="L1020">            }</span>
<span class="nc bnc" id="L1021" title="All 2 branches missed.">            if (mgr != null) {</span>
<span class="nc" id="L1022">                mgr.addAnimationAndBlock(</span>
<span class="nc" id="L1023">                        ComponentAnimation.compoundAnimation(animations2.toArray(new ComponentAnimation[animations2.size()]))</span>
                );

            }
        }

<span class="nc" id="L1029">        return this;</span>
    }

    /**
     * Returns true if the first component in this set is visible.
     *
     * @return True if first component in this set is visible.
     * @see Component#isVisible()
     */
    public boolean isVisible() {
<span class="nc" id="L1039">        Iterator&lt;Component&gt; iterator = iterator(); // PMD Fix: AvoidBranchingStatementAsLastInLoop</span>
<span class="nc bnc" id="L1040" title="All 2 branches missed.">        if (iterator.hasNext()) {</span>
<span class="nc" id="L1041">            return iterator.next().isVisible();</span>
        }
<span class="nc" id="L1043">        return false;</span>
    }

    /**
     * Wrapper for {@link Component#setVisible(boolean) }
     *
     * @param visible True to make all components in result set visible.  False for hidden.
     * @return Self for chaining.
     */
    public ComponentSelector setVisible(boolean visible) {
<span class="fc bfc" id="L1053" title="All 2 branches covered.">        for (Component c : this) {</span>
<span class="fc" id="L1054">            c.setVisible(visible);</span>
<span class="fc" id="L1055">        }</span>
<span class="fc" id="L1056">        return this;</span>
    }

    /**
     * Returns true if first component in this set is hidden.
     *
     * @return True if first component in set is hidden.
     * @see Component#isHidden()
     */
    public boolean isHidden() {
<span class="nc" id="L1066">        Iterator&lt;Component&gt; iterator = iterator(); // PMD Fix: AvoidBranchingStatementAsLastInLoop</span>
<span class="nc bnc" id="L1067" title="All 2 branches missed.">        if (iterator.hasNext()) {</span>
<span class="nc" id="L1068">            return iterator.next().isHidden();</span>
        }
<span class="nc" id="L1070">        return false;</span>
    }

    /**
     * Wraps {@link Component#setHidden(boolean) }
     *
     * @param b
     * @return
     */
    public ComponentSelector setHidden(boolean b) {
<span class="nc bnc" id="L1080" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L1081">            c.setHidden(b);</span>
<span class="nc" id="L1082">        }</span>
<span class="nc" id="L1083">        return this;</span>
    }

    /**
     * Fades out components in this set.  Uses default duration of 500ms.
     *
     * @return Self for chaining.
     */
    public ComponentSelector fadeOut() {
<span class="nc" id="L1092">        return fadeOut(500);</span>
    }

    /**
     * Fades out components in this set.
     *
     * @param duration Duration of animation.
     * @return Self for chaining.
     */
    public ComponentSelector fadeOut(int duration) {
<span class="nc" id="L1102">        return fadeOut(duration, null);</span>
    }

    /**
     * Fades out components in this set.
     *
     * @param duration Duration of animation.
     * @param callback Callback to run when animation completes.
     * @return Self for chaining.
     */
    public ComponentSelector fadeOut(int duration, final SuccessCallback&lt;ComponentSelector&gt; callback) {
<span class="nc" id="L1113">        final String placeholderProperty = &quot;com.codename1.ui.ComponentSelector#fadeOutPlaceholder&quot;;</span>

<span class="nc" id="L1115">        AnimationManager mgr = null;</span>
<span class="nc" id="L1116">        ArrayList&lt;ComponentAnimation&gt; animations = new ArrayList&lt;ComponentAnimation&gt;();</span>
<span class="nc" id="L1117">        final ArrayList&lt;Component&gt; animatingComponents = new ArrayList&lt;Component&gt;();</span>
<span class="nc bnc" id="L1118" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L1119">            Container parent = c.getParent();</span>
<span class="nc bnc" id="L1120" title="All 2 branches missed.">            if (parent != null) {</span>

<span class="nc" id="L1122">                AnimationManager cmgr = c.getAnimationManager();</span>
<span class="nc bnc" id="L1123" title="All 2 branches missed.">                if (cmgr != null) {</span>
<span class="nc" id="L1124">                    mgr = cmgr;</span>
<span class="nc" id="L1125">                    Container placeholder = new Container();</span>
                    //placeholder.setShowEvenIfBlank(true);
<span class="nc" id="L1127">                    c.putClientProperty(placeholderProperty, placeholder);</span>
<span class="nc" id="L1128">                    Component.setSameHeight(placeholder, c);</span>
<span class="nc" id="L1129">                    Component.setSameWidth(placeholder, c);</span>
<span class="nc" id="L1130">                    $(placeholder)</span>
<span class="nc" id="L1131">                            .setMargin(c.getStyle().getMarginTop(), c.getStyle().getMarginRight(false), c.getStyle().getMarginBottom(), c.getStyle().getMarginLeft(false))</span>
<span class="nc" id="L1132">                            .setPadding(c.getStyle().getPaddingTop(), c.getStyle().getPaddingRight(false), c.getStyle().getPaddingBottom(), c.getStyle().getPaddingLeft(false));</span>

<span class="nc" id="L1134">                    ComponentAnimation a = parent.createReplaceTransition(c, placeholder, CommonTransitions.createFade(duration));</span>
<span class="nc" id="L1135">                    animations.add(a);</span>
<span class="nc" id="L1136">                    animatingComponents.add(c);</span>
                }
                //centerBackground.add(BorderLayout.CENTER, boxy);
            }
<span class="nc" id="L1140">        }</span>
<span class="nc bnc" id="L1141" title="All 2 branches missed.">        if (mgr != null) {</span>
<span class="nc" id="L1142">            mgr.addAnimation(ComponentAnimation.compoundAnimation(animations.toArray(new ComponentAnimation[animations.size()])), new Runnable() {</span>

                public void run() {
<span class="nc bnc" id="L1145" title="All 2 branches missed.">                    for (final Component c : animatingComponents) {</span>
                        //c.setHidden(true);
<span class="nc" id="L1147">                        c.setVisible(false);</span>
<span class="nc" id="L1148">                        final Container placeholder = (Container) c.getClientProperty(placeholderProperty);</span>
<span class="nc" id="L1149">                        c.putClientProperty(placeholderProperty, null);</span>
<span class="nc bnc" id="L1150" title="All 2 branches missed.">                        if (placeholder != null) {</span>
<span class="nc" id="L1151">                            Container parent = placeholder.getParent();</span>
                            /*
                            if (parent == null) {
                                System.out.println(&quot;Deferring replace back&quot;);
                                $(new Runnable() {
                                    public void run() {
                                        Container parent = placeholder.getParent();
                                        if (parent != null) {
                                            System.out.println(&quot;Found parent after deferral&quot;);
                                            parent.replace(placeholder, c, CommonTransitions.createEmpty());
                                        }
                                    }
                                });
                            } else {
                            */
<span class="nc bnc" id="L1166" title="All 2 branches missed.">                            if (parent != null) {</span>

<span class="nc" id="L1168">                                parent.replace(placeholder, c, CommonTransitions.createEmpty());</span>
                            }
                            //}
                        }
<span class="nc" id="L1172">                    }</span>
<span class="nc bnc" id="L1173" title="All 2 branches missed.">                    if (callback != null) {</span>
<span class="nc" id="L1174">                        callback.onSucess(ComponentSelector.this);</span>
                    }

<span class="nc" id="L1177">                }</span>

            });
        }

<span class="nc" id="L1182">        return this;</span>
    }

    /**
     * Hide the matched components with a sliding motion.
     *
     * @param duration Duration of animation
     * @return Self for chaining.
     */
    public ComponentSelector slideUp(int duration) {
<span class="nc" id="L1192">        return slideUp(duration, null);</span>
    }

    /**
     * Hide the matched elements with a sliding motion.
     *
     * @param duration Duration of animation.
     * @param callback Callback to run when animation completes
     * @return Self for chaining.
     */
    public ComponentSelector slideUp(int duration, final SuccessCallback&lt;ComponentSelector&gt; callback) {
<span class="nc" id="L1203">        final ArrayList&lt;Component&gt; animatedComponents = new ArrayList&lt;Component&gt;();</span>
<span class="nc bnc" id="L1204" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L1205">            c.setHeight(0);</span>
<span class="nc" id="L1206">            animatedComponents.add(c);</span>
<span class="nc" id="L1207">        }</span>
<span class="nc" id="L1208">        getParent().animateUnlayout(duration, 255, new SuccessCallback&lt;ComponentSelector&gt;() {</span>

            public void onSucess(ComponentSelector value) {
<span class="nc bnc" id="L1211" title="All 2 branches missed.">                for (Component c : animatedComponents) {</span>
<span class="nc" id="L1212">                    c.setVisible(false);</span>
<span class="nc" id="L1213">                }</span>
<span class="nc" id="L1214">                getParent().revalidate();</span>
<span class="nc bnc" id="L1215" title="All 2 branches missed.">                if (callback != null) {</span>
<span class="nc" id="L1216">                    callback.onSucess(ComponentSelector.this);</span>
                }
<span class="nc" id="L1218">            }</span>

        });
<span class="nc" id="L1221">        return this;</span>
    }

    /**
     * Hide the matched elements with a sliding motion.  Blocks until animation is complete.
     *
     * @param duration Duration of animation.
     * @return Self for chaining.
     */
    public ComponentSelector slideUpAndWait(int duration) {
<span class="fc bfc" id="L1231" title="All 2 branches covered.">        for (Component c : this) {</span>
<span class="fc" id="L1232">            c.setHeight(0);</span>
<span class="fc" id="L1233">        }</span>
<span class="fc" id="L1234">        getParent().animateUnlayoutAndWait(duration, 255);</span>
<span class="fc" id="L1235">        return this;</span>
    }

    /**
     * Display the matched elements with a sliding motion.  Uses default duration of 500ms
     *
     * @return Self for chaining.
     */
    public ComponentSelector slideDown() {
<span class="nc" id="L1244">        return slideDown(500);</span>
    }

    /**
     * Hide the matched elements with a sliding motion.  Uses default duration of 500ms
     *
     * @return Self for chaining.
     */
    public ComponentSelector slideUp() {
<span class="nc" id="L1253">        return slideUp(500);</span>
    }

    /**
     * Display the matched elements with a sliding motion.
     *
     * @param duration Duration of animation.
     * @return Self for chaining.
     */
    public ComponentSelector slideDown(int duration) {
<span class="nc" id="L1263">        return slideDown(duration, null);</span>
    }

    /**
     * Display the matched elements with a sliding motion.
     *
     * @param duration Duration of animation.
     * @param callback Callback to run when animation completes.
     * @return Self for chaining.
     */
    public ComponentSelector slideDown(final int duration, final SuccessCallback&lt;ComponentSelector&gt; callback) {
<span class="nc bnc" id="L1274" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L1275">            c.setHeight(0);</span>
<span class="nc" id="L1276">            c.setVisible(true);</span>
<span class="nc" id="L1277">        }</span>
<span class="nc" id="L1278">        getParent().animateLayout(duration, callback);</span>

<span class="nc" id="L1280">        return this;</span>
    }

    /**
     * Display the matched elements with a sliding motion. Blocks until animation is complete.
     *
     * @param duration Duration of animation.
     * @return Self for chaining.
     */
    public ComponentSelector slideDownAndWait(final int duration) {
<span class="fc" id="L1290">        final ArrayList&lt;Component&gt; animatedComponents = new ArrayList&lt;Component&gt;();</span>
<span class="fc bfc" id="L1291" title="All 2 branches covered.">        for (Component c : this) {</span>
<span class="fc" id="L1292">            c.setHeight(0);</span>
<span class="fc" id="L1293">            c.setVisible(true);</span>
<span class="fc" id="L1294">            animatedComponents.add(c);</span>
<span class="fc" id="L1295">        }</span>
<span class="fc" id="L1296">        getParent().animateLayoutAndWait(duration);</span>

<span class="fc" id="L1298">        return this;</span>
    }

    /**
     * Hide the matched elements by fading them to transparent. Blocks thread until animation is complete.
     *
     * @param duration Duration of animation.
     * @return Self for chaining.
     */
    public ComponentSelector fadeOutAndWait(int duration) {
<span class="nc" id="L1308">        final String placeholderProperty = &quot;com.codename1.ui.ComponentSelector#fadeOutPlaceholder&quot;;</span>

<span class="nc" id="L1310">        AnimationManager mgr = null;</span>
<span class="nc" id="L1311">        ArrayList&lt;ComponentAnimation&gt; animations = new ArrayList&lt;ComponentAnimation&gt;();</span>
<span class="nc" id="L1312">        final ArrayList&lt;Component&gt; animatingComponents = new ArrayList&lt;Component&gt;();</span>
<span class="nc bnc" id="L1313" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L1314">            Container parent = c.getParent();</span>
<span class="nc bnc" id="L1315" title="All 2 branches missed.">            if (parent != null) {</span>

<span class="nc" id="L1317">                AnimationManager cmgr = c.getAnimationManager();</span>
<span class="nc bnc" id="L1318" title="All 2 branches missed.">                if (cmgr != null) {</span>
<span class="nc" id="L1319">                    mgr = cmgr;</span>
<span class="nc" id="L1320">                    Container placeholder = new Container();</span>
                    //placeholder.setShowEvenIfBlank(true);
<span class="nc" id="L1322">                    c.putClientProperty(placeholderProperty, placeholder);</span>
<span class="nc" id="L1323">                    Component.setSameHeight(placeholder, c);</span>
<span class="nc" id="L1324">                    Component.setSameWidth(placeholder, c);</span>
<span class="nc" id="L1325">                    $(placeholder)</span>
<span class="nc" id="L1326">                            .setMargin(c.getStyle().getMarginTop(), c.getStyle().getMarginRight(false), c.getStyle().getMarginBottom(), c.getStyle().getMarginLeft(false))</span>
<span class="nc" id="L1327">                            .setPadding(c.getStyle().getPaddingTop(), c.getStyle().getPaddingRight(false), c.getStyle().getPaddingBottom(), c.getStyle().getPaddingLeft(false));</span>

<span class="nc" id="L1329">                    ComponentAnimation a = parent.createReplaceTransition(c, placeholder, CommonTransitions.createFade(duration));</span>
<span class="nc" id="L1330">                    animations.add(a);</span>
<span class="nc" id="L1331">                    animatingComponents.add(c);</span>
                }
                //centerBackground.add(BorderLayout.CENTER, boxy);
            }
<span class="nc" id="L1335">        }</span>
<span class="nc bnc" id="L1336" title="All 2 branches missed.">        if (mgr != null) {</span>
<span class="nc" id="L1337">            mgr.addAnimationAndBlock(ComponentAnimation.compoundAnimation(animations.toArray(new ComponentAnimation[animations.size()])));</span>

<span class="nc bnc" id="L1339" title="All 2 branches missed.">            for (final Component c : animatingComponents) {</span>

<span class="nc" id="L1341">                c.setVisible(false);</span>
<span class="nc" id="L1342">                final Container placeholder = (Container) c.getClientProperty(placeholderProperty);</span>
<span class="nc" id="L1343">                c.putClientProperty(placeholderProperty, null);</span>
<span class="nc bnc" id="L1344" title="All 2 branches missed.">                if (placeholder != null) {</span>
<span class="nc" id="L1345">                    Container parent = placeholder.getParent();</span>

<span class="nc bnc" id="L1347" title="All 2 branches missed.">                    if (parent != null) {</span>

<span class="nc" id="L1349">                        parent.replace(placeholder, c, CommonTransitions.createEmpty());</span>
                    }

                }
<span class="nc" id="L1353">            }</span>


        }

<span class="nc" id="L1358">        return this;</span>
    }

    /**
     * Replaces the matched components within respective parents with replacements defined by the provided mapper.  Replacements
     * are replaced in the UI itself  (i.e. {@code c.getParent().replace(c, replacement)}) with an empty
     * transition.
     *
     * @param mapper Mapper that defines the replacements for each component in the set.  If the mapper returns
     *               the input component, then no change is made for that component.  A null return value cause the component
     *               to be removed from its parent.  Returning a Component results in that component replacing the original component
     *               within its parent.
     * @return A new ComponentSelector with the replacement components.
     */
    public ComponentSelector replace(ComponentMapper mapper) {
<span class="nc" id="L1373">        return replace(mapper, CommonTransitions.createEmpty());</span>
    }

    /**
     * Replaces the matched components within respective parents with replacements defined by the provided mapper.  Replacements
     * are replaced in the UI itself  (i.e. {@code c.getParent().replace(c, replacement)}) with the provided transition.
     *
     * @param mapper Mapper that defines the replacements for each component in the set.  If the mapper returns
     *               the input component, then no change is made for that component.  A null return value cause the component
     *               to be removed from its parent.  Returning a Component results in that component replacing the original component
     *               within its parent.
     * @param t      Transition to use for replacements.
     * @return A new ComponentSelector with the replacement components.
     */
    public ComponentSelector replace(ComponentMapper mapper, Transition t) {
<span class="nc" id="L1388">        ArrayList&lt;ComponentAnimation&gt; animations = new ArrayList&lt;ComponentAnimation&gt;();</span>
<span class="nc" id="L1389">        LinkedHashSet&lt;Component&gt; replacements = new LinkedHashSet&lt;Component&gt;();</span>
<span class="nc bnc" id="L1390" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L1391">            Container parent = c.getParent();</span>
<span class="nc" id="L1392">            Component replacement = mapper.map(c);</span>
<span class="nc bnc" id="L1393" title="All 2 branches missed.">            if (parent != null) {</span>
<span class="nc bnc" id="L1394" title="All 2 branches missed.">                if (replacement != c) {</span>
<span class="nc bnc" id="L1395" title="All 2 branches missed.">                    if (replacement != null) {</span>
<span class="nc" id="L1396">                        animations.add(parent.createReplaceTransition(c, replacement, t.copy(false)));</span>
                    } else {
<span class="nc" id="L1398">                        c.remove();</span>
                    }
                }
            }
<span class="nc bnc" id="L1402" title="All 2 branches missed.">            if (replacement != null) {</span>
<span class="nc" id="L1403">                replacements.add(replacement);</span>
            }
<span class="nc" id="L1405">        }</span>
<span class="nc" id="L1406">        AnimationManager mgr = getAnimationManager();</span>
<span class="nc bnc" id="L1407" title="All 4 branches missed.">        if (mgr != null &amp;&amp; animations.size() &gt; 0) {</span>
<span class="nc" id="L1408">            mgr.addAnimation(ComponentAnimation.compoundAnimation(animations.toArray(new ComponentAnimation[animations.size()])));</span>
        }
<span class="nc" id="L1410">        return new ComponentSelector(replacements);</span>

    }

    /**
     * Replaces the matched components within respective parents with replacements defined by the provided mapper.  Replacements
     * are replaced in the UI itself  (i.e. {@code c.getParent().replace(c, replacement)}) with the provided transition.
     * Blocks the thread until the transition animation is complete.
     *
     * @param mapper Mapper that defines the replacements for each component in the set.  If the mapper returns
     *               the input component, then no change is made for that component.  A null return value cause the component
     *               to be removed from its parent.  Returning a Component results in that component replacing the original component
     *               within its parent.
     * @param t
     * @return A new ComponentSelector with the replacement components.
     */
    public ComponentSelector replaceAndWait(ComponentMapper mapper, Transition t) {
<span class="nc" id="L1427">        ArrayList&lt;ComponentAnimation&gt; animations = new ArrayList&lt;ComponentAnimation&gt;();</span>
<span class="nc" id="L1428">        LinkedHashSet&lt;Component&gt; replacements = new LinkedHashSet&lt;Component&gt;();</span>
<span class="nc bnc" id="L1429" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L1430">            Container parent = c.getParent();</span>
<span class="nc" id="L1431">            Component replacement = mapper.map(c);</span>
<span class="nc bnc" id="L1432" title="All 2 branches missed.">            if (parent != null) {</span>
<span class="nc bnc" id="L1433" title="All 2 branches missed.">                if (replacement != c) {</span>
<span class="nc bnc" id="L1434" title="All 2 branches missed.">                    if (replacement != null) {</span>
<span class="nc" id="L1435">                        animations.add(parent.createReplaceTransition(c, replacement, t.copy(false)));</span>
                    } else {
<span class="nc" id="L1437">                        c.remove();</span>
                    }
                }
            }
<span class="nc bnc" id="L1441" title="All 2 branches missed.">            if (replacement != null) {</span>
<span class="nc" id="L1442">                replacements.add(replacement);</span>
            }
<span class="nc" id="L1444">        }</span>
<span class="nc" id="L1445">        AnimationManager mgr = getAnimationManager();</span>
<span class="nc bnc" id="L1446" title="All 4 branches missed.">        if (mgr != null &amp;&amp; animations.size() &gt; 0) {</span>
<span class="nc" id="L1447">            mgr.addAnimationAndBlock(ComponentAnimation.compoundAnimation(animations.toArray(new ComponentAnimation[animations.size()])));</span>
        }

<span class="nc" id="L1450">        return new ComponentSelector(replacements);</span>
    }

    /**
     * Uses the results of this selector as the roots to create a new selector with
     * the provided selector string.
     *
     * @param selector The selector string.
     * @return A new ComponentSelector with the results of the query.
     */
    public ComponentSelector find(String selector) {
<span class="fc" id="L1461">        return new ComponentSelector(selector, resultsImpl());</span>
    }

    private void parse(String selector) {
<span class="fc" id="L1465">        selector = selector.trim();</span>

<span class="fc bfc" id="L1467" title="All 2 branches covered.">        if (selector.indexOf(&quot;,&quot;) != -1) {</span>
            // this is an aggregate selector
<span class="fc" id="L1469">            String[] parts = Util.split(selector, &quot;,&quot;);</span>

<span class="fc" id="L1471">            aggregateSelectors = new LinkedHashSet&lt;ComponentSelector&gt;();</span>
<span class="fc bfc" id="L1472" title="All 2 branches covered.">            for (String part : parts) {</span>
<span class="fc" id="L1473">                part = part.trim();</span>
<span class="pc bpc" id="L1474" title="1 of 2 branches missed.">                if (part.length() == 0) {</span>
<span class="nc" id="L1475">                    continue;</span>
                }
<span class="fc" id="L1477">                aggregateSelectors.add(new ComponentSelector(part, roots));</span>
            }
<span class="fc" id="L1479">            return;</span>

        }

<span class="fc" id="L1483">        String[] parts = Util.split(selector, &quot; &quot;);</span>
<span class="fc" id="L1484">        int len = parts.length;</span>
<span class="fc bfc" id="L1485" title="All 2 branches covered.">        if (len &gt; 1) {</span>
<span class="fc" id="L1486">            StringBuilder parentSelector = new StringBuilder();</span>
<span class="fc bfc" id="L1487" title="All 2 branches covered.">            for (int i = 0; i &lt; len; i++) {</span>
<span class="pc bpc" id="L1488" title="1 of 2 branches missed.">                if (&quot;&gt;&quot;.equals(parts[i])) {</span>
<span class="pc bpc" id="L1489" title="1 of 2 branches missed.">                    if (i &lt; len - 1) {</span>
<span class="fc" id="L1490">                        parts[i] = &quot;&gt;&quot; + parts[i + 1].trim();</span>
<span class="pc bpc" id="L1491" title="1 of 2 branches missed.">                        for (int j = i + 1; j &lt; len - 1; j++) {</span>
<span class="nc" id="L1492">                            parts[j] = parts[j + 1];</span>
                        }
<span class="fc" id="L1494">                        len--;</span>
<span class="fc" id="L1495">                        parts[len] = null;</span>
                    } else {
<span class="nc" id="L1497">                        throw new IllegalArgumentException(&quot;Failed to parse selector.  Selector cannot end with '&gt;'&quot;);</span>
                    }
                }
<span class="pc bpc" id="L1500" title="3 of 4 branches missed.">                if (i &gt; 0 &amp;&amp; i &lt; len - 1) {</span>
<span class="nc" id="L1501">                    parentSelector.append(&quot; &quot;);</span>
                }
<span class="pc bpc" id="L1503" title="1 of 2 branches missed.">                if (i &lt; len - 1) {</span>
<span class="nc" id="L1504">                    parentSelector.append(parts[i]);</span>
                }
<span class="pc bpc" id="L1506" title="1 of 2 branches missed.">                if (i == len - 1) {</span>
<span class="fc" id="L1507">                    selector = parts[i];</span>
                }
            }
<span class="pc bpc" id="L1510" title="1 of 2 branches missed.">            if (parentSelector.length() &gt; 0) {</span>
<span class="nc" id="L1511">                parent = new ComponentSelector(parentSelector.toString(), roots);</span>
<span class="nc" id="L1512">                roots.clear();</span>
            }
        }


<span class="fc bfc" id="L1517" title="All 2 branches covered.">        if (selector.indexOf(&quot;&gt;&quot;) == 0) {</span>
<span class="fc" id="L1518">            childrenOnly = true;</span>
<span class="fc" id="L1519">            selector = selector.substring(1).trim();</span>
        }

<span class="pc bpc" id="L1522" title="1 of 2 branches missed.">        if (selector.indexOf(&quot;,&quot;) != -1) {</span>
<span class="nc" id="L1523">            throw new IllegalArgumentException(&quot;Invalid character in selector &quot; + selector);</span>
        } else {
<span class="fc" id="L1525">            ComponentSelector out = this;</span>
<span class="fc" id="L1526">            selector = selector.trim();</span>


            int pos;

<span class="pc bpc" id="L1531" title="1 of 2 branches missed.">            if ((pos = selector.indexOf(&quot;:&quot;)) != -1) {</span>
<span class="nc" id="L1532">                out.state = selector.substring(pos + 1);</span>
<span class="nc" id="L1533">                selector = selector.substring(0, pos);</span>
            }
<span class="fc bfc" id="L1535" title="All 2 branches covered.">            if ((pos = selector.indexOf(&quot;.&quot;)) != -1) {</span>
<span class="fc" id="L1536">                out.tags = Util.split(selector.substring(pos + 1), &quot;.&quot;);</span>
<span class="fc" id="L1537">                len = out.tags.length;</span>
<span class="fc" id="L1538">                out.tagsNeedles = new String[len];</span>
<span class="fc" id="L1539">                String[] needles = out.tagsNeedles;</span>
<span class="fc" id="L1540">                String[] tags = out.tags;</span>
<span class="fc bfc" id="L1541" title="All 2 branches covered.">                for (int i = 0; i &lt; len; i++) {</span>
<span class="fc" id="L1542">                    needles[i] = &quot; &quot; + tags[i] + &quot; &quot;; // Will make it easier to match against components' tags.</span>
                }
<span class="fc" id="L1544">                selector = selector.substring(0, pos);</span>
            }
<span class="fc bfc" id="L1546" title="All 2 branches covered.">            if ((pos = selector.indexOf(&quot;#&quot;)) &gt;= 0) {</span>
<span class="fc" id="L1547">                out.name = selector.substring(pos + 1);</span>
<span class="fc" id="L1548">                selector = selector.substring(0, pos);</span>
            }
<span class="fc bfc" id="L1550" title="All 4 branches covered.">            if (selector.length() &gt; 0 &amp;&amp; !&quot;*&quot;.equals(selector)) {</span>
<span class="fc" id="L1551">                out.uiid = selector;</span>
            }
<span class="pc bpc" id="L1553" title="1 of 2 branches missed.">            if (state != null) {</span>
<span class="nc bnc" id="L1554" title="All 2 branches missed.">                if (&quot;pressed&quot;.equals(state)) {</span>
<span class="nc" id="L1555">                    currentStyleType = PRESSED_STYLE;</span>
<span class="nc bnc" id="L1556" title="All 2 branches missed.">                } else if (&quot;selected&quot;.equals(state)) {</span>
<span class="nc" id="L1557">                    currentStyleType = SELECTED_STYLE;</span>
<span class="nc bnc" id="L1558" title="All 2 branches missed.">                } else if (&quot;unselected&quot;.equals(state)) {</span>
<span class="nc" id="L1559">                    currentStyleType = UNSELECTED_STYLE;</span>
<span class="nc bnc" id="L1560" title="All 2 branches missed.">                } else if (&quot;disabled&quot;.equals(state)) {</span>
<span class="nc" id="L1561">                    currentStyleType = DISABLED_STYLE;</span>
<span class="nc bnc" id="L1562" title="All 4 branches missed.">                } else if (&quot;all&quot;.equals(state) || &quot;*&quot;.equals(state)) {</span>
<span class="nc" id="L1563">                    currentStyleType = ALL_STYLES;</span>
                }
            }
            //return out;

        }

<span class="fc" id="L1570">    }</span>

    private boolean match(Component c) {


<span class="fc bfc" id="L1575" title="All 4 branches covered.">        if (name != null &amp;&amp; !name.equals(c.getName())) {</span>
<span class="fc" id="L1576">            return false;</span>
        }
<span class="fc bfc" id="L1578" title="All 4 branches covered.">        if (uiid != null &amp;&amp; !uiid.equals(c.getUIID())) {</span>
<span class="fc" id="L1579">            return false;</span>
        }
<span class="fc bfc" id="L1581" title="All 2 branches covered.">        if (tags != null) {</span>
<span class="fc" id="L1582">            String ctags = (String) c.getClientProperty(PROPERTY_TAG);</span>

<span class="fc bfc" id="L1584" title="All 2 branches covered.">            if (ctags != null) {</span>
<span class="fc bfc" id="L1585" title="All 2 branches covered.">                for (String ctag : tagsNeedles) {</span>
<span class="pc bpc" id="L1586" title="1 of 2 branches missed.">                    if (ctags.indexOf(ctag) == -1) {</span>
<span class="nc" id="L1587">                        return false;</span>
                    }
                }
            } else {
<span class="fc" id="L1591">                return false;</span>
            }
        }

<span class="fc" id="L1595">        return true;</span>


    }

    /**
     * Returns the results of this selector.
     *
     * @return
     */
    public Iterator&lt;Component&gt; iterator() {
<span class="fc" id="L1606">        return resultsImpl().iterator();</span>
    }

    private Set&lt;Component&gt; resultsImpl() {
<span class="fc bfc" id="L1610" title="All 2 branches covered.">        if (results == null) {</span>
<span class="fc" id="L1611">            results = new LinkedHashSet&lt;Component&gt;();</span>

<span class="fc bfc" id="L1613" title="All 2 branches covered.">            if (aggregateSelectors != null) {</span>
<span class="fc bfc" id="L1614" title="All 2 branches covered.">                for (ComponentSelector sel : aggregateSelectors) {</span>
<span class="fc" id="L1615">                    results.addAll(sel.resultsImpl());</span>
<span class="fc" id="L1616">                }</span>
<span class="fc" id="L1617">                return results;</span>
            }

<span class="pc bpc" id="L1620" title="1 of 2 branches missed.">            if (parent != null) {</span>
<span class="nc" id="L1621">                roots.clear();</span>
<span class="nc" id="L1622">                roots.addAll(parent.resultsImpl());</span>
            }

<span class="fc bfc" id="L1625" title="All 2 branches covered.">            for (Component root : roots) {</span>
<span class="fc bfc" id="L1626" title="All 2 branches covered.">                if (childrenOnly) {</span>
<span class="pc bpc" id="L1627" title="1 of 2 branches missed.">                    if (root instanceof Container) {</span>
<span class="fc" id="L1628">                        Container cnt = (Container) root;</span>
<span class="fc bfc" id="L1629" title="All 2 branches covered.">                        for (Component child : cnt) {</span>
<span class="pc bpc" id="L1630" title="1 of 2 branches missed.">                            if (match(child)) {</span>
<span class="fc" id="L1631">                                results.add(child);</span>
                            }
<span class="fc" id="L1633">                        }</span>
<span class="fc" id="L1634">                    }</span>
                } else {
<span class="pc bpc" id="L1636" title="1 of 2 branches missed.">                    if (root instanceof Container) {</span>
<span class="fc" id="L1637">                        Container cnt = (Container) root;</span>
<span class="fc bfc" id="L1638" title="All 2 branches covered.">                        for (int iter = 0; iter &lt; cnt.getComponentCount(); iter++) {</span>
<span class="fc" id="L1639">                            Component child = cnt.getComponentAt(iter);</span>
<span class="fc" id="L1640">                            resultsImpl(results, child);</span>
                        }
                    }
                }
<span class="fc" id="L1644">            }</span>
        }
<span class="fc" id="L1646">        return results;</span>
    }


    private Set&lt;Component&gt; resultsImpl(Set&lt;Component&gt; out, Component root) {
<span class="fc bfc" id="L1651" title="All 2 branches covered.">        if (match(root)) {</span>
<span class="fc" id="L1652">            out.add(root);</span>
        }
<span class="fc bfc" id="L1654" title="All 2 branches covered.">        if (root instanceof Container) {</span>
<span class="fc" id="L1655">            Container cnt = (Container) root;</span>
<span class="fc bfc" id="L1656" title="All 2 branches covered.">            for (int iter = 0; iter &lt; cnt.getComponentCount(); iter++) {</span>
<span class="fc" id="L1657">                Component child = cnt.getComponentAt(iter);</span>
<span class="fc" id="L1658">                resultsImpl(out, child);</span>
            }
        }
<span class="fc" id="L1661">        return out;</span>
    }

    /**
     * Gets a proxy style that wraps the result of {@link Component#getStyle() } of each component in set.
     *
     * @return
     */
    public Style getStyle() {
<span class="fc" id="L1670">        HashSet&lt;Style&gt; out = new HashSet&lt;Style&gt;();</span>
<span class="fc bfc" id="L1671" title="All 2 branches covered.">        for (Component c : this) {</span>
<span class="fc" id="L1672">            out.add(c.getStyle());</span>
<span class="fc" id="L1673">        }</span>
<span class="fc" id="L1674">        return Style.createProxyStyle(out.toArray(new Style[out.size()]));</span>
    }

    /**
     * Gets a style object for the given component that can be used to modify the
     * component's styles.  This takes into account any state-pseudo classes that
     * were used to create this selector so that the style returned will be appropriate.
     *
     * &lt;p&gt;E.g. &lt;pre&gt;
     * {@code
     *
     * ComponentSelector sel = new ComponentSelector(&quot;Button:pressed&quot;);
     * Style style = sel.getStyle(sel.get(0));
     *     // This should be equivalent to sel.get(0).getPressedStyle()
     *
     * sel = new ComponentSelector(&quot;Button&quot;);
     * style = sel.getStyle(sel.get(0));
     *     // This should be equivalent to sel.get(0).getAllStyles()
     *
     * sel = new ComponentSelector(&quot;Button:pressed, Button:selected&quot;);
     * style = sel.getStyle(sel.get(0));
     *     // This should be same as
     *     // Style.createProxyStyle(sel.get(0).getPressedStyle(), sel.get(0).getSelectedStyle())
     * }
     * &lt;/pre&gt;
     *
     * @param component The component whose style object we wish to obtain.
     * @return A style object that will allow us to modify the style of the given component.
     */
    public Style getStyle(Component component) {
<span class="nc bnc" id="L1704" title="All 6 branches missed.">        switch (currentStyleType) {</span>
            case SELECTED_STYLE:
<span class="nc" id="L1706">                return component.getSelectedStyle();</span>
            case UNSELECTED_STYLE:
<span class="nc" id="L1708">                return component.getUnselectedStyle();</span>
            case DISABLED_STYLE:
<span class="nc" id="L1710">                return component.getDisabledStyle();</span>
            case PRESSED_STYLE:
<span class="nc" id="L1712">                return component.getPressedStyle();</span>
            case ALL_STYLES:
<span class="nc" id="L1714">                return component.getAllStyles();</span>
            default:
<span class="nc" id="L1716">                return component.getStyle();</span>
        }

    }

    /**
     * Returns a proxy style for all of the selected styles of the components in this set.
     *
     * @return Proxy style to easily change properties of the selected styles of all
     * components in this set.
     */
    public Style getSelectedStyle() {
<span class="nc" id="L1728">        ArrayList&lt;Style&gt; styles = new ArrayList&lt;Style&gt;();</span>
<span class="nc bnc" id="L1729" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L1730">            styles.add(c.getSelectedStyle());</span>
<span class="nc" id="L1731">        }</span>
<span class="nc" id="L1732">        return Style.createProxyStyle(styles.toArray(new Style[styles.size()]));</span>
    }

    /**
     * Sets selected style of all components in found set.
     * Wraps {@link Component#setSelectedStyle(com.codename1.ui.plaf.Style) }
     *
     * @param style
     * @return
     */
    public ComponentSelector setSelectedStyle(Style style) {
<span class="nc bnc" id="L1743" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L1744">            c.setSelectedStyle(style);</span>
<span class="nc" id="L1745">        }</span>
<span class="nc" id="L1746">        return this;</span>
    }

    /**
     * Sets the current style to the selected style.  Style mutation methods called after
     * calling this method will modify the components' &quot;selected style&quot;.
     *
     * @return Self for chaining.
     * @see Component#getSelectedStyle()
     */
    public ComponentSelector selectSelectedStyle() {
<span class="nc" id="L1757">        currentStyle = getSelectedStyle();</span>
<span class="nc" id="L1758">        currentStyleType = SELECTED_STYLE;</span>
<span class="nc" id="L1759">        return this;</span>
    }

    /**
     * Sets the current style to the unselected style.  Style mutation methods called after
     * calling this method will modify the components' &quot;unselected style&quot;.
     *
     * @return Self for chaining.
     * @see Component#getUnselectedStyle()
     */
    public ComponentSelector selectUnselectedStyle() {
<span class="fc" id="L1770">        currentStyle = getUnselectedStyle();</span>
<span class="fc" id="L1771">        currentStyleType = UNSELECTED_STYLE;</span>
<span class="fc" id="L1772">        return this;</span>
    }

    /**
     * Sets the current style to the pressed style.  Style mutation methods called after
     * calling this method will modify the components' &quot;pressed style&quot;.
     *
     * @return Self for chaining.
     * @see Component#getPressedStyle()
     */
    public ComponentSelector selectPressedStyle() {
<span class="fc" id="L1783">        currentStyle = getPressedStyle();</span>
<span class="fc" id="L1784">        currentStyleType = PRESSED_STYLE;</span>
<span class="fc" id="L1785">        return this;</span>
    }

    /**
     * Sets the current style to the disabled style.  Style mutation methods called after
     * calling this method will modify the components' &quot;disabled style&quot;.
     *
     * @return Self for chaining.
     * @see Component#getDisabledStyle()
     */
    public ComponentSelector selectDisabledStyle() {
<span class="fc" id="L1796">        currentStyle = getDisabledStyle();</span>
<span class="fc" id="L1797">        currentStyleType = DISABLED_STYLE;</span>
<span class="fc" id="L1798">        return this;</span>
    }

    /**
     * Sets the current style to each component's ALL STYLES proxy style.  Style mutation methods called after
     * calling this method will modify the components' &quot;all styles&quot; proxy style.
     *
     * @return Self for chaining.
     * @see Component#getAllStyles()
     */
    public ComponentSelector selectAllStyles() {
<span class="fc" id="L1809">        currentStyle = getAllStyles();</span>
<span class="fc" id="L1810">        currentStyleType = ALL_STYLES;</span>
<span class="fc" id="L1811">        return this;</span>
    }

    /**
     * Returns a proxy style for all of the unselected styles of the components in this set.
     *
     * @return Proxy style to easily change properties of the unselected styles of all
     * components in this set.
     */
    public Style getUnselectedStyle() {
<span class="fc" id="L1821">        ArrayList&lt;Style&gt; styles = new ArrayList&lt;Style&gt;();</span>
<span class="fc bfc" id="L1822" title="All 2 branches covered.">        for (Component c : this) {</span>
<span class="fc" id="L1823">            styles.add(c.getUnselectedStyle());</span>
<span class="fc" id="L1824">        }</span>
<span class="fc" id="L1825">        return Style.createProxyStyle(styles.toArray(new Style[styles.size()]));</span>
    }

    /**
     * Sets unselected style of all components in found set.
     * Wraps {@link Component#setUnselectedStyle(com.codename1.ui.plaf.Style) }
     *
     * @param style
     * @return
     */
    public ComponentSelector setUnselectedStyle(Style style) {
<span class="nc bnc" id="L1836" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L1837">            c.setUnselectedStyle(style);</span>
<span class="nc" id="L1838">        }</span>
<span class="nc" id="L1839">        return this;</span>
    }

    /**
     * Returns a proxy style for all of the pressed styles of the components in this set.
     *
     * @return Proxy style to easily change properties of the pressed styles of all
     * components in this set.
     */
    public Style getPressedStyle() {
<span class="fc" id="L1849">        ArrayList&lt;Style&gt; styles = new ArrayList&lt;Style&gt;();</span>
<span class="fc bfc" id="L1850" title="All 2 branches covered.">        for (Component c : this) {</span>
<span class="fc" id="L1851">            styles.add(c.getPressedStyle());</span>
<span class="fc" id="L1852">        }</span>
<span class="fc" id="L1853">        return Style.createProxyStyle(styles.toArray(new Style[styles.size()]));</span>
    }

    /**
     * Sets pressed style of all components in found set.
     * Wraps {@link Component#setPressedStyle(com.codename1.ui.plaf.Style) }
     *
     * @param style
     * @return
     */
    public ComponentSelector setPressedStyle(Style style) {
<span class="nc bnc" id="L1864" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L1865">            c.setPressedStyle(style);</span>
<span class="nc" id="L1866">        }</span>
<span class="nc" id="L1867">        return this;</span>
    }

    /**
     * Returns a proxy style for all of the disabled styles of the components in this set.
     *
     * @return Proxy style to easily change properties of the disabled styles of all
     * components in this set.
     */
    public Style getDisabledStyle() {
<span class="fc" id="L1877">        ArrayList&lt;Style&gt; styles = new ArrayList&lt;Style&gt;();</span>
<span class="fc bfc" id="L1878" title="All 2 branches covered.">        for (Component c : this) {</span>
<span class="fc" id="L1879">            styles.add(c.getDisabledStyle());</span>
<span class="fc" id="L1880">        }</span>
<span class="fc" id="L1881">        return Style.createProxyStyle(styles.toArray(new Style[styles.size()]));</span>
    }

    /**
     * Sets disabled style of all components in found set.
     * Wraps {@link Component#setDisabledStyle(com.codename1.ui.plaf.Style) }
     *
     * @param style
     * @return
     */
    public ComponentSelector setDisabledStyle(Style style) {
<span class="nc bnc" id="L1892" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L1893">            c.setDisabledStyle(style);</span>
<span class="nc" id="L1894">        }</span>
<span class="nc" id="L1895">        return this;</span>
    }

    /**
     * Returns a proxy style for all of the &quot;all&quot; styles of the components in this set.
     *
     * @return Proxy style to easily change properties of the &quot;all&quot; styles of all
     * components in this set.
     */
    public Style getAllStyles() {
<span class="fc" id="L1905">        ArrayList&lt;Style&gt; styles = new ArrayList&lt;Style&gt;();</span>
<span class="fc bfc" id="L1906" title="All 2 branches covered.">        for (Component c : this) {</span>
<span class="fc" id="L1907">            styles.add(c.getAllStyles());</span>
<span class="fc" id="L1908">        }</span>
<span class="fc" id="L1909">        return Style.createProxyStyle(styles.toArray(new Style[styles.size()]));</span>
    }

    /**
     * Returns number of results found.
     *
     * @return
     */
    public int size() {
<span class="fc" id="L1918">        return resultsImpl().size();</span>
    }

    /**
     * @return True if there were no results.
     */
    public boolean isEmpty() {
<span class="nc" id="L1925">        return resultsImpl().isEmpty();</span>
    }

    /**
     * Checks if an object is contained in result set.
     *
     * @param o
     * @return
     */
    public boolean contains(Object o) {
<span class="fc" id="L1935">        return resultsImpl().contains(o);</span>
    }

    /**
     * Returns results as an array.
     *
     * @return
     */
    public Object[] toArray() {
<span class="fc" id="L1944">        return resultsImpl().toArray();</span>
    }

    /**
     * Returns results as an array.
     *
     * @param &lt;T&gt;
     * @param a
     * @return
     */
    public &lt;T&gt; T[] toArray(T[] a) {
<span class="nc" id="L1955">        return resultsImpl().toArray(a);</span>
    }

    /**
     * Explicitly adds a component to the result set.
     *
     * @param e
     * @return True on success
     */
    public boolean add(Component e) {
<span class="nc" id="L1965">        setDirty();</span>
<span class="nc" id="L1966">        return resultsImpl().add(e);</span>
    }

    /**
     * Appends a child component to the first container in this set.  Same as calling
     * {@link Container#add(com.codename1.ui.Component) } padding {@literal child} on first container
     * in this set.
     *
     * @param child Component to add to container.
     * @return Self for chaining.
     */
    public ComponentSelector append(Component child) {
<span class="nc bnc" id="L1978" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L1979" title="All 2 branches missed.">            if (c instanceof Container) {</span>
<span class="nc" id="L1980">                Container cnt = (Container) c;</span>
<span class="nc" id="L1981">                cnt.add(child);</span>
<span class="nc" id="L1982">                return this;</span>
            }
<span class="nc" id="L1984">        }</span>
<span class="nc" id="L1985">        return this;</span>
    }

    /**
     * Appends a child component to the first container in this set.  Same as calling
     * {@link Container#add(java.lang.Object, com.codename1.ui.Component) } padding {@literal child} on first container
     * in this set.
     *
     * @param constraint
     * @param child
     * @return
     */
    public ComponentSelector append(Object constraint, Component child) {
<span class="nc bnc" id="L1998" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L1999" title="All 2 branches missed.">            if (c instanceof Container) {</span>
<span class="nc" id="L2000">                Container cnt = (Container) c;</span>
<span class="nc" id="L2001">                cnt.add(constraint, child);</span>
<span class="nc" id="L2002">                return this;</span>
            }
<span class="nc" id="L2004">        }</span>
<span class="nc" id="L2005">        return this;</span>
    }

    /**
     * Append a child element to each container in this set.  The {@literal mapper} callback
     * will receive a Container as input (that is the parent to be added to), and should return
     * a Component that is to be added to it.  If the mapper returns null, then nothing is
     * added to that container.
     *
     * @param mapper
     * @return
     */
    public ComponentSelector append(ComponentMapper mapper) {
<span class="nc bnc" id="L2018" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L2019" title="All 2 branches missed.">            if (c instanceof Container) {</span>
<span class="nc" id="L2020">                Component child = mapper.map(c);</span>
<span class="nc bnc" id="L2021" title="All 2 branches missed.">                if (child != null) {</span>
<span class="nc" id="L2022">                    ((Container) c).add(child);</span>
                }
            }
<span class="nc" id="L2025">        }</span>
<span class="nc" id="L2026">        return this;</span>
    }

    /**
     * Append a child element to each container in this set.  The {@literal mapper} callback
     * will receive a Container as input (that is the parent to be added to), and should return
     * a Component that is to be added to it.  If the mapper returns null, then nothing is
     * added to that container.
     *
     * @param constraint
     * @param mapper
     * @return
     */
    public ComponentSelector append(Object constraint, ComponentMapper mapper) {
<span class="nc bnc" id="L2040" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L2041" title="All 2 branches missed.">            if (c instanceof Container) {</span>
<span class="nc" id="L2042">                Component child = mapper.map(c);</span>
<span class="nc" id="L2043">                ((Container) c).add(constraint, child);</span>
            }
<span class="nc" id="L2045">        }</span>
<span class="nc" id="L2046">        return this;</span>
    }

    /**
     * Fluent API wrapper for {@link #add(com.codename1.ui.Component) }
     *
     * @param e     Component to add to set.
     * @param chain Dummy argument so that this version would have a different signature than {@link Set#add(java.lang.Object) }
     * @return Self for chaining.
     */
    public ComponentSelector add(Component e, boolean chain) {
<span class="nc" id="L2057">        add(e);</span>
<span class="nc" id="L2058">        return this;</span>
    }

    /**
     * Explicitly removes a component from the result set.
     *
     * @param o
     * @return Self for chaining.
     */
    public boolean remove(Object o) {
<span class="nc" id="L2068">        setDirty();</span>
<span class="nc" id="L2069">        return resultsImpl().remove(o);</span>
    }

    /**
     * Fluent API wrapper for {@link #remove(java.lang.Object) }.
     *
     * @param o     The component to remove from set.
     * @param chain Dummy argument so that this version would have a different signature than {@link Set#remove(java.lang.Object) }
     * @return Self for chaining.
     */
    public ComponentSelector remove(Object o, boolean chain) {
<span class="nc" id="L2080">        remove(o);</span>
<span class="nc" id="L2081">        return this;</span>
    }

    /**
     * Checks if the result set contains all of the components found in the provided
     * collection.
     *
     * @param c
     * @return
     */
    public boolean containsAll(Collection&lt;?&gt; c) {
<span class="nc" id="L2092">        return resultsImpl().containsAll(c);</span>
    }

    /**
     * Adds all components in the given collection to the result set.
     *
     * @param c
     * @return
     */
    public boolean addAll(Collection&lt;? extends Component&gt; c) {
<span class="nc" id="L2102">        setDirty();</span>
<span class="nc" id="L2103">        return resultsImpl().addAll(c);</span>
    }

    /**
     * Fluent API wrapper for {@link #addAll(java.util.Collection) }.
     *
     * @param c     The set of components to add to this set.
     * @param chain Dummy argument so that this version would have a different signature than {@link #addAll(java.util.Collection) }
     * @return Self for chaining.
     */
    public ComponentSelector addAll(Collection&lt;? extends Component&gt; c, boolean chain) {
<span class="nc" id="L2114">        addAll(c);</span>
<span class="nc" id="L2115">        return this;</span>
    }

    /**
     * Returns the first component in this set.  This is useful for single component sets (e.g. {@code $(new Label()).setFgColor(0xff0000).asComponent() }).
     *
     * @return The first component in this set.
     */
    public Component asComponent() {
<span class="fc" id="L2124">        Iterator&lt;Component&gt; iterator = iterator(); // PMD Fix: AvoidBranchingStatementAsLastInLoop</span>
<span class="fc bfc" id="L2125" title="All 2 branches covered.">        if (iterator.hasNext()) {</span>
<span class="fc" id="L2126">            return iterator.next();</span>
        }
<span class="fc" id="L2128">        return null;</span>
    }

    /**
     * Returns the first component in this set.  This is useful for single component sets (e.g. {@code $(new Label()).setFgColor(0xff0000).asComponent(Label.class) }).
     *
     * @param &lt;T&gt;  The type of component to return
     * @param type The type of component that is expected to be returned.
     * @return The first component in this set.
     */
    public &lt;T extends Component&gt; T asComponent(Class&lt;T&gt; type) {
<span class="fc" id="L2139">        return (T) asComponent();</span>
    }

    /**
     * Returns the components of this set as a List.  Note that order of elements is not maintained since
     * ComponentSelector is a set (i.e. has no notion of element order).
     *
     * @return The components in this set as a list.
     */
    public java.util.List&lt;Component&gt; asList() {
<span class="nc" id="L2149">        ArrayList&lt;Component&gt; out = new ArrayList&lt;Component&gt;();</span>
<span class="nc" id="L2150">        out.addAll(this);</span>
<span class="nc" id="L2151">        return out;</span>
    }

    /**
     * Retains only elements of the result set that are contained in the provided collection.
     *
     * @param c
     * @return
     */
    public boolean retainAll(Collection&lt;?&gt; c) {
<span class="nc" id="L2161">        setDirty();</span>
<span class="nc" id="L2162">        return resultsImpl().retainAll(c);</span>
    }

    /**
     * Fluent API wrapper for {@link #retainAll(java.util.Collection) }
     *
     * @param c     The collection to retain.
     * @param chain Dummy arg.
     * @return Self for chaining.
     */
    public ComponentSelector retainAll(Collection&lt;?&gt; c, boolean chain) {
<span class="nc" id="L2173">        retainAll(c);</span>
<span class="nc" id="L2174">        return this;</span>
    }

    /**
     * Removes all of the components in the provided collection from the result set.
     *
     * @param c
     * @return
     */
    public boolean removeAll(Collection&lt;?&gt; c) {
<span class="nc" id="L2184">        setDirty();</span>
<span class="nc" id="L2185">        return resultsImpl().removeAll(c);</span>
    }

    /**
     * Fluent API wrapper for {@link #removeAll(java.util.Collection) }
     *
     * @param c     Collection with components to remove,
     * @param chain Dummy arg.
     * @return Self for chaining.
     */
    public ComponentSelector removeAll(Collection&lt;?&gt; c, boolean chain) {
<span class="nc" id="L2196">        removeAll(c);</span>
<span class="nc" id="L2197">        return this;</span>
    }

    /**
     * Clears the result set.
     */
    public void clear() {
<span class="nc" id="L2204">        setDirty();</span>
<span class="nc" id="L2205">        resultsImpl().clear();</span>
<span class="nc" id="L2206">    }</span>

    /**
     * Fluent API wrapper for (@link #clear()}
     *
     * @param chain Dummy arg
     * @return Self for chaining.
     */
    public ComponentSelector clear(boolean chain) {
<span class="nc" id="L2215">        clear();</span>
<span class="nc" id="L2216">        return this;</span>
    }

    @Override
    public String toString() {
<span class="nc" id="L2221">        return &quot;ComponentSelector{ name=&quot; + name + &quot;, uiid=&quot; + uiid + &quot;, tags=&quot; + Arrays.toString(tags) + &quot;, roots=&quot; + roots + &quot;, parent=&quot; + parent + &quot;, results = &quot; + results + &quot;}&quot;;</span>
    }

    /**
     * Adds the given tags to all elements in the result set.
     *
     * @param tags Tags to add.
     * @return Self for chaining.
     */
    public ComponentSelector addTags(String... tags) {
<span class="fc bfc" id="L2231" title="All 2 branches covered.">        for (Component c : this) {</span>

<span class="fc" id="L2233">            String existing = (String) c.getClientProperty(PROPERTY_TAG);</span>
<span class="pc bpc" id="L2234" title="1 of 2 branches missed.">            if (existing == null) {</span>
<span class="fc" id="L2235">                existing = &quot;&quot;;</span>
            }

<span class="fc bfc" id="L2238" title="All 2 branches covered.">            for (String tag : tags) {</span>
<span class="pc bpc" id="L2239" title="1 of 2 branches missed.">                if (existing.indexOf(&quot; &quot; + tag + &quot; &quot;) == -1) {</span>
<span class="fc" id="L2240">                    existing += &quot; &quot; + tag + &quot; &quot;;</span>
                }
            }
<span class="fc" id="L2243">            c.putClientProperty(PROPERTY_TAG, existing);</span>

<span class="fc" id="L2245">        }</span>
<span class="fc" id="L2246">        return this;</span>
    }

    /**
     * Removes the given tags from all elements in the result set.
     *
     * @param tags
     * @return
     */
    public ComponentSelector removeTags(String... tags) {
<span class="nc bnc" id="L2256" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L2257">            String existing = (String) c.getClientProperty(PROPERTY_TAG);</span>
<span class="nc bnc" id="L2258" title="All 2 branches missed.">            if (existing == null) {</span>
<span class="nc" id="L2259">                continue;</span>
            }
<span class="nc" id="L2261">            Set&lt;String&gt; existingSet = new HashSet&lt;String&gt;();</span>
<span class="nc" id="L2262">            String[] existingStrs = Util.split(&quot; &quot;, existing);</span>
<span class="nc bnc" id="L2263" title="All 2 branches missed.">            for (String existingStr : existingStrs) {</span>
<span class="nc" id="L2264">                existingStr = existingStr.trim();</span>
<span class="nc bnc" id="L2265" title="All 2 branches missed.">                if (existingStr.length() &gt; 0) {</span>
<span class="nc" id="L2266">                    existingSet.add(existingStr);</span>
                }
            }
<span class="nc" id="L2269">            Collections.addAll(existingSet, tags);</span>
<span class="nc" id="L2270">            existing = &quot;&quot;;</span>
<span class="nc bnc" id="L2271" title="All 2 branches missed.">            if (existingSet.isEmpty()) {</span>
<span class="nc" id="L2272">                c.putClientProperty(PROPERTY_TAG, null);</span>
<span class="nc" id="L2273">                continue;</span>
            }
<span class="nc bnc" id="L2275" title="All 2 branches missed.">            for (String tag : existingSet) {</span>
<span class="nc" id="L2276">                existing += &quot; &quot; + tag + &quot; &quot;;</span>
<span class="nc" id="L2277">            }</span>
<span class="nc" id="L2278">            c.putClientProperty(PROPERTY_TAG, existing);</span>
<span class="nc" id="L2279">        }</span>
<span class="nc" id="L2280">        return this;</span>
    }

    /**
     * Gets the set of all &quot;parent&quot; components of components in the result set.
     *
     * @return New Component selector with respective parents of the components in the
     * current result set.
     */
    public ComponentSelector getParent() {

<span class="fc" id="L2291">        HashSet&lt;Component&gt; parents = new HashSet&lt;Component&gt;();</span>
<span class="fc bfc" id="L2292" title="All 2 branches covered.">        for (Component c : this) {</span>
<span class="fc" id="L2293">            Component parent = c.getParent();</span>
            //System.out.println(&quot;Parent is &quot;+parent);
<span class="pc bpc" id="L2295" title="1 of 2 branches missed.">            if (parent != null) {</span>
<span class="fc" id="L2296">                parents.add(parent);</span>
            }
<span class="fc" id="L2298">        }</span>
        //System.out.println(resultsImpl() + &quot;Creating parent component selector with &quot;+parents);
<span class="fc" id="L2300">        return new ComponentSelector(parents);</span>

    }

    /**
     * Wrapper for {@link Component#setSameWidth(com.codename1.ui.Component...) }.  Passes all
     * components in the result set as parameters of this method, effectively making them all the
     * same width.
     *
     * @return
     */
    public ComponentSelector setSameWidth() {
<span class="nc" id="L2312">        Component.setSameWidth(toArray(new Component[size()]));</span>
<span class="nc" id="L2313">        return this;</span>
    }

    /**
     * Wrapper for {@link Component#setSameHeight(com.codename1.ui.Component...) }.  Passes all
     * components in the result set as parameters of this method, effectively making them all the
     * same height.
     *
     * @return
     */
    public ComponentSelector setSameHeight() {
<span class="nc" id="L2324">        Component.setSameHeight(toArray(new Component[size()]));</span>
<span class="nc" id="L2325">        return this;</span>
    }

    /**
     * Wrapper for {@link Component#clearClientProperties() }.
     *
     * @return Self for Chaining.
     */
    public ComponentSelector clearClientProperties() {
<span class="nc bnc" id="L2334" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L2335">            c.clearClientProperties();</span>
<span class="nc" id="L2336">        }</span>
<span class="nc" id="L2337">        return this;</span>
    }

    /**
     * Wrapper for {@link Component#putClientProperty(java.lang.String, java.lang.Object) }
     *
     * @param key   Property key
     * @param value Property value
     * @return Self for chaining.
     */
    public ComponentSelector putClientProperty(String key, Object value) {
<span class="nc bnc" id="L2348" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L2349">            c.putClientProperty(key, value);</span>

<span class="nc" id="L2351">        }</span>
<span class="nc" id="L2352">        return this;</span>
    }

    /**
     * Gets a client property from the first component in the set.  Wraps {@link Component#getClientProperty(java.lang.String) }
     *
     * @param key The key of the client property to retrieve.
     * @return The value of the client property.
     */
    public Object getClientProperty(String key) {
<span class="nc" id="L2362">        Iterator&lt;Component&gt; iterator = iterator(); // PMD Fix: AvoidBranchingStatementAsLastInLoop</span>
<span class="nc bnc" id="L2363" title="All 2 branches missed.">        if (iterator.hasNext()) {</span>
<span class="nc" id="L2364">            return iterator.next().getClientProperty(key);</span>
        }
<span class="nc" id="L2366">        return null;</span>
    }

    /**
     * Wrapper for {@link Component#setDirtyRegion(com.codename1.ui.geom.Rectangle) }
     *
     * @param rect Dirty region
     * @return Self for chaining.
     */
    public ComponentSelector setDirtyRegion(Rectangle rect) {
<span class="nc bnc" id="L2376" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L2377">            c.setDirtyRegion(rect);</span>
<span class="nc" id="L2378">        }</span>
<span class="nc" id="L2379">        return this;</span>
    }

    /**
     * Wrapper for {@link Component#setX(int) }
     *
     * @param x
     * @return
     */
    public ComponentSelector setX(int x) {
<span class="nc bnc" id="L2389" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L2390">            c.setX(x);</span>
<span class="nc" id="L2391">        }</span>
<span class="nc" id="L2392">        return this;</span>
    }

    /**
     * Wrapper for {@link Component#setY(int) }
     *
     * @param y
     * @return
     */
    public ComponentSelector setY(int y) {
<span class="nc bnc" id="L2402" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L2403">            c.setY(y);</span>
<span class="nc" id="L2404">        }</span>
<span class="nc" id="L2405">        return this;</span>
    }

    /**
     * Wrapper for {@link Component#setWidth(int) }
     *
     * @param width
     * @return
     */
    public ComponentSelector setWidth(int width) {
<span class="nc bnc" id="L2415" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L2416">            c.setWidth(width);</span>
<span class="nc" id="L2417">        }</span>
<span class="nc" id="L2418">        return this;</span>
    }

    /**
     * Wrapper for {@link Component#setHeight(int) }
     *
     * @param height
     * @return
     */
    public ComponentSelector setHeight(int height) {
<span class="nc bnc" id="L2428" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L2429">            c.setHeight(height);</span>
<span class="nc" id="L2430">        }</span>
<span class="nc" id="L2431">        return this;</span>
    }

    /**
     * Wrapper for {@link Component#setPreferredSize(com.codename1.ui.geom.Dimension) }
     *
     * @param dim
     * @return
     */
    public ComponentSelector setPreferredSize(Dimension dim) {
<span class="nc bnc" id="L2441" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L2442">            c.setPreferredSize(dim);</span>
<span class="nc" id="L2443">        }</span>
<span class="nc" id="L2444">        return this;</span>
    }

    /**
     * Wrapper for {@link Component#setPreferredH(int) }
     *
     * @param h
     * @return
     */
    public ComponentSelector setPreferredH(int h) {
<span class="nc bnc" id="L2454" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L2455">            c.setPreferredH(h);</span>
<span class="nc" id="L2456">        }</span>
<span class="nc" id="L2457">        return this;</span>
    }

    /**
     * Wrapper for {@link Component#setPreferredW(int) }
     *
     * @param w
     * @return
     */
    public ComponentSelector setPreferredW(int w) {
<span class="nc bnc" id="L2467" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L2468">            c.setPreferredW(w);</span>
<span class="nc" id="L2469">        }</span>
<span class="nc" id="L2470">        return this;</span>
    }

    /**
     * Wrapper for {@link Component#setScrollSize}
     *
     * @param size
     * @return
     */
    public ComponentSelector setScrollSize(Dimension size) {
<span class="nc bnc" id="L2480" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L2481">            c.setScrollSize(size);</span>
<span class="nc" id="L2482">        }</span>
<span class="nc" id="L2483">        return this;</span>
    }

    /**
     * Wrapper for {@link Component#setSize(com.codename1.ui.geom.Dimension) }
     *
     * @param size
     * @return
     */
    public ComponentSelector setSize(Dimension size) {
<span class="nc bnc" id="L2493" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L2494">            c.setSize(size);</span>
<span class="nc" id="L2495">        }</span>
<span class="nc" id="L2496">        return this;</span>
    }

    /**
     * Wrapper for {@link Component#setUIID(java.lang.String) }
     *
     * @param uiid
     * @return
     */
    public ComponentSelector setUIID(String uiid) {
<span class="fc bfc" id="L2506" title="All 2 branches covered.">        for (Component c : this) {</span>
<span class="fc" id="L2507">            c.setUIID(uiid);</span>
<span class="fc" id="L2508">        }</span>
<span class="fc" id="L2509">        return this;</span>
    }

    /**
     * Wrapper for {@link Component#remove() }.  This will remove all of the components
     * in the current found set from their respective parents.
     *
     * @return
     */
    public ComponentSelector remove() {
<span class="nc bnc" id="L2519" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L2520">            c.remove();</span>
<span class="nc" id="L2521">        }</span>
<span class="nc" id="L2522">        return this;</span>
    }

    /**
     * Adds a focus listener to all components in found set.  Wraps {@link Component#addFocusListener(com.codename1.ui.events.FocusListener) }
     *
     * @param l
     * @return
     */
    public ComponentSelector addFocusListener(FocusListener l) {
<span class="nc bnc" id="L2532" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L2533">            c.addFocusListener(l);</span>
<span class="nc" id="L2534">        }</span>
<span class="nc" id="L2535">        return this;</span>
    }

    /**
     * Removes focus listener from all components in found set.  Wraps {@link Component#removeFocusListener(com.codename1.ui.events.FocusListener) }
     *
     * @param l
     * @return
     */
    public ComponentSelector removeFocusListener(FocusListener l) {
<span class="nc bnc" id="L2545" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L2546">            c.removeFocusListener(l);</span>
<span class="nc" id="L2547">        }</span>
<span class="nc" id="L2548">        return this;</span>
    }

    /**
     * Adds scroll listener to all components in found set.  Wraps {@link Component#addScrollListener(com.codename1.ui.events.ScrollListener) }
     *
     * @param l
     * @return
     */
    public ComponentSelector addScrollListener(ScrollListener l) {
<span class="nc bnc" id="L2558" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L2559">            c.addScrollListener(l);</span>
<span class="nc" id="L2560">        }</span>
<span class="nc" id="L2561">        return this;</span>
    }

    /**
     * Removes scroll listener from all components in found set. Wraps {@link Component#removeScrollListener(com.codename1.ui.events.ScrollListener) }
     *
     * @param l
     * @return
     */
    public ComponentSelector removeScrollListener(ScrollListener l) {
<span class="nc bnc" id="L2571" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L2572">            c.removeScrollListener(l);</span>
<span class="nc" id="L2573">        }</span>
<span class="nc" id="L2574">        return this;</span>
    }

    /**
     * Sets select command text on all components in found set.  Wraps {@link Component#setSelectCommandText(java.lang.String) }
     *
     * @param text
     * @return
     */
    public ComponentSelector setSelectCommandText(String text) {
<span class="nc bnc" id="L2584" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L2585">            c.setSelectCommandText(text);</span>
<span class="nc" id="L2586">        }</span>
<span class="nc" id="L2587">        return this;</span>
    }

    /**
     * Wraps {@link Component#setLabelForComponent(com.codename1.ui.Label) }
     *
     * @param l
     * @return
     */
    public ComponentSelector setLabelForComponent(Label l) {
<span class="nc bnc" id="L2597" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L2598">            c.setLabelForComponent(l);</span>
<span class="nc" id="L2599">        }</span>
<span class="nc" id="L2600">        return this;</span>
    }

    /**
     * Wraps {@link Component#paintBackgrounds(com.codename1.ui.Graphics) }
     *
     * @param g
     * @return
     */
    public ComponentSelector paintBackgrounds(Graphics g) {
<span class="nc bnc" id="L2610" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L2611">            c.paintBackgrounds(g);</span>
<span class="nc" id="L2612">        }</span>
<span class="nc" id="L2613">        return this;</span>
    }

    /**
     * Wraps {@link Component#paintComponent(com.codename1.ui.Graphics) }
     *
     * @param g
     * @return
     */
    public ComponentSelector paintComponent(Graphics g) {
<span class="nc bnc" id="L2623" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L2624">            c.paintComponent(g);</span>
<span class="nc" id="L2625">        }</span>
<span class="nc" id="L2626">        return this;</span>
    }

    /**
     * Wraps {@link Component#paint(com.codename1.ui.Graphics) }
     *
     * @param g
     * @return
     */
    public ComponentSelector paint(Graphics g) {
<span class="nc bnc" id="L2636" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L2637">            c.paint(g);</span>
<span class="nc" id="L2638">        }</span>
<span class="nc" id="L2639">        return this;</span>
    }

    /**
     * Returns true if any of the components in the found set contains the provided coordinate.
     * Wraps {@link Component#contains(int, int) }
     *
     * @param x
     * @param y
     * @return
     */
    public boolean contains(int x, int y) {
<span class="nc bnc" id="L2651" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L2652" title="All 2 branches missed.">            if (c.contains(x, y)) {</span>
<span class="nc" id="L2653">                return true;</span>
            }
<span class="nc" id="L2655">        }</span>
<span class="nc" id="L2656">        return false;</span>
    }

    /**
     * Sets all components in the found set focusability.
     * Wraps {@link Component#setFocusable(boolean) }
     *
     * @param focus
     * @return
     */
    public ComponentSelector setFocusable(boolean focus) {
<span class="nc bnc" id="L2667" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L2668">            c.setFocusable(focus);</span>
<span class="nc" id="L2669">        }</span>
<span class="nc" id="L2670">        return this;</span>
    }

    /**
     * Wraps {@link Component#repaint() }
     *
     * @return
     */
    public ComponentSelector repaint() {
<span class="nc bnc" id="L2679" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L2680">            c.repaint();</span>
<span class="nc" id="L2681">        }</span>
<span class="nc" id="L2682">        return this;</span>
    }

    /**
     * Wraps {@link Component#repaint(int, int, int, int) }
     *
     * @param x
     * @param y
     * @param w
     * @param h
     * @return
     */
    public ComponentSelector repaint(int x, int y, int w, int h) {
<span class="nc bnc" id="L2695" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L2696">            c.repaint(x, y, w, h);</span>
<span class="nc" id="L2697">        }</span>
<span class="nc" id="L2698">        return this;</span>
    }

    /**
     * Wraps {@link Component#setScrollAnimationSpeed(int) }
     *
     * @param speed
     * @return
     */
    public ComponentSelector setScrollAnimationSpeed(int speed) {
<span class="nc bnc" id="L2708" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L2709">            c.setScrollAnimationSpeed(speed);</span>
<span class="nc" id="L2710">        }</span>
<span class="nc" id="L2711">        return this;</span>
    }

    /**
     * Wraps {@link Component#setSmoothScrolling(boolean) }
     *
     * @param smooth
     * @return
     */
    public ComponentSelector setSmoothScrolling(boolean smooth) {
<span class="nc bnc" id="L2721" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L2722">            c.setSmoothScrolling(smooth);</span>
<span class="nc" id="L2723">        }</span>
<span class="nc" id="L2724">        return this;</span>
    }

    /**
     * Adds a drop listener to all components in found set.  Wraps {@link Component#addDropListener(com.codename1.ui.events.ActionListener) }
     *
     * @param l
     * @return
     */
    public ComponentSelector addDropListener(ActionListener l) {
<span class="nc bnc" id="L2734" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L2735">            c.addDropListener(l);</span>
<span class="nc" id="L2736">        }</span>
<span class="nc" id="L2737">        return this;</span>
    }

    /**
     * Removes a drop listener from all components in found set.
     * Wraps {@link Component#removeDropListener(com.codename1.ui.events.ActionListener) }
     *
     * @param l
     * @return
     */
    public ComponentSelector removeDropListener(ActionListener l) {
<span class="nc bnc" id="L2748" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L2749">            c.removeDropListener(l);</span>
<span class="nc" id="L2750">        }</span>
<span class="nc" id="L2751">        return this;</span>
    }

    /**
     * Adds drag over listener to all components in found set.
     * Wraps {@link Component#addDragOverListener(com.codename1.ui.events.ActionListener) }
     *
     * @param l
     * @return
     */
    public ComponentSelector addDragOverListener(ActionListener l) {
<span class="nc bnc" id="L2762" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L2763">            c.addDragOverListener(l);</span>
<span class="nc" id="L2764">        }</span>
<span class="nc" id="L2765">        return this;</span>
    }

    /**
     * Removes drag over listener from all components in found set.
     * Wraps {@link Component#removeDragOverListener(com.codename1.ui.events.ActionListener) }
     *
     * @param l
     * @return
     */
    public ComponentSelector removeDragOverListener(ActionListener l) {
<span class="nc bnc" id="L2776" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L2777">            c.removeDragOverListener(l);</span>
<span class="nc" id="L2778">        }</span>
<span class="nc" id="L2779">        return this;</span>
    }

    /**
     * Adds pointer pressed listener to all components in found set.
     * Wraps {@link Component#addPointerPressedListener(com.codename1.ui.events.ActionListener) }
     *
     * @param l
     * @return
     */
    public ComponentSelector addPointerPressedListener(ActionListener l) {
<span class="nc bnc" id="L2790" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L2791">            c.addPointerPressedListener(l);</span>
<span class="nc" id="L2792">        }</span>
<span class="nc" id="L2793">        return this;</span>
    }

    /**
     * Adds long pointer pressed listener to all components in found set.
     * Wraps {@link Component#addLongPressListener(com.codename1.ui.events.ActionListener) }
     *
     * @param l
     * @return
     */
    public ComponentSelector addLongPressListener(ActionListener l) {
<span class="nc bnc" id="L2804" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L2805">            c.addLongPressListener(l);</span>
<span class="nc" id="L2806">        }</span>
<span class="nc" id="L2807">        return this;</span>
    }

    /**
     * Removes pointer pressed listener from all components in found set.
     * Wraps {@link Component#removePointerPressedListener(com.codename1.ui.events.ActionListener) }
     *
     * @param l
     * @return
     */
    public ComponentSelector removePointerPressedListener(ActionListener l) {
<span class="nc bnc" id="L2818" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L2819">            c.removePointerPressedListener(l);</span>
<span class="nc" id="L2820">        }</span>
<span class="nc" id="L2821">        return this;</span>
    }

    /**
     * Removes long pointer pressed listener from all components in found set.
     * Wraps {@link Component#removeLongPressListener(com.codename1.ui.events.ActionListener) }
     *
     * @param l
     * @return
     */
    public ComponentSelector removeLongPressListener(ActionListener l) {
<span class="nc bnc" id="L2832" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L2833">            c.removeLongPressListener(l);</span>
<span class="nc" id="L2834">        }</span>
<span class="nc" id="L2835">        return this;</span>
    }

    /**
     * Adds pointer released listener to all components in found set.
     * Wraps {@link Component#addPointerReleasedListener(com.codename1.ui.events.ActionListener) }
     *
     * @param l
     * @return
     */
    public ComponentSelector addPointerReleasedListener(ActionListener l) {
<span class="nc bnc" id="L2846" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L2847">            c.addPointerReleasedListener(l);</span>
<span class="nc" id="L2848">        }</span>
<span class="nc" id="L2849">        return this;</span>
    }

    /**
     * Removes pointer released listener from all components in found set.
     * Wraps {@link Component#removePointerReleasedListener(com.codename1.ui.events.ActionListener) }
     *
     * @param l
     * @return
     */
    public ComponentSelector removePointerReleasedListener(ActionListener l) {
<span class="nc bnc" id="L2860" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L2861">            c.removePointerReleasedListener(l);</span>
<span class="nc" id="L2862">        }</span>
<span class="nc" id="L2863">        return this;</span>
    }

    /**
     * Adds pointer dragged listener to all components in found set.
     * Wraps {@link Component#addPointerDraggedListener(com.codename1.ui.events.ActionListener) }
     *
     * @param l
     * @return
     */
    public ComponentSelector addPointerDraggedListener(ActionListener l) {
<span class="nc bnc" id="L2874" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L2875">            c.addPointerDraggedListener(l);</span>
<span class="nc" id="L2876">        }</span>
<span class="nc" id="L2877">        return this;</span>
    }

    /**
     * REmoves pointer dragged listener from all components in found set.
     * Wraps {@link Component#removePointerDraggedListener(com.codename1.ui.events.ActionListener) }
     *
     * @param l
     * @return
     */
    public ComponentSelector removePointerDraggedListener(ActionListener l) {
<span class="nc bnc" id="L2888" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L2889">            c.removePointerDraggedListener(l);</span>
<span class="nc" id="L2890">        }</span>
<span class="nc" id="L2891">        return this;</span>
    }

    /**
     * Wraps {@link Component#requestFocus()}
     *
     * @return
     */
    public ComponentSelector requestFocus() {
<span class="nc" id="L2900">        Iterator&lt;Component&gt; iterator = iterator(); // PMD Fix: AvoidBranchingStatementAsLastInLoop</span>
<span class="nc bnc" id="L2901" title="All 2 branches missed.">        if (iterator.hasNext()) {</span>
<span class="nc" id="L2902">            iterator.next().requestFocus();</span>
        }
<span class="nc" id="L2904">        return this;</span>
    }

    /**
     * Wraps {@link Component#refreshTheme()}
     *
     * @return
     */
    public ComponentSelector refreshTheme() {
<span class="nc bnc" id="L2913" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L2914">            c.refreshTheme();</span>
<span class="nc" id="L2915">        }</span>
<span class="nc" id="L2916">        return this;</span>
    }

    /**
     * Wraps {@link Component#refreshTheme(boolean) }
     *
     * @param merge
     * @return
     */
    public ComponentSelector refreshTheme(boolean merge) {
<span class="nc bnc" id="L2926" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L2927">            c.refreshTheme(merge);</span>
<span class="nc" id="L2928">        }</span>
<span class="nc" id="L2929">        return this;</span>
    }

    /**
     * Wraps {@link Component#setCellRenderer(boolean) }
     *
     * @param cell
     * @return
     */
    public ComponentSelector setCellRenderer(boolean cell) {
<span class="nc bnc" id="L2939" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L2940">            c.setCellRenderer(cell);</span>
<span class="nc" id="L2941">        }</span>
<span class="nc" id="L2942">        return this;</span>
    }

    /**
     * Wraps {@link Component#setScrollVisible(boolean) }
     *
     * @param vis
     * @return
     */
    public ComponentSelector setScrollVisible(boolean vis) {
<span class="nc bnc" id="L2952" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L2953">            c.setScrollVisible(vis);</span>
<span class="nc" id="L2954">        }</span>
<span class="nc" id="L2955">        return this;</span>
    }

    /**
     * Wraps {@link Component#setEnabled(boolean) }
     *
     * @param enabled
     * @return
     */
    public ComponentSelector setEnabled(boolean enabled) {
<span class="fc bfc" id="L2965" title="All 2 branches covered.">        for (Component c : this) {</span>
<span class="fc" id="L2966">            c.setEnabled(enabled);</span>
<span class="fc" id="L2967">        }</span>
<span class="fc" id="L2968">        return this;</span>
    }

    /**
     * Wraps {@link Component#setName(java.lang.String) }
     *
     * @param name
     * @return
     */
    public ComponentSelector setName(String name) {
<span class="nc bnc" id="L2978" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L2979">            c.setName(name);</span>
<span class="nc" id="L2980">        }</span>
<span class="nc" id="L2981">        return this;</span>
    }

    /**
     * Wraps {@link Component#setRTL(boolean) }
     *
     * @param rtl
     * @return
     */
    public ComponentSelector setRTL(boolean rtl) {
<span class="fc bfc" id="L2991" title="All 2 branches covered.">        for (Component c : this) {</span>
<span class="fc" id="L2992">            c.setRTL(rtl);</span>
<span class="fc" id="L2993">        }</span>
<span class="fc" id="L2994">        return this;</span>
    }

    /**
     * Wraps {@link Component#setTactileTouch(boolean) }
     *
     * @param t
     * @return
     */
    public ComponentSelector setTactileTouch(boolean t) {
<span class="nc bnc" id="L3004" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L3005">            c.setTactileTouch(t);</span>
<span class="nc" id="L3006">        }</span>
<span class="nc" id="L3007">        return this;</span>
    }

    /**
     * Wraps {@link Component#setPropertyValue(java.lang.String, java.lang.Object) }
     *
     * @param key
     * @param value
     * @return
     */
    public ComponentSelector setPropertyValue(String key, Object value) {
<span class="nc bnc" id="L3018" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L3019">            c.setPropertyValue(key, value);</span>
<span class="nc" id="L3020">        }</span>
<span class="nc" id="L3021">        return this;</span>
    }

    /**
     * Wraps {@link Component#paintLockRelease() }
     *
     * @return
     */
    public ComponentSelector paintLockRelease() {
<span class="nc bnc" id="L3030" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L3031">            c.paintLockRelease();</span>
<span class="nc" id="L3032">        }</span>
<span class="nc" id="L3033">        return this;</span>
    }

    /**
     * Wraps {@link Component#setSnapToGrid(boolean) }
     *
     * @param s
     * @return
     */
    public ComponentSelector setSnapToGrid(boolean s) {
<span class="nc bnc" id="L3043" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L3044">            c.setSnapToGrid(s);</span>
<span class="nc" id="L3045">        }</span>
<span class="nc" id="L3046">        return this;</span>
    }

    public boolean isIgnorePointerEvents() {
<span class="nc" id="L3050">        Iterator&lt;Component&gt; iterator = iterator(); // PMD Fix: AvoidBranchingStatementAsLastInLoop</span>
<span class="nc bnc" id="L3051" title="All 2 branches missed.">        if (iterator.hasNext()) {</span>
<span class="nc" id="L3052">            return iterator.next().isIgnorePointerEvents();</span>
        }
<span class="nc" id="L3054">        return false;</span>
    }

    public ComponentSelector setIgnorePointerEvents(boolean ignore) {
<span class="fc bfc" id="L3058" title="All 2 branches covered.">        for (Component c : this) {</span>
<span class="fc" id="L3059">            c.setIgnorePointerEvents(ignore);</span>
<span class="fc" id="L3060">        }</span>
<span class="fc" id="L3061">        return this;</span>
    }

    /**
     * Wraps {@link Component#setFlatten(boolean)}
     *
     * @param f
     * @return
     */
    public ComponentSelector setFlatten(boolean f) {
<span class="nc bnc" id="L3071" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L3072">            c.setFlatten(f);</span>
<span class="nc" id="L3073">        }</span>
<span class="nc" id="L3074">        return this;</span>
    }

    /**
     * Wraps {@link Component#setTensileLength(int)}
     *
     * @param len
     * @return
     */
    public ComponentSelector setTensileLength(int len) {
<span class="nc bnc" id="L3084" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L3085">            c.setTensileLength(len);</span>
<span class="nc" id="L3086">        }</span>
<span class="nc" id="L3087">        return this;</span>
    }

    /**
     * Wraps {@link Component#setGrabsPointerEvents(boolean) }
     *
     * @param g
     * @return
     */
    public ComponentSelector setGrabsPointerEvents(boolean g) {
<span class="nc bnc" id="L3097" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L3098">            c.setGrabsPointerEvents(g);</span>
<span class="nc" id="L3099">        }</span>
<span class="nc" id="L3100">        return this;</span>
    }

    /**
     * Wraps {@link Component#setScrollOpacityChangeSpeed(int) }
     *
     * @param scrollOpacityChangeSpeed
     * @return
     */
    public ComponentSelector setScrollOpacityChangeSpeed(int scrollOpacityChangeSpeed) {
<span class="nc bnc" id="L3110" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L3111">            c.setScrollOpacityChangeSpeed(scrollOpacityChangeSpeed);</span>
<span class="nc" id="L3112">        }</span>
<span class="nc" id="L3113">        return this;</span>
    }

    /**
     * Wraps {@link Component#growShrink(int) }
     *
     * @param duration
     * @return
     */
    public ComponentSelector growShrink(int duration) {
<span class="nc bnc" id="L3123" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L3124">            c.growShrink(duration);</span>
<span class="nc" id="L3125">        }</span>
<span class="nc" id="L3126">        return this;</span>
    }

    /**
     * Wraps {@link Component#setDraggable(boolean) }
     *
     * @param draggable
     * @return
     */
    public ComponentSelector setDraggable(boolean draggable) {
<span class="fc bfc" id="L3136" title="All 2 branches covered.">        for (Component c : this) {</span>
<span class="fc" id="L3137">            c.setDraggable(draggable);</span>
<span class="fc" id="L3138">        }</span>
<span class="fc" id="L3139">        return this;</span>
    }

    /**
     * Wraps {@link Component#setDropTarget(boolean) }
     *
     * @param target
     * @return
     */
    public ComponentSelector setDropTarget(boolean target) {
<span class="nc bnc" id="L3149" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L3150">            c.setDropTarget(target);</span>
<span class="nc" id="L3151">        }</span>
<span class="nc" id="L3152">        return this;</span>
    }

    /**
     * Wraps {@link Component#setHideInPortrait(boolean) }
     *
     * @param hide
     * @return
     */
    public ComponentSelector setHideInPortait(boolean hide) {
<span class="nc bnc" id="L3162" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L3163">            c.setHideInPortrait(hide);</span>
<span class="nc" id="L3164">        }</span>
<span class="nc" id="L3165">        return this;</span>
    }

    /**
     * Wraps {@link Component#setHidden(boolean, boolean) }
     *
     * @param b
     * @param changeMargin
     * @return
     */
    public ComponentSelector setHidden(boolean b, boolean changeMargin) {
<span class="nc bnc" id="L3176" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L3177">            c.setHidden(b, changeMargin);</span>
<span class="nc" id="L3178">        }</span>
<span class="nc" id="L3179">        return this;</span>
    }

    /**
     * Wraps {@link Component#setComponentState(java.lang.Object) }
     *
     * @param state
     * @return
     */
    public ComponentSelector setComponentState(Object state) {
<span class="nc bnc" id="L3189" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L3190">            c.setComponentState(state);</span>
<span class="nc" id="L3191">        }</span>
<span class="nc" id="L3192">        return this;</span>
    }

    /**
     * Wraps {@link Container#setLeadComponent(com.codename1.ui.Component) }
     *
     * @param lead
     * @return
     */
    public ComponentSelector setLeadComponent(Component lead) {
<span class="nc bnc" id="L3202" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L3203" title="All 2 branches missed.">            if (c instanceof Container) {</span>
<span class="nc" id="L3204">                Container cnt = (Container) c;</span>
<span class="nc" id="L3205">                cnt.setLeadComponent(lead);</span>
            }
<span class="nc" id="L3207">        }</span>
<span class="nc" id="L3208">        return this;</span>
    }

    /**
     * Wraps {@link Container#setLayout(com.codename1.ui.layouts.Layout)  }
     *
     * @param layout
     * @return
     */
    public ComponentSelector setLayout(Layout layout) {
<span class="nc bnc" id="L3218" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L3219" title="All 2 branches missed.">            if (c instanceof Container) {</span>
<span class="nc" id="L3220">                Container cnt = (Container) c;</span>
<span class="nc" id="L3221">                cnt.setLayout(layout);</span>
            }
<span class="nc" id="L3223">        }</span>
<span class="nc" id="L3224">        return this;</span>
    }

    /**
     * Wraps {@link Container#invalidate() }
     *
     * @return
     */
    public ComponentSelector invalidate() {
<span class="nc bnc" id="L3233" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L3234" title="All 2 branches missed.">            if (c instanceof Container) {</span>
<span class="nc" id="L3235">                Container cnt = (Container) c;</span>
<span class="nc" id="L3236">                cnt.invalidate();</span>
            }

<span class="nc" id="L3239">        }</span>
<span class="nc" id="L3240">        return this;</span>
    }

    /**
     * Wraps {@link Container#setShouldCalcPreferredSize(boolean) }
     *
     * @param shouldCalcPreferredSize
     * @return
     */
    public ComponentSelector setShouldCalcPreferredSize(boolean shouldCalcPreferredSize) {
<span class="nc bnc" id="L3250" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L3251" title="All 2 branches missed.">            if (c instanceof Container) {</span>
<span class="nc" id="L3252">                Container cnt = (Container) c;</span>
<span class="nc" id="L3253">                cnt.setShouldCalcPreferredSize(shouldCalcPreferredSize);</span>
            }

<span class="nc" id="L3256">        }</span>
<span class="nc" id="L3257">        return this;</span>
    }

    /**
     * Wraps {@link Container#applyRTL(boolean)  }
     *
     * @param rtl
     * @return
     */
    public ComponentSelector applyRTL(boolean rtl) {
<span class="nc bnc" id="L3267" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L3268" title="All 2 branches missed.">            if (c instanceof Container) {</span>
<span class="nc" id="L3269">                Container cnt = (Container) c;</span>
<span class="nc" id="L3270">                cnt.applyRTL(rtl);</span>
            }
<span class="nc" id="L3272">        }</span>
<span class="nc" id="L3273">        return this;</span>
    }

    /**
     * This removes all children from all containers in found set.  Not to be confused with {@link #clear()}, which
     * removes components from the found set, but not from their respective parents.
     * Wraps {@link Container#removeAll() }
     *
     * @return
     */
    public ComponentSelector removeAll() {
<span class="nc bnc" id="L3284" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L3285" title="All 2 branches missed.">            if (c instanceof Container) {</span>
<span class="nc" id="L3286">                ((Container) c).removeAll();</span>
            }
<span class="nc" id="L3288">        }</span>
<span class="nc" id="L3289">        return this;</span>
    }

    /**
     * Wraps {@link Container#revalidate()  }
     *
     * @return
     */
    public ComponentSelector revalidate() {
<span class="fc bfc" id="L3298" title="All 2 branches covered.">        for (Component c : this) {</span>
<span class="pc bpc" id="L3299" title="1 of 2 branches missed.">            if (c instanceof Container) {</span>
<span class="nc" id="L3300">                ((Container) c).revalidate();</span>
            }
<span class="fc" id="L3302">        }</span>
<span class="fc" id="L3303">        return this;</span>
    }

    /**
     * Wraps {@link Container#forceRevalidate()  }
     *
     * @return
     */
    public ComponentSelector forceRevalidate() {

<span class="nc bnc" id="L3313" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L3314" title="All 2 branches missed.">            if (c instanceof Container) {</span>
<span class="nc" id="L3315">                ((Container) c).forceRevalidate();</span>
            }
<span class="nc" id="L3317">        }</span>
<span class="nc" id="L3318">        return this;</span>
    }

    /**
     * Wraps {@link Container#layoutContainer()  }
     *
     * @return
     */
    public ComponentSelector layoutContainer() {

<span class="nc bnc" id="L3328" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L3329" title="All 2 branches missed.">            if (c instanceof Container) {</span>
<span class="nc" id="L3330">                ((Container) c).layoutContainer();</span>
            }
<span class="nc" id="L3332">        }</span>
<span class="nc" id="L3333">        return this;</span>
    }

    /**
     * This returns a new ComponentSelector which includes a set of all results
     * of calling {@link Container#getComponentAt(int) } on containers in this
     * found set.  This effectively allows us to get all of the ith elements of all
     * matched components.
     *
     * @param index
     * @return New ComponentSelector with {@code index}th child of each container in the current found set.
     */
    public ComponentSelector getComponentAt(int index) {
<span class="nc" id="L3346">        HashSet&lt;Component&gt; out = new HashSet&lt;Component&gt;();</span>
<span class="nc bnc" id="L3347" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L3348" title="All 2 branches missed.">            if (c instanceof Container) {</span>
<span class="nc" id="L3349">                Container cnt = (Container) c;</span>
<span class="nc bnc" id="L3350" title="All 2 branches missed.">                if (cnt.getComponentCount() &gt; index) {</span>
<span class="nc" id="L3351">                    out.add(cnt.getComponentAt(index));</span>
                }
            }
<span class="nc" id="L3354">        }</span>
<span class="nc" id="L3355">        return new ComponentSelector(out);</span>
    }

    /**
     * Returns true if any of the containers in the current found set contains
     * the provided component in its subtree.
     * Wraps {@link Container#contains(com.codename1.ui.Component) }
     *
     * @param cmp
     * @return
     */
    public boolean containsInSubtree(Component cmp) {
<span class="nc bnc" id="L3367" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L3368" title="All 2 branches missed.">            if (c instanceof Container) {</span>
<span class="nc bnc" id="L3369" title="All 2 branches missed.">                if (((Container) c).contains(cmp)) {</span>
<span class="nc" id="L3370">                    return true;</span>
                }
            }

<span class="nc" id="L3374">        }</span>
<span class="nc" id="L3375">        return false;</span>
    }

    /**
     * Wraps {@link Container#scrollComponentToVisible(com.codename1.ui.Component) }
     *
     * @param cmp
     * @return
     */
    public ComponentSelector scrollComponentToVisible(Component cmp) {
<span class="nc bnc" id="L3385" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L3386" title="All 2 branches missed.">            if (c instanceof Container) {</span>
<span class="nc" id="L3387">                ((Container) c).scrollComponentToVisible(cmp);</span>
            }
<span class="nc" id="L3389">        }</span>
<span class="nc" id="L3390">        return this;</span>
    }

    /**
     * Returns new ComponentSelector with the set of all components returned from calling
     * {@link Container#getComponentAt(int, int) } in the current found set.
     *
     * @param x
     * @param y
     * @return New ComponentSelector with components at the given coordinates.
     */
    public ComponentSelector getComponentAt(int x, int y) {
<span class="nc" id="L3402">        HashSet&lt;Component&gt; out = new HashSet&lt;Component&gt;();</span>
<span class="nc bnc" id="L3403" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L3404" title="All 2 branches missed.">            if (c instanceof Container) {</span>
<span class="nc" id="L3405">                Component match = ((Container) c).getComponentAt(x, y);</span>
<span class="nc bnc" id="L3406" title="All 2 branches missed.">                if (match != null) {</span>
<span class="nc" id="L3407">                    out.add(match);</span>
                }
            }
<span class="nc" id="L3410">        }</span>
<span class="nc" id="L3411">        return new ComponentSelector(out);</span>
    }

    /**
     * Wraps {@link Container#setScrollableX(boolean)  }
     *
     * @param b
     * @return
     */
    public ComponentSelector setScrollableX(boolean b) {
<span class="nc bnc" id="L3421" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L3422" title="All 2 branches missed.">            if (c instanceof Container) {</span>
<span class="nc" id="L3423">                ((Container) c).setScrollableX(b);</span>
            }
<span class="nc" id="L3425">        }</span>
<span class="nc" id="L3426">        return this;</span>
    }

    /**
     * Wraps {@link Container#setScrollableY(boolean)  }
     *
     * @param b
     * @return
     */
    public ComponentSelector setScrollableY(boolean b) {
<span class="nc bnc" id="L3436" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L3437" title="All 2 branches missed.">            if (c instanceof Container) {</span>
<span class="nc" id="L3438">                ((Container) c).setScrollableY(b);</span>
            }
<span class="nc" id="L3440">        }</span>
<span class="nc" id="L3441">        return this;</span>
    }

    /**
     * Wraps {@link Container#setScrollIncrement(int)  }
     *
     * @param b
     * @return
     */
    public ComponentSelector setScrollIncrement(int b) {
<span class="nc bnc" id="L3451" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L3452" title="All 2 branches missed.">            if (c instanceof Container) {</span>
<span class="nc" id="L3453">                ((Container) c).setScrollIncrement(b);</span>
            }
<span class="nc" id="L3455">        }</span>
<span class="nc" id="L3456">        return this;</span>
    }

    /**
     * Creates new ComponentSelector with the set of first focusable elements of
     * each of the containers in the current result set.
     *
     * @return New component selector with first focusable element of each container in
     * current found set.
     * @see Container#findFirstFocusable()
     */
    public ComponentSelector findFirstFocusable() {
<span class="nc" id="L3468">        HashSet&lt;Component&gt; out = new HashSet&lt;Component&gt;();</span>
<span class="nc bnc" id="L3469" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L3470" title="All 2 branches missed.">            if (c instanceof Container) {</span>
<span class="nc" id="L3471">                Component match = ((Container) c).findFirstFocusable();</span>
<span class="nc bnc" id="L3472" title="All 2 branches missed.">                if (match != null) {</span>
<span class="nc" id="L3473">                    out.add(match);</span>
                }
            }
<span class="nc" id="L3476">        }</span>
<span class="nc" id="L3477">        return new ComponentSelector(out);</span>
    }

    /**
     * Wraps {@link Container#animateHierarchyAndWait(int) }.
     *
     * @param duration
     * @return
     */
    public ComponentSelector animateHierarchyAndWait(int duration) {
<span class="nc" id="L3487">        ArrayList&lt;ComponentAnimation&gt; animations = new ArrayList&lt;ComponentAnimation&gt;();</span>
<span class="nc bnc" id="L3488" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L3489" title="All 2 branches missed.">            if (c instanceof Container) {</span>
<span class="nc" id="L3490">                animations.add(((Container) c).createAnimateHierarchy(duration));</span>
            }
<span class="nc" id="L3492">        }</span>
<span class="nc" id="L3493">        AnimationManager mgr = getAnimationManager();</span>
<span class="nc bnc" id="L3494" title="All 4 branches missed.">        if (animations.size() &gt; 0 &amp;&amp; mgr != null) {</span>
<span class="nc" id="L3495">            mgr.addAnimationAndBlock(ComponentAnimation.compoundAnimation(animations.toArray(new ComponentAnimation[animations.size()])));</span>
        }
<span class="nc" id="L3497">        return this;</span>
    }

    /**
     * Animates the hierarchy of containers in this set.  Wraps {@link Container#animateHierarchy(int) }
     *
     * @param duration
     * @return
     */
    public ComponentSelector animateHierarchy(int duration) {
<span class="nc" id="L3507">        return animateHierarchy(duration, null);</span>
    }

    /**
     * Wraps {@link Container#animateHierarchy(int) }.
     *
     * @param duration
     * @param callback
     * @return
     */
    public ComponentSelector animateHierarchy(int duration, final SuccessCallback&lt;ComponentSelector&gt; callback) {
<span class="nc" id="L3518">        ArrayList&lt;ComponentAnimation&gt; animations = new ArrayList&lt;ComponentAnimation&gt;();</span>
<span class="nc bnc" id="L3519" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L3520" title="All 2 branches missed.">            if (c instanceof Container) {</span>
<span class="nc" id="L3521">                animations.add(((Container) c).createAnimateHierarchy(duration));</span>
            }
<span class="nc" id="L3523">        }</span>
<span class="nc" id="L3524">        AnimationManager mgr = getAnimationManager();</span>
<span class="nc bnc" id="L3525" title="All 4 branches missed.">        if (animations.size() &gt; 0 &amp;&amp; mgr != null) {</span>
<span class="nc" id="L3526">            mgr.addAnimation(ComponentAnimation.compoundAnimation(animations.toArray(new ComponentAnimation[animations.size()])), new Runnable() {</span>
                public void run() {
<span class="nc bnc" id="L3528" title="All 2 branches missed.">                    if (callback != null) {</span>
<span class="nc" id="L3529">                        callback.onSucess(ComponentSelector.this);</span>
                    }
<span class="nc" id="L3531">                }</span>
            });
        }
<span class="nc" id="L3534">        return this;</span>
    }

    /**
     * Wraps {@link Container#animateHierarchyFadeAndWait(int, int) }.
     *
     * @param duration
     * @param startingOpacity
     * @return
     */
    public ComponentSelector animateHierarchyFadeAndWait(int duration, int startingOpacity) {
<span class="nc" id="L3545">        ArrayList&lt;ComponentAnimation&gt; animations = new ArrayList&lt;ComponentAnimation&gt;();</span>
<span class="nc bnc" id="L3546" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L3547" title="All 2 branches missed.">            if (c instanceof Container) {</span>
<span class="nc" id="L3548">                animations.add(((Container) c).createAnimateHierarchyFade(duration, startingOpacity));</span>
            }
<span class="nc" id="L3550">        }</span>
<span class="nc" id="L3551">        AnimationManager mgr = getAnimationManager();</span>
<span class="nc bnc" id="L3552" title="All 4 branches missed.">        if (animations.size() &gt; 0 &amp;&amp; mgr != null) {</span>
<span class="nc" id="L3553">            mgr.addAnimationAndBlock(ComponentAnimation.compoundAnimation(animations.toArray(new ComponentAnimation[animations.size()])));</span>
        }
<span class="nc" id="L3555">        return this;</span>
    }

    /**
     * Wraps {@link Container#animateHierarchyAndWait(int) }
     *
     * @param duration        The duration of the animation.
     * @param startingOpacity The starting opacity.
     * @return Self for chaining.
     */
    public ComponentSelector animateHierarchyFade(int duration, int startingOpacity) {
<span class="nc" id="L3566">        return animateHierarchyFade(duration, startingOpacity, null);</span>
    }

    /**
     * Wraps {@link Container#animateHierarchyFade(int, int) }.
     *
     * @param duration
     * @param startingOpacity
     * @param callback
     * @return
     */
    public ComponentSelector animateHierarchyFade(int duration, int startingOpacity, final SuccessCallback&lt;ComponentSelector&gt; callback) {
<span class="nc" id="L3578">        ArrayList&lt;ComponentAnimation&gt; animations = new ArrayList&lt;ComponentAnimation&gt;();</span>
<span class="nc bnc" id="L3579" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L3580" title="All 2 branches missed.">            if (c instanceof Container) {</span>
<span class="nc" id="L3581">                animations.add(((Container) c).createAnimateHierarchyFade(duration, startingOpacity));</span>
            }
<span class="nc" id="L3583">        }</span>
<span class="nc" id="L3584">        AnimationManager mgr = getAnimationManager();</span>
<span class="nc bnc" id="L3585" title="All 4 branches missed.">        if (animations.size() &gt; 0 &amp;&amp; mgr != null) {</span>
<span class="nc" id="L3586">            mgr.addAnimation(ComponentAnimation.compoundAnimation(animations.toArray(new ComponentAnimation[animations.size()])), new Runnable() {</span>
                public void run() {
<span class="nc bnc" id="L3588" title="All 2 branches missed.">                    if (callback != null) {</span>
<span class="nc" id="L3589">                        callback.onSucess(ComponentSelector.this);</span>
                    }
<span class="nc" id="L3591">                }</span>
            });
        }
<span class="nc" id="L3594">        return this;</span>
    }

    /**
     * Wraps {@link Container#animateLayoutFadeAndWait(int, int) }.
     *
     * @param duration
     * @param startingOpacity
     * @return
     */
    public ComponentSelector animateLayoutFadeAndWait(int duration, int startingOpacity) {
<span class="nc" id="L3605">        ArrayList&lt;ComponentAnimation&gt; animations = new ArrayList&lt;ComponentAnimation&gt;();</span>
<span class="nc bnc" id="L3606" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L3607" title="All 2 branches missed.">            if (c instanceof Container) {</span>
<span class="nc" id="L3608">                animations.add(((Container) c).createAnimateLayoutFade(duration, startingOpacity));</span>
            }
<span class="nc" id="L3610">        }</span>
<span class="nc" id="L3611">        AnimationManager mgr = getAnimationManager();</span>
<span class="nc bnc" id="L3612" title="All 4 branches missed.">        if (animations.size() &gt; 0 &amp;&amp; mgr != null) {</span>
<span class="nc" id="L3613">            mgr.addAnimationAndBlock(ComponentAnimation.compoundAnimation(animations.toArray(new ComponentAnimation[animations.size()])));</span>
        }
<span class="nc" id="L3615">        return this;</span>
    }

    /**
     * Animates layout with fade on all containers in this set.  Wraps {@link Container#animateLayoutFade(int, int) }.
     *
     * @param duration
     * @param startingOpacity
     * @return Self for chaining.
     */
    public ComponentSelector animateLayoutFade(int duration, int startingOpacity) {
<span class="nc" id="L3626">        return animateLayoutFade(duration, startingOpacity, null);</span>
    }

    /**
     * Wraps {@link Container#animateLayoutFade(int, int) }.
     *
     * @param duration
     * @param startingOpacity
     * @param callback
     * @return
     */
    public ComponentSelector animateLayoutFade(int duration, int startingOpacity, final SuccessCallback&lt;ComponentSelector&gt; callback) {
<span class="nc" id="L3638">        ArrayList&lt;ComponentAnimation&gt; animations = new ArrayList&lt;ComponentAnimation&gt;();</span>
<span class="nc bnc" id="L3639" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L3640" title="All 2 branches missed.">            if (c instanceof Container) {</span>
<span class="nc" id="L3641">                animations.add(((Container) c).createAnimateLayoutFade(duration, startingOpacity));</span>
            }
<span class="nc" id="L3643">        }</span>
<span class="nc" id="L3644">        AnimationManager mgr = getAnimationManager();</span>
<span class="nc bnc" id="L3645" title="All 4 branches missed.">        if (animations.size() &gt; 0 &amp;&amp; mgr != null) {</span>
<span class="nc" id="L3646">            mgr.addAnimation(ComponentAnimation.compoundAnimation(animations.toArray(new ComponentAnimation[animations.size()])), new Runnable() {</span>

                public void run() {
<span class="nc bnc" id="L3649" title="All 2 branches missed.">                    if (callback != null) {</span>
<span class="nc" id="L3650">                        callback.onSucess(ComponentSelector.this);</span>
                    }
<span class="nc" id="L3652">                }</span>

            });
        }
<span class="nc" id="L3656">        return this;</span>
    }

    /**
     * Wraps {@link Container#animateLayout(int) }
     *
     * @param duration
     * @return
     */
    public ComponentSelector animateLayout(int duration) {
<span class="nc" id="L3666">        return animateLayout(duration, null);</span>
    }

    /**
     * Wraps {@link Container#animateLayout(int) }.
     *
     * @param duration
     * @param callback
     * @return
     */
    public ComponentSelector animateLayout(int duration, final SuccessCallback&lt;ComponentSelector&gt; callback) {
<span class="nc" id="L3677">        ArrayList&lt;ComponentAnimation&gt; animations = new ArrayList&lt;ComponentAnimation&gt;();</span>
<span class="nc bnc" id="L3678" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L3679" title="All 2 branches missed.">            if (c instanceof Container) {</span>
<span class="nc" id="L3680">                animations.add(((Container) c).createAnimateLayout(duration));</span>
            }
<span class="nc" id="L3682">        }</span>
<span class="nc" id="L3683">        AnimationManager mgr = getAnimationManager();</span>
<span class="nc bnc" id="L3684" title="All 4 branches missed.">        if (animations.size() &gt; 0 &amp;&amp; mgr != null) {</span>
<span class="nc" id="L3685">            mgr.addAnimation(ComponentAnimation.compoundAnimation(animations.toArray(new ComponentAnimation[animations.size()])), new Runnable() {</span>

                public void run() {
<span class="nc bnc" id="L3688" title="All 2 branches missed.">                    if (callback != null) {</span>
<span class="nc" id="L3689">                        callback.onSucess(ComponentSelector.this);</span>
                    }
<span class="nc" id="L3691">                }</span>

            });
        }
<span class="nc" id="L3695">        return this;</span>
    }

    /**
     * Wraps {@link Container#animateLayoutAndWait(int) }
     *
     * @param duration
     * @return
     */
    public ComponentSelector animateLayoutAndWait(int duration) {
<span class="fc" id="L3705">        ArrayList&lt;ComponentAnimation&gt; animations = new ArrayList&lt;ComponentAnimation&gt;();</span>
<span class="fc bfc" id="L3706" title="All 2 branches covered.">        for (Component c : this) {</span>
<span class="pc bpc" id="L3707" title="1 of 2 branches missed.">            if (c instanceof Container) {</span>
<span class="fc" id="L3708">                animations.add(((Container) c).createAnimateLayout(duration));</span>
            }
<span class="fc" id="L3710">        }</span>
<span class="fc" id="L3711">        AnimationManager mgr = getAnimationManager();</span>
<span class="pc bpc" id="L3712" title="2 of 4 branches missed.">        if (animations.size() &gt; 0 &amp;&amp; mgr != null) {</span>
<span class="fc" id="L3713">            mgr.addAnimationAndBlock(ComponentAnimation.compoundAnimation(animations.toArray(new ComponentAnimation[animations.size()])));</span>
        }
<span class="fc" id="L3715">        return this;</span>
    }

    /**
     * Wraps {@link Container#animateUnlayout(int, int, java.lang.Runnable) }
     *
     * @param duration
     * @param opacity
     * @return
     */
    public ComponentSelector animateUnlayout(int duration, int opacity) {
<span class="nc" id="L3726">        return animateUnlayout(duration, opacity, null);</span>
    }

    /**
     * Wraps {@link Container#animateUnlayout(int, int, java.lang.Runnable) }
     *
     * @param duration
     * @param opacity
     * @param callback Callback to run when animation has completed.
     * @return
     */
    public ComponentSelector animateUnlayout(int duration, int opacity, final SuccessCallback&lt;ComponentSelector&gt; callback) {
<span class="nc" id="L3738">        ArrayList&lt;ComponentAnimation&gt; animations = new ArrayList&lt;ComponentAnimation&gt;();</span>
<span class="nc bnc" id="L3739" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L3740" title="All 2 branches missed.">            if (c instanceof Container) {</span>

<span class="nc" id="L3742">                animations.add(((Container) c).createAnimateUnlayout(duration, opacity, null));</span>
            }
<span class="nc" id="L3744">        }</span>
<span class="nc" id="L3745">        AnimationManager mgr = getAnimationManager();</span>
<span class="nc bnc" id="L3746" title="All 4 branches missed.">        if (animations.size() &gt; 0 &amp;&amp; mgr != null) {</span>
<span class="nc" id="L3747">            mgr.addAnimation(ComponentAnimation.compoundAnimation(animations.toArray(new ComponentAnimation[animations.size()])), new Runnable() {</span>
                public void run() {
<span class="nc bnc" id="L3749" title="All 2 branches missed.">                    if (callback != null) {</span>
<span class="nc" id="L3750">                        callback.onSucess(ComponentSelector.this);</span>
                    }
<span class="nc" id="L3752">                }</span>
            });
        }
<span class="nc" id="L3755">        return this;</span>
    }

    /**
     * Wraps {@link Container#animateUnlayoutAndWait(int, int) }
     *
     * @param duration
     * @param opacity
     * @return
     */
    public ComponentSelector animateUnlayoutAndWait(int duration, int opacity) {
<span class="fc" id="L3766">        ArrayList&lt;ComponentAnimation&gt; animations = new ArrayList&lt;ComponentAnimation&gt;();</span>
<span class="fc bfc" id="L3767" title="All 2 branches covered.">        for (Component c : this) {</span>
<span class="pc bpc" id="L3768" title="1 of 2 branches missed.">            if (c instanceof Container) {</span>

<span class="fc" id="L3770">                animations.add(((Container) c).createAnimateUnlayout(duration, opacity, null));</span>
            }
<span class="fc" id="L3772">        }</span>
<span class="fc" id="L3773">        AnimationManager mgr = getAnimationManager();</span>
<span class="pc bpc" id="L3774" title="2 of 4 branches missed.">        if (animations.size() &gt; 0 &amp;&amp; mgr != null) {</span>
<span class="fc" id="L3775">            mgr.addAnimationAndBlock(ComponentAnimation.compoundAnimation(animations.toArray(new ComponentAnimation[animations.size()])));</span>
        }
<span class="fc" id="L3777">        return this;</span>
    }

    /**
     * Gets the AnimationManager for the components in this set.
     *
     * @return The AnimationManager for the components in this set.
     * @see Component#getAnimationManager()
     */
    public AnimationManager getAnimationManager() {
<span class="pc bpc" id="L3787" title="1 of 2 branches missed.">        for (Component c : this) {</span>
<span class="fc" id="L3788">            AnimationManager mgr = c.getAnimationManager();</span>
<span class="pc bpc" id="L3789" title="1 of 2 branches missed.">            if (mgr != null) {</span>
<span class="fc" id="L3790">                return mgr;</span>
            }
<span class="nc" id="L3792">        }</span>
<span class="nc" id="L3793">        return null;</span>
    }

    /**
     * Gets the text on the first component in this set that supports this property.  Currently this works with
     * Label, TextArea, SpanLabel, and SpanButtons, and subclasses thereof.
     *
     * @return
     */
    public String getText() {
<span class="nc bnc" id="L3803" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L3804" title="All 2 branches missed.">            if (c instanceof Label) {</span>
<span class="nc" id="L3805">                return ((Label) c).getText();</span>
<span class="nc bnc" id="L3806" title="All 2 branches missed.">            } else if (c instanceof TextArea) {</span>
<span class="nc" id="L3807">                return ((TextArea) c).getText();</span>
<span class="nc bnc" id="L3808" title="All 2 branches missed.">            } else if (c instanceof SpanLabel) {</span>
<span class="nc" id="L3809">                return ((SpanLabel) c).getText();</span>
<span class="nc bnc" id="L3810" title="All 2 branches missed.">            } else if (c instanceof SpanButton) {</span>
<span class="nc" id="L3811">                return ((SpanButton) c).getText();</span>
            }
<span class="nc" id="L3813">        }</span>
<span class="nc" id="L3814">        return null;</span>
    }

    /**
     * Sets the text on all components in found set that support this.  Currently this works with
     * Label, TextArea, SpanLabel, and SpanButtons, and subclasses thereof.
     *
     * @param text The text to set in the componnet.
     * @return
     */
    public ComponentSelector setText(String text) {
<span class="fc bfc" id="L3825" title="All 2 branches covered.">        for (Component c : this) {</span>
<span class="pc bpc" id="L3826" title="1 of 2 branches missed.">            if (c instanceof Label) {</span>
<span class="fc" id="L3827">                ((Label) c).setText(text);</span>
<span class="nc bnc" id="L3828" title="All 2 branches missed.">            } else if (c instanceof TextArea) {</span>
<span class="nc" id="L3829">                ((TextArea) c).setText(text);</span>
<span class="nc bnc" id="L3830" title="All 2 branches missed.">            } else if (c instanceof SpanLabel) {</span>
<span class="nc" id="L3831">                ((SpanLabel) c).setText(text);</span>
<span class="nc bnc" id="L3832" title="All 2 branches missed.">            } else if (c instanceof SpanButton) {</span>
<span class="nc" id="L3833">                ((SpanButton) c).setText(text);</span>
            }
<span class="fc" id="L3835">        }</span>
<span class="fc" id="L3836">        return this;</span>
    }

    /**
     * Sets the icon for components in found set.  Only relevant to Labels, SpanLabels, and SpanButtons, and subclasses thereof.
     *
     * @param icon
     * @return
     */
    public ComponentSelector setIcon(Image icon) {
<span class="fc bfc" id="L3846" title="All 2 branches covered.">        for (Component c : this) {</span>
<span class="pc bpc" id="L3847" title="1 of 2 branches missed.">            if (c instanceof IconHolder) {</span>
<span class="fc" id="L3848">                ((IconHolder) c).setIcon(icon);</span>
            }
<span class="fc" id="L3850">        }</span>
<span class="fc" id="L3851">        return this;</span>
    }

    /**
     * Sets the icons of all elements in this set to a material icon.
     *
     * @param materialIcon Material icon charcode.
     * @param style        The style for the icon.
     * @param size         The size for the icon. (in mm)
     * @return Self for chaining.
     * @see FontImage#createMaterial(char, java.lang.String, float)
     */
    public ComponentSelector setIcon(char materialIcon, Style style, float size) {
<span class="nc" id="L3864">        FontImage img = FontImage.createMaterial(materialIcon, style, size);</span>
<span class="nc" id="L3865">        return setIcon(img);</span>
    }

    /**
     * Sets the icon of all elements in this set to a material icon.  This will use
     * the foreground color of each label as the icon's foreground color.
     *
     * @param materialIcon The icon charcode.
     * @param size         The size of the icon (in mm)
     * @return Self for chaining
     * @see FontImage#createMaterial(char, com.codename1.ui.plaf.Style, float)
     */
    public ComponentSelector setIcon(char materialIcon, float size) {
<span class="nc bnc" id="L3878" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L3879" title="All 2 branches missed.">            if (c instanceof Label) {</span>
<span class="nc" id="L3880">                Label l = (Label) c;</span>
<span class="nc" id="L3881">                Style style = new Style();</span>
<span class="nc" id="L3882">                Style cStyle = c.getUnselectedStyle();</span>
<span class="nc" id="L3883">                style.setBgTransparency(0);</span>
<span class="nc" id="L3884">                style.setFgColor(cStyle.getFgColor());</span>
<span class="nc" id="L3885">                l.setIcon(FontImage.createMaterial(materialIcon, style, size));</span>

<span class="nc bnc" id="L3887" title="All 2 branches missed.">                if (c instanceof Button) {</span>
<span class="nc" id="L3888">                    Button b = (Button) c;</span>
<span class="nc" id="L3889">                    style = new Style();</span>
<span class="nc" id="L3890">                    cStyle = c.getPressedStyle();</span>
<span class="nc" id="L3891">                    style.setBgTransparency(0);</span>
<span class="nc" id="L3892">                    style.setFgColor(cStyle.getFgColor());</span>
<span class="nc" id="L3893">                    b.setPressedIcon(FontImage.createMaterial(materialIcon, style, size));</span>
                }

            }

<span class="nc" id="L3898">        }</span>
<span class="nc" id="L3899">        return this;</span>

    }

    /**
     * Sets the icon of all elements in this set to a material icon.  This will use
     * the foreground color of the label.
     *
     * @param materialIcon The material icon charcode.
     * @return Self for chaining.
     */
    public ComponentSelector setIcon(char materialIcon) {
<span class="nc bnc" id="L3911" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L3912" title="All 2 branches missed.">            if (c instanceof Label) {</span>
<span class="nc" id="L3913">                Label l = (Label) c;</span>
<span class="nc" id="L3914">                Style style = new Style();</span>
<span class="nc" id="L3915">                Style cStyle = c.getUnselectedStyle();</span>
<span class="nc" id="L3916">                style.setBgTransparency(0);</span>
<span class="nc" id="L3917">                style.setFgColor(cStyle.getFgColor());</span>

<span class="nc" id="L3919">                l.setIcon(FontImage.createMaterial(materialIcon, style, 3));</span>

<span class="nc bnc" id="L3921" title="All 2 branches missed.">                if (c instanceof Button) {</span>
<span class="nc" id="L3922">                    Button b = (Button) c;</span>
<span class="nc" id="L3923">                    style = new Style();</span>
<span class="nc" id="L3924">                    cStyle = c.getPressedStyle();</span>
<span class="nc" id="L3925">                    style.setBgTransparency(0);</span>
<span class="nc" id="L3926">                    style.setFgColor(cStyle.getFgColor());</span>

<span class="nc" id="L3928">                    b.setPressedIcon(FontImage.createMaterial(materialIcon, style, 3));</span>
                }

            }

<span class="nc" id="L3933">        }</span>
<span class="nc" id="L3934">        return this;</span>

    }

    /**
     * Gets the set of all component forms from components in this set.
     *
     * @return New ComponentSelector with forms all components in this set.
     */
    public ComponentSelector getComponentForm() {
<span class="nc" id="L3944">        HashSet&lt;Component&gt; out = new HashSet&lt;Component&gt;();</span>
<span class="nc bnc" id="L3945" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L3946">            out.add(c.getComponentForm());</span>
<span class="nc" id="L3947">        }</span>
<span class="nc" id="L3948">        return new ComponentSelector(out);</span>
    }

    /**
     * Sets vertical alignment of text.
     *
     * @param valign
     * @return
     * @see Label#setVerticalAlignment(int)
     */
    public ComponentSelector setVerticalAlignment(int valign) {
<span class="nc bnc" id="L3959" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L3960" title="All 2 branches missed.">            if (c instanceof Label) {</span>
<span class="nc" id="L3961">                ((Label) c).setVerticalAlignment(valign);</span>
            }
<span class="nc" id="L3963">        }</span>
<span class="nc" id="L3964">        return this;</span>
    }

    /**
     * Sets text position of text.  Only relevant to labels.
     *
     * @param pos
     * @return
     * @see Label#setTextPosition(int)
     */
    public ComponentSelector setTextPosition(int pos) {
<span class="nc bnc" id="L3975" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L3976" title="All 2 branches missed.">            if (c instanceof IconHolder) {</span>
<span class="nc" id="L3977">                ((IconHolder) c).setTextPosition(pos);</span>
            }
<span class="nc" id="L3979">        }</span>
<span class="nc" id="L3980">        return this;</span>
    }

    /**
     * Sets the Icon UIID of elements in found set.
     *
     * @param uiid The UIID for icons.
     * @return Self for chaining.
     * @see IconHolder#setIconUIID(java.lang.String)
     * @since 7.0
     */
    public ComponentSelector setIconUIID(String uiid) {
<span class="nc bnc" id="L3992" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L3993" title="All 2 branches missed.">            if (c instanceof IconHolder) {</span>
<span class="nc" id="L3994">                ((IconHolder) c).setIconUIID(uiid);</span>
            }
<span class="nc" id="L3996">        }</span>
<span class="nc" id="L3997">        return this;</span>
    }

    /**
     * Sets gap.  Only relevant to labels.
     *
     * @param gap
     * @return
     * @see Label#setGap(int)
     */
    public ComponentSelector setGap(int gap) {
<span class="nc bnc" id="L4008" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L4009" title="All 2 branches missed.">            if (c instanceof IconHolder) {</span>
<span class="nc" id="L4010">                ((IconHolder) c).setGap(gap);</span>
            }
<span class="nc" id="L4012">        }</span>
<span class="nc" id="L4013">        return this;</span>
    }

    /**
     * Sets shift text. Only relevant to labels.
     *
     * @param shift
     * @return
     * @see Label#setShiftText(int)
     */
    public ComponentSelector setShiftText(int shift) {
<span class="nc bnc" id="L4024" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L4025" title="All 2 branches missed.">            if (c instanceof Label) {</span>
<span class="nc" id="L4026">                ((Label) c).setShiftText(shift);</span>
            }
<span class="nc" id="L4028">        }</span>
<span class="nc" id="L4029">        return this;</span>
    }

    /**
     * Wraps {@link Label#startTicker(long, boolean) }
     *
     * @param delay
     * @param rightToLeft
     * @return
     */
    public ComponentSelector startTicker(long delay, boolean rightToLeft) {
<span class="nc bnc" id="L4040" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L4041" title="All 2 branches missed.">            if (c instanceof Label) {</span>
<span class="nc" id="L4042">                ((Label) c).startTicker(delay, rightToLeft);</span>
            }
<span class="nc" id="L4044">        }</span>
<span class="nc" id="L4045">        return this;</span>
    }

    /**
     * Wraps {@link Label#stopTicker() }
     *
     * @return
     */
    public ComponentSelector stopTicker() {
<span class="nc bnc" id="L4054" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L4055" title="All 2 branches missed.">            if (c instanceof Label) {</span>
<span class="nc" id="L4056">                ((Label) c).stopTicker();</span>
            }
<span class="nc" id="L4058">        }</span>
<span class="nc" id="L4059">        return this;</span>
    }

    /**
     * Wraps {@link Label#setTickerEnabled(boolean) }
     *
     * @param b
     * @return
     */
    public ComponentSelector setTickerEnabled(boolean b) {
<span class="nc bnc" id="L4069" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L4070" title="All 2 branches missed.">            if (c instanceof Label) {</span>
<span class="nc" id="L4071">                ((Label) c).setTickerEnabled(b);</span>
            }
<span class="nc" id="L4073">        }</span>
<span class="nc" id="L4074">        return this;</span>
    }

    /**
     * Wraps {@link Label#setEndsWith3Points(boolean) }
     *
     * @param b
     * @return
     */
    public ComponentSelector setEndsWith3Points(boolean b) {
<span class="nc bnc" id="L4084" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L4085" title="All 2 branches missed.">            if (c instanceof Label) {</span>
<span class="nc" id="L4086">                ((Label) c).setEndsWith3Points(b);</span>
            }
<span class="nc" id="L4088">        }</span>
<span class="nc" id="L4089">        return this;</span>
    }

    /**
     * Wraps {@link Label#setMask(java.lang.Object) }
     *
     * @param mask
     * @return
     */
    public ComponentSelector setMask(Object mask) {
<span class="nc bnc" id="L4099" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L4100" title="All 2 branches missed.">            if (c instanceof Label) {</span>
<span class="nc" id="L4101">                ((Label) c).setMask(mask);</span>
            }
<span class="nc" id="L4103">        }</span>
<span class="nc" id="L4104">        return this;</span>
    }

    /**
     * Wraps {@link Label#setMaskName(java.lang.String) }
     *
     * @param name
     * @return
     */
    public ComponentSelector setMaskName(String name) {
<span class="nc bnc" id="L4114" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L4115" title="All 2 branches missed.">            if (c instanceof Label) {</span>
<span class="nc" id="L4116">                ((Label) c).setMaskName(name);</span>
            }
<span class="nc" id="L4118">        }</span>
<span class="nc" id="L4119">        return this;</span>
    }

    /**
     * Wraps {@link Label#setShouldLocalize(boolean) }
     *
     * @param b
     * @return
     */
    public ComponentSelector setShouldLocalize(boolean b) {
<span class="nc bnc" id="L4129" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L4130" title="All 2 branches missed.">            if (c instanceof Label) {</span>
<span class="nc" id="L4131">                ((Label) c).setShouldLocalize(b);</span>
            }
<span class="nc" id="L4133">        }</span>
<span class="nc" id="L4134">        return this;</span>
    }

    /**
     * Wraps {@link Label#setShiftMillimeters(int) }
     *
     * @param b
     * @return
     */
    public ComponentSelector setShiftMillimeters(int b) {
<span class="nc bnc" id="L4144" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L4145" title="All 2 branches missed.">            if (c instanceof Label) {</span>
<span class="nc" id="L4146">                ((Label) c).setShiftMillimeters(b);</span>
            }
<span class="nc" id="L4148">        }</span>
<span class="nc" id="L4149">        return this;</span>
    }

    /**
     * Wraps {@link Label#setShowEvenIfBlank(boolean) }
     *
     * @param b
     * @return
     */
    public ComponentSelector setShowEvenIfBlank(boolean b) {
<span class="nc bnc" id="L4159" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L4160" title="All 2 branches missed.">            if (c instanceof Label) {</span>
<span class="nc" id="L4161">                ((Label) c).setShowEvenIfBlank(b);</span>
            }
<span class="nc" id="L4163">        }</span>
<span class="nc" id="L4164">        return this;</span>
    }

    /**
     * Wraps {@link Label#setLegacyRenderer(boolean) }
     *
     * @param b
     * @return
     */
    public ComponentSelector setLegacyRenderer(boolean b) {
<span class="nc bnc" id="L4174" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L4175" title="All 2 branches missed.">            if (c instanceof Label) {</span>
<span class="nc" id="L4176">                ((Label) c).setLegacyRenderer(b);</span>
            }
<span class="nc" id="L4178">        }</span>
<span class="nc" id="L4179">        return this;</span>
    }

    /**
     * Wraps {@link Label#setAutoSizeMode(boolean) }
     *
     * @param b
     * @return
     */
    public ComponentSelector setAutoSizeMode(boolean b) {
<span class="nc bnc" id="L4189" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L4190" title="All 2 branches missed.">            if (c instanceof Label) {</span>
<span class="nc" id="L4191">                ((Label) c).setAutoSizeMode(b);</span>
            }
<span class="nc" id="L4193">        }</span>
<span class="nc" id="L4194">        return this;</span>
    }

    /**
     * Wraps {@link Button#setCommand(com.codename1.ui.Command) }
     *
     * @param cmd
     * @return
     */
    public ComponentSelector setCommand(Command cmd) {
<span class="nc bnc" id="L4204" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L4205" title="All 2 branches missed.">            if (c instanceof Button) {</span>
<span class="nc" id="L4206">                ((Button) c).setCommand(cmd);</span>
            }
<span class="nc" id="L4208">        }</span>
<span class="nc" id="L4209">        return this;</span>
    }

    /**
     * Wraps {@link Button#setRolloverPressedIcon(com.codename1.ui.Image) }
     *
     * @param icon
     * @return
     */
    public ComponentSelector setRolloverPressedIcon(Image icon) {
<span class="nc bnc" id="L4219" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L4220" title="All 2 branches missed.">            if (c instanceof Button) {</span>
<span class="nc" id="L4221">                ((Button) c).setRolloverPressedIcon(icon);</span>
            }
<span class="nc" id="L4223">        }</span>
<span class="nc" id="L4224">        return this;</span>
    }

    /**
     * Wraps {@link Button#setRolloverIcon(com.codename1.ui.Image) }
     *
     * @param icon
     * @return
     */
    public ComponentSelector setRolloverIcon(Image icon) {
<span class="nc bnc" id="L4234" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L4235" title="All 2 branches missed.">            if (c instanceof Button) {</span>
<span class="nc" id="L4236">                ((Button) c).setRolloverIcon(icon);</span>
            }
<span class="nc" id="L4238">        }</span>
<span class="nc" id="L4239">        return this;</span>
    }

    /**
     * Wraps {@link Button#setPressedIcon(com.codename1.ui.Image) }
     *
     * @param icon
     * @return
     */
    public ComponentSelector setPressedIcon(Image icon) {
<span class="nc bnc" id="L4249" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L4250" title="All 2 branches missed.">            if (c instanceof Button) {</span>
<span class="nc" id="L4251">                ((Button) c).setPressedIcon(icon);</span>
            }
<span class="nc" id="L4253">        }</span>
<span class="nc" id="L4254">        return this;</span>
    }

    /**
     * Wraps {@link Button#setDisabledIcon(com.codename1.ui.Image) }
     *
     * @param icon
     * @return
     */
    public ComponentSelector setDisabledIcon(Image icon) {
<span class="nc bnc" id="L4264" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L4265" title="All 2 branches missed.">            if (c instanceof Button) {</span>
<span class="nc" id="L4266">                ((Button) c).setDisabledIcon(icon);</span>
            }
<span class="nc" id="L4268">        }</span>
<span class="nc" id="L4269">        return this;</span>
    }

    /**
     * Adds action listener to applicable components in found set.  Currently this will apply to
     * Buttons, Lists, Sliders, TextAreas, OnOffSwitches, SpanButtons, and subclasses thereof.
     *
     * @param l
     * @return
     */
    public ComponentSelector addActionListener(ActionListener l) {
<span class="fc bfc" id="L4280" title="All 2 branches covered.">        for (Component c : this) {</span>
<span class="pc bpc" id="L4281" title="1 of 2 branches missed.">            if (c instanceof ActionSource) {</span>
<span class="fc" id="L4282">                ((ActionSource) c).addActionListener(l);</span>
            }
<span class="fc" id="L4284">        }</span>
<span class="fc" id="L4285">        return this;</span>
    }

    /**
     * Removes action listeners from components in set.
     *
     * @param l The listener to remove
     * @since 7.0
     */
    public ComponentSelector removeActionListener(ActionListener l) {
<span class="nc bnc" id="L4295" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L4296" title="All 2 branches missed.">            if (c instanceof ActionSource) {</span>
<span class="nc" id="L4297">                ((ActionSource) c).removeActionListener(l);</span>
            }
<span class="nc" id="L4299">        }</span>
<span class="nc" id="L4300">        return this;</span>
    }

    /**
     * Wraps {@link TextArea#setEditable(boolean) }
     *
     * @param b
     * @return
     */
    public ComponentSelector setEditable(boolean b) {
<span class="nc bnc" id="L4310" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L4311" title="All 2 branches missed.">            if (c instanceof TextArea) {</span>
<span class="nc" id="L4312">                ((TextArea) c).setEditable(b);</span>
            }
<span class="nc" id="L4314">        }</span>
<span class="nc" id="L4315">        return this;</span>
    }

    /**
     * Wraps {@link TextField#addDataChangedListener(com.codename1.ui.events.DataChangedListener) }
     *
     * @param l
     * @return
     */
    public ComponentSelector addDataChangedListener(DataChangedListener l) {
<span class="nc bnc" id="L4325" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L4326" title="All 2 branches missed.">            if (c instanceof TextField) {</span>
<span class="nc" id="L4327">                ((TextField) c).addDataChangedListener(l);</span>
            }
<span class="nc" id="L4329">        }</span>
<span class="nc" id="L4330">        return this;</span>
    }

    /**
     * Wraps {@link TextField#removeDataChangedListener(com.codename1.ui.events.DataChangedListener) }
     *
     * @param l
     * @return
     */
    public ComponentSelector removeDataChangedListener(DataChangedListener l) {
<span class="nc bnc" id="L4340" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L4341" title="All 2 branches missed.">            if (c instanceof TextField) {</span>
<span class="nc" id="L4342">                ((TextField) c).removeDataChangedListener(l);</span>
            }
<span class="nc" id="L4344">        }</span>
<span class="nc" id="L4345">        return this;</span>
    }

    /**
     * Wraps {@link TextField#setDoneListener(com.codename1.ui.events.ActionListener) }
     *
     * @param l
     * @return
     */
    public ComponentSelector setDoneListener(ActionListener l) {
<span class="nc bnc" id="L4355" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc bnc" id="L4356" title="All 2 branches missed.">            if (c instanceof TextField) {</span>
<span class="nc" id="L4357">                ((TextField) c).setDoneListener(l);</span>
            }
<span class="nc" id="L4359">        }</span>
<span class="nc" id="L4360">        return this;</span>
    }

    /**
     * Sets padding to all sides of found set components in pixels.
     *
     * @param padding Padding in pixels
     * @return
     * @see #getStyle(com.codename1.ui.Component)
     */
    public ComponentSelector setPadding(int padding) {
<span class="fc" id="L4371">        return setPadding(padding, padding, padding, padding);</span>
    }

    /**
     * Strips margin and padding from components in found set.
     *
     * @return Self for chaining.
     * @see Style#stripMarginAndPadding()
     * @since 7.0
     */
    public ComponentSelector stripMarginAndPadding() {
<span class="nc" id="L4382">        Style s = currentStyle();</span>
<span class="nc" id="L4383">        s.stripMarginAndPadding();</span>
<span class="nc" id="L4384">        return this;</span>
    }

    // Now for the style stuff

    /**
     * Sets padding to all components in found set.
     *
     * @param top    Top padding in pixels.
     * @param right  Right padding in pixels
     * @param bottom Bottom padding in pixels.
     * @param left   Left padding in pixels.
     * @return
     * @see #getStyle(com.codename1.ui.Component)
     */
    public ComponentSelector setPadding(int top, int right, int bottom, int left) {
<span class="fc" id="L4400">        Style s = currentStyle();</span>
<span class="fc" id="L4401">        s.setPaddingUnit(Style.UNIT_TYPE_PIXELS, Style.UNIT_TYPE_PIXELS, Style.UNIT_TYPE_PIXELS, Style.UNIT_TYPE_PIXELS);</span>
<span class="fc" id="L4402">        s.setPadding(top, bottom, left, right);</span>
<span class="fc" id="L4403">        return this;</span>
    }

    /**
     * Sets padding to all components in found set in millimeters.
     *
     * @param top    Top padding in mm.
     * @param right  Right padding in mm
     * @param bottom Bottom padding in mm.
     * @param left   Left padding in mm.
     * @return
     * @see #getStyle(com.codename1.ui.Component)
     */
    public ComponentSelector setPaddingMillimeters(float top, float right, float bottom, float left) {
<span class="fc" id="L4417">        return setPadding(dip2px(top), dip2px(right), dip2px(bottom), dip2px(left));</span>
    }

    /**
     * Sets padding in millimeters to all components in found set.
     *
     * @param topBottom Top and bottom padding in mm.
     * @param leftRight Left and right padding in mm.
     * @return
     * @see #getStyle(com.codename1.ui.Component)
     */
    public ComponentSelector setPaddingMillimeters(float topBottom, float leftRight) {
<span class="fc" id="L4429">        return setPaddingMillimeters(topBottom, leftRight, topBottom, leftRight);</span>
    }

    /**
     * Sets padding to all components in found set.
     *
     * @param padding Padding applied to all sides in mm.
     * @return
     */
    public ComponentSelector setPaddingMillimeters(float padding) {
<span class="fc" id="L4439">        return setPaddingMillimeters(padding, padding);</span>
    }

    /**
     * Sets padding on all components in found set.
     *
     * @param topBottom Top and bottom padding in pixels.
     * @param leftRight Left and right padding in pixels.
     * @return
     */
    public ComponentSelector setPadding(int topBottom, int leftRight) {
<span class="nc" id="L4450">        return setPadding(topBottom, leftRight, topBottom, leftRight);</span>
    }

    private int percentHeight(double percentage, Component parent) {
<span class="nc" id="L4454">        return (int) Math.round((parent.getHeight() * percentage / 100));</span>
    }

    private int percentWidth(double percentage, Component parent) {
<span class="nc" id="L4458">        return (int) Math.round((parent.getWidth() * percentage / 100));</span>
    }

    /**
     * Sets the padding on all components in found set as a percentage of their respective
     * parents' dimensions.  Horizontal padding is set as a percentage of parent width.  Vertical padding
     * is set as a percentage of parent height.
     *
     * @param padding The padding expressed as a percent.
     * @return
     */
    public ComponentSelector setPaddingPercent(double padding) {
<span class="nc" id="L4470">        return setPaddingPercent(padding, padding, padding, padding);</span>

    }

    /**
     * Sets padding on all components in found set as a percentage of their respective parents' dimensions.
     *
     * @param topBottom Top and bottom padding as percentage of parent heights.
     * @param leftRight Left and right padding as percentage of parent widths.
     * @return
     */
    public ComponentSelector setPaddingPercent(double topBottom, double leftRight) {
<span class="nc" id="L4482">        return setPaddingPercent(topBottom, leftRight, topBottom, leftRight);</span>
    }

    /**
     * Sets padding on all components in found set as a percentage of their respective parents' dimensions.
     *
     * @param top    Top padding as percentage of parent height.
     * @param right  Right padding as percentage of parent width.
     * @param bottom Bottom padding as percentage of parent height.
     * @param left   Left padding as percentage of parent width.
     * @return
     */
    public ComponentSelector setPaddingPercent(double top, double right, double bottom, double left) {
<span class="nc bnc" id="L4495" title="All 2 branches missed.">        for (Component c : this) {</span>

<span class="nc" id="L4497">            Component parent = c.getParent();</span>
<span class="nc bnc" id="L4498" title="All 2 branches missed.">            if (parent != null) {</span>
                // TODO : Change to currentStyle api... more complex with percents.
<span class="nc" id="L4500">                Style s = getStyle(c);</span>
<span class="nc" id="L4501">                s.setPaddingUnit(Style.UNIT_TYPE_PIXELS, Style.UNIT_TYPE_PIXELS, Style.UNIT_TYPE_PIXELS, Style.UNIT_TYPE_PIXELS);</span>
<span class="nc" id="L4502">                s.setPadding(</span>
<span class="nc" id="L4503">                        percentHeight(top, parent),</span>
<span class="nc" id="L4504">                        percentHeight(bottom, parent),</span>
<span class="nc" id="L4505">                        percentWidth(left, parent),</span>
<span class="nc" id="L4506">                        percentWidth(right, parent)</span>
                );
            }
<span class="nc" id="L4509">        }</span>
<span class="nc" id="L4510">        return this;</span>
    }

    /**
     * Sets margin to all sides of found set components in pixels.
     *
     * @param margin Margin in pixels
     * @return
     * @see #getStyle(com.codename1.ui.Component)
     */
    public ComponentSelector setMargin(int margin) {
<span class="fc" id="L4521">        return setMargin(margin, margin, margin, margin);</span>
    }

    /**
     * Sets margin to all components in found set.
     *
     * @param top    Top margin in pixels.
     * @param right  Right margin in pixels
     * @param bottom Bottom margin in pixels.
     * @param left   Left margin in pixels.
     * @return
     * @see #getStyle(com.codename1.ui.Component)
     */
    public ComponentSelector setMargin(int top, int right, int bottom, int left) {
<span class="fc" id="L4535">        Style s = currentStyle();</span>
<span class="fc" id="L4536">        s.setMarginUnit(Style.UNIT_TYPE_PIXELS, Style.UNIT_TYPE_PIXELS, Style.UNIT_TYPE_PIXELS, Style.UNIT_TYPE_PIXELS);</span>
<span class="fc" id="L4537">        s.setMargin(top, bottom, left, right);</span>
<span class="fc" id="L4538">        return this;</span>
    }

    /**
     * Sets margin on all components in found set.
     *
     * @param topBottom Top and bottom margin in pixels.
     * @param leftRight Left and right margin in pixels.
     * @return
     */
    public ComponentSelector setMargin(int topBottom, int leftRight) {
<span class="nc" id="L4549">        return setMargin(topBottom, leftRight, topBottom, leftRight);</span>
    }

    /**
     * Sets the margin on all components in found set as a percentage of their respective
     * parents' dimensions.  Horizontal margin is set as a percentage of parent width.  Vertical margin
     * is set as a percentage of parent height.
     *
     * @param margin The margin expressed as a percent.
     * @return
     */
    public ComponentSelector setMarginPercent(double margin) {
<span class="nc" id="L4561">        return setMarginPercent(margin, margin, margin, margin);</span>

    }

    /**
     * Sets margin on all components in found set as a percentage of their respective parents' dimensions.
     *
     * @param topBottom Top and bottom margin as percentage of parent heights.
     * @param leftRight Left and right margin as percentage of parent widths.
     * @return
     */
    public ComponentSelector setMarginPercent(double topBottom, double leftRight) {
<span class="nc" id="L4573">        return setMarginPercent(topBottom, leftRight, topBottom, leftRight);</span>
    }

    /**
     * Sets margin on all components in found set as a percentage of their respective parents' dimensions.
     *
     * @param top    Top margin as percentage of parent height.
     * @param right  Right margin as percentage of parent width.
     * @param bottom Bottom margin as percentage of parent height.
     * @param left   Left margin as percentage of parent width.
     * @return
     */
    public ComponentSelector setMarginPercent(double top, double right, double bottom, double left) {
<span class="nc bnc" id="L4586" title="All 2 branches missed.">        for (Component c : this) {</span>

<span class="nc" id="L4588">            Component parent = c.getParent();</span>
<span class="nc bnc" id="L4589" title="All 2 branches missed.">            if (parent != null) {</span>
<span class="nc" id="L4590">                Style s = getStyle(c);</span>
<span class="nc" id="L4591">                s.setMarginUnit(Style.UNIT_TYPE_PIXELS, Style.UNIT_TYPE_PIXELS, Style.UNIT_TYPE_PIXELS, Style.UNIT_TYPE_PIXELS);</span>
<span class="nc" id="L4592">                s.setMargin(</span>
<span class="nc" id="L4593">                        percentHeight(top, parent),</span>
<span class="nc" id="L4594">                        percentHeight(bottom, parent),</span>
<span class="nc" id="L4595">                        percentWidth(left, parent),</span>
<span class="nc" id="L4596">                        percentWidth(right, parent)</span>
                );
            }
<span class="nc" id="L4599">        }</span>
<span class="nc" id="L4600">        return this;</span>
    }

    /**
     * Sets margin to all components in found set in millimeters.
     *
     * @param top    Top margin in mm.
     * @param right  Right margin in mm
     * @param bottom Bottom margin in mm.
     * @param left   Left margin in mm.
     * @return
     * @see #getStyle(com.codename1.ui.Component)
     */
    public ComponentSelector setMarginMillimeters(float top, float right, float bottom, float left) {
<span class="nc" id="L4614">        return setMargin(dip2px(top), dip2px(right), dip2px(bottom), dip2px(left));</span>
    }

    /**
     * Sets margin in millimeters to all components in found set.
     *
     * @param topBottom Top and bottom margin in mm.
     * @param leftRight Left and right margin in mm.
     * @return
     * @see #getStyle(com.codename1.ui.Component)
     */
    public ComponentSelector setMarginMillimeters(float topBottom, float leftRight) {
<span class="nc" id="L4626">        return setMarginMillimeters(topBottom, leftRight, topBottom, leftRight);</span>
    }

    /**
     * Sets margin to all components in found set.
     *
     * @param margin Margin applied to all sides in mm.
     * @return
     */
    public ComponentSelector setMarginMillimeters(float margin) {
<span class="nc" id="L4636">        return setMarginMillimeters(margin, margin);</span>
    }

    /**
     * Creates a proxy style to mutate the styles of all component styles in found set.
     *
     * @return
     * @see #getStyle(com.codename1.ui.Component)
     * @see Style#createProxyStyle(com.codename1.ui.plaf.Style...)
     */
    public Style createProxyStyle() {
<span class="nc" id="L4647">        HashSet&lt;Style&gt; styles = new HashSet&lt;Style&gt;();</span>
<span class="nc bnc" id="L4648" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L4649">            styles.add(getStyle(c));</span>
<span class="nc" id="L4650">        }</span>
<span class="nc" id="L4651">        return Style.createProxyStyle(styles.toArray(new Style[styles.size()]));</span>
    }

    /**
     * Merges style with all styles of components in current found set.
     *
     * @param style
     * @return
     * @see Style#merge(com.codename1.ui.plaf.Style)
     * @see #getStyle(com.codename1.ui.Component)
     */
    public ComponentSelector merge(Style style) {
<span class="nc bnc" id="L4663" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L4664">            getStyle(c).merge(style);</span>
<span class="nc" id="L4665">        }</span>
<span class="nc" id="L4666">        return this;</span>
    }

    /**
     * Wraps {@link Style#setBgColor(int) }
     *
     * @param bgColor
     * @return
     * @see #getStyle(com.codename1.ui.Component)
     */
    public ComponentSelector setBgColor(int bgColor) {
<span class="fc" id="L4677">        currentStyle().setBgColor(bgColor);</span>
<span class="fc" id="L4678">        return this;</span>
    }

    /**
     * Wraps {@link Style#setAlignment(int) }
     *
     * @param alignment
     * @return
     * @see #getStyle(com.codename1.ui.Component)
     */
    public ComponentSelector setAlignment(int alignment) {
<span class="nc" id="L4689">        currentStyle().setAlignment(alignment);</span>
<span class="nc" id="L4690">        return this;</span>
    }

    /**
     * Wraps {@link Style#setBgImage(com.codename1.ui.Image)  }
     *
     * @param bgImage
     * @return
     * @see #getStyle(com.codename1.ui.Component)
     */
    public ComponentSelector setBgImage(Image bgImage) {
<span class="nc" id="L4701">        currentStyle().setBgImage(bgImage);</span>
<span class="nc" id="L4702">        return this;</span>
    }

    /**
     * Wraps {@link Style#setBackgroundType(byte)  }
     *
     * @param backgroundType
     * @return
     * @see #getStyle(com.codename1.ui.Component)
     */
    public ComponentSelector setBackgroundType(byte backgroundType) {
<span class="nc" id="L4713">        currentStyle().setBackgroundType(backgroundType);</span>
<span class="nc" id="L4714">        return this;</span>
    }

    /**
     * Wraps {@link Style#setBackgroundGradientStartColor(int) }
     *
     * @param startColor
     * @return
     * @see #getStyle(com.codename1.ui.Component)
     */
    public ComponentSelector setBackgroundGradientStartColor(int startColor) {
<span class="nc" id="L4725">        currentStyle().setBackgroundGradientStartColor(startColor);</span>
<span class="nc" id="L4726">        return this;</span>
    }

    /**
     * Wraps {@link Style#setBackgroundGradientEndColor(int) (int) }
     *
     * @param endColor
     * @return
     * @see #getStyle(com.codename1.ui.Component)
     */
    public ComponentSelector setBackgroundGradientEndColor(int endColor) {
<span class="nc" id="L4737">        currentStyle().setBackgroundGradientEndColor(endColor);</span>
<span class="nc" id="L4738">        return this;</span>
    }

    /**
     * Wraps {@link Style#setBackgroundGradientRelativeX(float) }
     *
     * @param x
     * @return
     * @see #getStyle(com.codename1.ui.Component)
     */
    public ComponentSelector setBackgroundGradientRelativeX(float x) {
<span class="nc" id="L4749">        currentStyle().setBackgroundGradientRelativeX(x);</span>
<span class="nc" id="L4750">        return this;</span>
    }

    /**
     * Wraps {@link Style#setBackgroundGradientRelativeY(float)  }
     *
     * @param y
     * @return
     * @see #getStyle(com.codename1.ui.Component)
     */
    public ComponentSelector setBackgroundGradientRelativeY(float y) {
<span class="nc" id="L4761">        currentStyle().setBackgroundGradientRelativeY(y);</span>
<span class="nc" id="L4762">        return this;</span>
    }

    /**
     * Wraps {@link Style#setBackgroundGradientRelativeSize(float)  }
     *
     * @param size
     * @return
     * @see #getStyle(com.codename1.ui.Component)
     */
    public ComponentSelector setBackgroundGradientRelativeSize(float size) {
<span class="nc" id="L4773">        currentStyle().setBackgroundGradientRelativeSize(size);</span>
<span class="nc" id="L4774">        return this;</span>
    }

    /**
     * Wraps {@link Style#setFgColor(int)  }
     *
     * @param color
     * @return
     * @see #getStyle(com.codename1.ui.Component)
     */
    public ComponentSelector setFgColor(int color) {
<span class="fc" id="L4785">        currentStyle().setFgColor(color);</span>
<span class="fc" id="L4786">        return this;</span>
    }

    /**
     * Wraps {@link Style#setFont(com.codename1.ui.Font)  }
     *
     * @param f
     * @return
     * @see #getStyle(com.codename1.ui.Component)
     */
    public ComponentSelector setFont(Font f) {
<span class="nc" id="L4797">        currentStyle().setFont(f);</span>
<span class="nc" id="L4798">        return this;</span>
    }

    /**
     * Wraps {@link Style#setUnderline(boolean) }
     *
     * @param b
     * @return
     * @see #getStyle(com.codename1.ui.Component)
     */
    public ComponentSelector setUnderline(boolean b) {
<span class="nc" id="L4809">        currentStyle().setUnderline(b);</span>
<span class="nc" id="L4810">        return this;</span>
    }

    /**
     * Wraps {@link Style#set3DText(boolean, boolean) }
     *
     * @param t
     * @param raised
     * @return
     * @see #getStyle(com.codename1.ui.Component)
     */
    public ComponentSelector set3DText(boolean t, boolean raised) {
<span class="nc" id="L4822">        currentStyle().set3DText(t, raised);</span>
<span class="nc" id="L4823">        return this;</span>
    }

    /**
     * Wraps {@link Style#set3DTextNorth(boolean) }
     *
     * @param north
     * @return
     * @see #getStyle(com.codename1.ui.Component)
     */
    public ComponentSelector set3DTextNorth(boolean north) {
<span class="nc" id="L4834">        currentStyle().set3DTextNorth(north);</span>
<span class="nc" id="L4835">        return this;</span>
    }

    /**
     * Wraps {@link Style#setOverline(boolean) }
     *
     * @param b
     * @return
     * @see #getStyle(com.codename1.ui.Component)
     */
    public ComponentSelector setOverline(boolean b) {
<span class="nc" id="L4846">        currentStyle().setOverline(b);</span>
<span class="nc" id="L4847">        return this;</span>
    }

    /**
     * Wraps {@link Style#setStrikeThru(boolean)  }
     *
     * @param b
     * @return
     * @see #getStyle(com.codename1.ui.Component)
     */
    public ComponentSelector setStrikeThru(boolean b) {
<span class="nc" id="L4858">        currentStyle().setStrikeThru(b);</span>
<span class="nc" id="L4859">        return this;</span>
    }

    /**
     * Wraps {@link Style#setTextDecoration(int)  }
     *
     * @param textDecoration
     * @return
     * @see #getStyle(com.codename1.ui.Component)
     */
    public ComponentSelector setTextDecoration(int textDecoration) {
<span class="nc" id="L4870">        currentStyle().setTextDecoration(textDecoration);</span>
<span class="nc" id="L4871">        return this;</span>
    }

    /**
     * Wraps {@link Style#setBgTransparency(byte) }
     *
     * @param bgTransparency
     * @return
     * @see #getStyle(com.codename1.ui.Component)
     */
    public ComponentSelector setBgTransparency(int bgTransparency) {
<span class="fc" id="L4882">        currentStyle().setBgTransparency(bgTransparency);</span>
<span class="fc" id="L4883">        return this;</span>
    }

    /**
     * Wraps {@link Style#setOpacity(int)  }
     *
     * @param opacity
     * @return
     * @see #getStyle(com.codename1.ui.Component)
     */
    public ComponentSelector setOpacity(int opacity) {
<span class="nc" id="L4894">        currentStyle().setOpacity(opacity);</span>

<span class="nc" id="L4896">        return this;</span>
    }

    /**
     * Wraps {@link Style#addStyleListener(com.codename1.ui.events.StyleListener) }
     *
     * @param l
     * @return
     * @see #getStyle(com.codename1.ui.Component)
     */
    public ComponentSelector addStyleListener(StyleListener l) {
<span class="nc" id="L4907">        currentStyle().addStyleListener(l);</span>
<span class="nc" id="L4908">        return this;</span>
    }

    /**
     * Wraps {@link Style#removeStyleListener(com.codename1.ui.events.StyleListener)  }
     *
     * @param l
     * @return
     * @see #getStyle(com.codename1.ui.Component)
     */
    public ComponentSelector removeStyleListener(StyleListener l) {
<span class="nc" id="L4919">        currentStyle().removeStyleListener(l);</span>
<span class="nc" id="L4920">        return this;</span>
    }

    /**
     * Wraps {@link Style#removeListeners() }
     *
     * @return
     * @see #getStyle(com.codename1.ui.Component)
     */
    public ComponentSelector removeStyleListeners() {
<span class="nc" id="L4930">        currentStyle().removeListeners();</span>
<span class="nc" id="L4931">        return this;</span>
    }

    /**
     * Wraps {@link Style#setBorder(com.codename1.ui.plaf.Border)  }
     *
     * @param b
     * @return
     * @see #getStyle(com.codename1.ui.Component)
     */
    public ComponentSelector setBorder(Border b) {
<span class="fc" id="L4942">        currentStyle().setBorder(b);</span>
<span class="fc" id="L4943">        return this;</span>
    }

    /**
     * Wraps {@link Style#setBgPainter(com.codename1.ui.Painter)  }
     *
     * @param bgPainter
     * @return
     * @see #getStyle(com.codename1.ui.Component)
     */
    public ComponentSelector setBgPainter(Painter bgPainter) {
<span class="nc" id="L4954">        currentStyle().setBgPainter(bgPainter);</span>
<span class="nc" id="L4955">        return this;</span>
    }

    private float getEffectiveFontSize(Component c) {
<span class="nc" id="L4959">        Font f = c.getStyle().getFont();</span>

<span class="nc bnc" id="L4961" title="All 4 branches missed.">        while (f == null &amp;&amp; c != null) {</span>
<span class="nc" id="L4962">            c = c.getParent();</span>
<span class="nc bnc" id="L4963" title="All 2 branches missed.">            if (c != null) {</span>
<span class="nc" id="L4964">                f = c.getStyle().getFont();</span>
            }
        }
<span class="nc bnc" id="L4967" title="All 2 branches missed.">        if (f != null) {</span>
<span class="nc" id="L4968">            return f.getPixelSize();</span>
        }
<span class="nc" id="L4970">        return Font.getDefaultFont().getHeight() * 1.6f;</span>
    }

    /**
     * Sets the font size of all components in found set.  In pixels.
     *
     * @param size Font size in pixels.
     * @return
     * @see #getStyle(com.codename1.ui.Component)
     */
    public ComponentSelector setFontSize(float size) {
<span class="nc bnc" id="L4981" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L4982">            Style style = getStyle(c);</span>
<span class="nc" id="L4983">            Font curr = style.getFont();</span>
<span class="nc bnc" id="L4984" title="All 4 branches missed.">            if (curr == null || !curr.isTTFNativeFont()) {</span>
<span class="nc" id="L4985">                curr = c.getStyle().getFont();</span>
            }

<span class="nc bnc" id="L4988" title="All 4 branches missed.">            if (curr == null || !curr.isTTFNativeFont()) {</span>
<span class="nc" id="L4989">                Component parent = c.getParent();</span>
<span class="nc bnc" id="L4990" title="All 6 branches missed.">                while (parent != null &amp;&amp; (curr == null || !curr.isTTFNativeFont())) {</span>
<span class="nc" id="L4991">                    curr = parent.getStyle().getFont();</span>
<span class="nc" id="L4992">                    parent = parent.getParent();</span>
                }
            }
<span class="nc bnc" id="L4995" title="All 4 branches missed.">            if (curr == null || !curr.isTTFNativeFont()) {</span>
<span class="nc" id="L4996">                curr = Font.create(&quot;native:MainRegular&quot;);</span>
            }

<span class="nc bnc" id="L4999" title="All 4 branches missed.">            if (curr != null &amp;&amp; curr.isTTFNativeFont()) {</span>
<span class="nc" id="L5000">                curr = curr.derive(size, 0);</span>
<span class="nc" id="L5001">                style.setFont(curr);</span>
            }

<span class="nc" id="L5004">        }</span>
<span class="nc" id="L5005">        return this;</span>
    }

    /**
     * Sets the material icon of all labels in the set.
     *
     * @param icon Material icon to set.  See {@link FontImage#setMaterialIcon(com.codename1.ui.Label, char) }
     * @param size The icon size in millimeters.
     * @return Self for chaining.
     * @since 7.0
     */
    public ComponentSelector setMaterialIcon(char icon, float size) {
<span class="fc bfc" id="L5017" title="All 2 branches covered.">        for (Component c : this) {</span>
<span class="pc bpc" id="L5018" title="1 of 2 branches missed.">            if (c instanceof Label) {</span>
<span class="fc" id="L5019">                FontImage.setMaterialIcon((Label) c, icon, size);</span>
            }
<span class="fc" id="L5021">        }</span>
<span class="fc" id="L5022">        return this;</span>
    }

    public ComponentSelector setCursor(int cursor) {
<span class="fc bfc" id="L5026" title="All 2 branches covered.">        for (Component c : this) {</span>
<span class="fc" id="L5027">            c.setCursor(cursor);</span>
<span class="fc" id="L5028">        }</span>
<span class="fc" id="L5029">        return this;</span>
    }

    /**
     * Sets the font size of all components in found set.  In millimeters.
     *
     * @param sizeMM Font size in mm.
     * @return
     */
    public ComponentSelector setFontSizeMillimeters(float sizeMM) {
<span class="nc" id="L5039">        return setFontSize(dip2px(sizeMM));</span>
    }

    /**
     * Sets the fonts size of all components in the found set as a percentage of the font
     * size of the components' respective parents.
     *
     * @param sizePercentage Font size as a percentage of parent font size.
     * @return
     */
    public ComponentSelector setFontSizePercent(double sizePercentage) {
<span class="nc bnc" id="L5050" title="All 2 branches missed.">        for (Component c : this) {</span>
<span class="nc" id="L5051">            Component parent = c.getParent();</span>
<span class="nc bnc" id="L5052" title="All 2 branches missed.">            if (parent != null) {</span>
<span class="nc" id="L5053">                float size = (float) (getEffectiveFontSize(parent) * sizePercentage / 100.0);</span>
<span class="nc" id="L5054">                Style style = getStyle(c);</span>

<span class="nc" id="L5056">                Font curr = style.getFont();</span>
<span class="nc bnc" id="L5057" title="All 4 branches missed.">                if (curr == null || !curr.isTTFNativeFont()) {</span>
<span class="nc" id="L5058">                    curr = c.getStyle().getFont();</span>
                }

<span class="nc bnc" id="L5061" title="All 4 branches missed.">                if (curr == null || !curr.isTTFNativeFont()) {</span>
<span class="nc" id="L5062">                    parent = c.getParent();</span>
<span class="nc bnc" id="L5063" title="All 6 branches missed.">                    while (parent != null &amp;&amp; (curr == null || !curr.isTTFNativeFont())) {</span>
<span class="nc" id="L5064">                        curr = parent.getStyle().getFont();</span>
<span class="nc" id="L5065">                        parent = parent.getParent();</span>
                    }
                }
<span class="nc bnc" id="L5068" title="All 4 branches missed.">                if (curr == null || !curr.isTTFNativeFont()) {</span>
<span class="nc" id="L5069">                    curr = Font.create(&quot;native:MainRegular&quot;);</span>
                }

<span class="nc bnc" id="L5072" title="All 4 branches missed.">                if (curr != null &amp;&amp; curr.isTTFNativeFont()) {</span>
<span class="nc" id="L5073">                    curr = curr.derive(size, 0);</span>
<span class="nc" id="L5074">                    style.setFont(curr);</span>
                }
            }
<span class="nc" id="L5077">        }</span>
<span class="nc" id="L5078">        return this;</span>
    }

    /**
     * Returns a set with the first element of the current set, or an empty set if the
     * current set is empty.
     *
     * @return A ComponentSelector with 0 or 1 element.
     * @since 7.0
     */
    public ComponentSelector first() {
<span class="nc bnc" id="L5089" title="All 2 branches missed.">        if (!isEmpty()) {</span>
<span class="nc" id="L5090">            return new ComponentSelector(results.iterator().next());</span>
        } else {
<span class="nc" id="L5092">            return new ComponentSelector();</span>
        }
    }

    /**
     * Interface used for providing callbacks that receive a Component as input.
     */
    public interface ComponentClosure {

        /**
         * Callback to apply.
         *
         * @param c Component that is passed to the closure.
         */
        void call(Component c);
    }

    /**
     * Interface used by {@link #map(com.codename1.ui.ComponentSelector.ComponentMapper) } to form a new set of
     * components based on the components in one set.
     */
    public interface ComponentMapper {

        /**
         * Maps component {@literal c } to a replacement component.
         *
         * @param c The source component.
         * @return The component that should replace {@literal c} in the new set.
         */
        Component map(Component c);
    }

    /**
     * Interface used by {@link #filter(com.codename1.ui.ComponentSelector.Filter) } to form a new set of
     * components based on the components in one set.
     */
    public interface Filter {

        /**
         * Determines whether component {@literal c} should be included in new set.
         *
         * @param c The component to test for inclusion in new set.
         * @return True if {@literal c } should be included in new set.  False otherwise
         */
        boolean filter(Component c);
    }


}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span></div></body></html>